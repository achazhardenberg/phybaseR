[{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":null,"dir":"","previous_headings":"","what":"Future Development Roadmap","title":"Future Development Roadmap","text":"document outlines planned features extensions package.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_1-custom-priors","dir":"","previous_headings":"","what":"1. Custom Priors","title":"Future Development Roadmap","text":"Request: Users need ability override default informative/weakly-informative priors, crucial mechanistic models. Implementation: Add priors argument (). Accept named list: list(alpha_Birth = \"dnorm(0, 0.001)\", sigma_Storks = \"dunif(0, 10)\"). JAGS model generation, replace default prior string specific parameter user-supplied string. Validation: Check provided string valid JAGS syntax (catch errors JAGS).","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_2-occupancy-models-binomial-measurement-error","dir":"","previous_headings":"","what":"2. Occupancy Models (Binomial Measurement Error)","title":"Future Development Roadmap","text":"Concept: Occupancy models structurally identical Measurement Error (Latent Variable) framework already implemented . * State Process: True Presence zi∼Bernoulli(ψi)z_i \\sim \\text{Bernoulli}(\\psi_i) (Latent Variable) * Observation Process: Detection History yij∼Bernoulli(zi⋅pij)y_{ij} \\sim \\text{Bernoulli}(z_i \\cdot p_{ij}) (Measurement Error) Current Limitation: * variability argument currently hardcodes Gaussian observation process: Xobs∼N(Xtrue,σ)X_{obs} \\sim N(X_{true}, \\sigma). Proposed Implementation: * Extend variability accept distribution type. * Example API: variability = c(Sighting = list(type=\"binomial\", trials=\"reps\")) * Update JAGS model generation support dbin dbern detection layers. Output: * model return estimates : * Occupancy (ψ\\psi): probability site occupied (Latent State parameter). * Detection (pp): probability detecting species present (Observation Error parameter). * can modeled functions covariates. Killer Feature: Causal Multi-Species Occupancy * ψ\\psi (Occupancy) pp (Detection) typically treated nuisance parameters software, can treat endogenous response variables. * Causal Links Detection: Test behavioral hypotheses (e.g., Predator Presence -> Prey Detection Probability). Prey hide predators around (p↓p \\downarrow). * Causal Links Occupancy: Test demographic hypotheses (e.g., Predator Presence -> Prey Occupancy). Prey avoid predator-rich sites (z↓z \\downarrow). * Confounding Control: Use latent variables (MAG approach) control unmeasured environmental confounders affect species, allowing robust D-separation tests latent occupancy states. * effectively creates Causal Occupancy Engine, moving beyond simple correlation. * Backend Strategy: Adopt Rota et al. (2016) approach (Multivariate Bernoulli). Unlike Latent MVN (Pollock), models interaction probabilities directly (Log-linear), allowing covariate-dependent interactions (e.g., Competition varies Temperature).","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_3-spatial-modeling-car-models","dir":"","previous_headings":"","what":"3. Spatial Modeling (CAR Models)","title":"Future Development Roadmap","text":"Native CAR Model Support: Implement dcar_normal() JAGS models support Conditional Autoregressive (CAR) spatial models natively. - Proper estimation spatial dependence parameter (ρ\\rho). - Better alignment standard ecological spatial modelling practices (e.g. spdep).","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_4-non-gaussian-optimization","dir":"","previous_headings":"","what":"4. Non-Gaussian Optimization","title":"Future Development Roadmap","text":"Extend optimized linear algebra (matrix inversion) approach Binomial Poisson response models using PQL (Penalized Quasi-Likelihood) similar approximations, improved sampling schemes.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_5-phylogeography-spatial-phylogenetic-interactions","dir":"","previous_headings":"","what":"5. Phylogeography (Spatial-Phylogenetic Interactions)","title":"Future Development Roadmap","text":"Concept: Allow strength phylogenetic signal vary across space, spatial autocorrelation vary clade. Implementation: tensor product Phylogenetic Spatial precision matrices (Kphy⊗KspatialK_{phy} \\otimes K_{spatial}). Application: Testing evolutionary rates differ regions (e.g., Tropics vs Temperate), effectively bridging Macroecology Phylogeography.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_6-integrated-population-models-ipms","dir":"","previous_headings":"","what":"6. Integrated Population Models (IPMs)","title":"Future Development Roadmap","text":"Concept: IPMs logical endpoint framework. combine multiple observation datasets (Counts, Mark-Recapture, Productivity) estimate shared latent population parameters. Latent Process: Population dynamics (Nt+1=Nt⋅S+RN_{t+1} = N_t \\cdot S + R). Observation Models: Ct∼Poisson(Nt)C_t \\sim \\text{Poisson}(N_t), yij∼Bernoulli(S)y_{ij} \\sim \\text{Bernoulli}(S). Potential: Since already explicitly separates Latent States Observations, extending support time-series dynamics (t→t+1t \\t+1) allow fit full IPMs. Killer Feature: Causal Demographic Hypothesis Testing * demographic rates (Survival, Recruitment) states (Population Size NtN_t) latent variables, can used causal tests. * Example: Test Density Dependence real (Nt→StN_t \\S_t) Climate drives population via Recruitment (Climate→Rt→Nt+1Climate \\R_t \\N_{t+1}). * moves IPMs “estimation tools” “hypothesis testing engines”.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_7-automatic-dag-visualization-complete","dir":"","previous_headings":"","what":"7. Automatic DAG Visualization (COMPLETE)","title":"Future Development Roadmap","text":"Goal: Replace text summaries publication-ready path diagrams. S3 method plot(fit). Uses igraph DiagrammeR draw causal graph. Edges colored significance (Red/Blue); Width scaled coefficient magnitude.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_8-zero-inflation-support-complete","dir":"","previous_headings":"","what":"8. Zero-Inflation Support (COMPLETE)","title":"Future Development Roadmap","text":"Problem: Ecological count data often excess zeros (true absence vs. undetected). Solution: Support family = \"zip\" (Zero-Inflated Poisson) zinb (Zero-Inflated Negative Binomial). Mechanism: mixture model binary “structural zero” process count process.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_9-alternative-backends-nimble--inla","dir":"","previous_headings":"","what":"9. Alternative Backends (NIMBLE & INLA)","title":"Future Development Roadmap","text":"Goal: Enable high-performance computing massive datasets (N>10,000N > 10,000) complex mixtures. Add backend argument (..., backend = \"jags\"). “jags” (Default): Fast startup, compiler needed. Best prototyping standard usage. “nimble”: Compiles C++. User can customize samplers (e.g. HMC + Gibbs). Crucial ODEs complex mechanistic models. Use Case: Massive spatial/temporal datasets MCMC slow. Role: engine because_discover (Structure Learning) large-scale Spatiotemporal mapping. Trade-: Extremely fast, less flexible custom non-standard distributions. Implementation: Refactor .R adopt plugin architecture model execution. Note: Stan support deferred indefinitely due need separate code generator.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_10-causal-biodiversity-modeling-hill-numbers","dir":"","previous_headings":"","what":"10. Causal Biodiversity Modeling (Hill Numbers)","title":"Future Development Roadmap","text":"Concept: Instead just estimating diversity, test causes diversity patterns using Hill numbers (qD^{q}D) response variables. Response: Site-level diversity (Taxonomic, Phylogenetic, Functional Hill numbers). Predictors: Environmental drivers (Temperature, Productivity). Controls: Spatial autocorrelation (uspatialu_{spatial}) Biogeographic history. Causal Tests: Test e.g., Productivity -> Functional Diversity -> Ecosystem Stability. Innovation: diversity studies correlative. allows formally testing causal pathways biodiversity accounting spatial-phylogenetic non-independence.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_11-causal-utilities-interventions--robustness","dir":"","previous_headings":"","what":"11. Causal Utilities (Interventions & Robustness)","title":"Future Development Roadmap","text":"Concept: Implements Pearl’s -operator ((X=x)\\text{}(X=x)) structural interventions. Surgery: Removes incoming edges intervened variable DAG. Propagation: Propagates fixed value xx downstream descendants (children) using fitted structural equations. Bayesian: Returns full posterior distribution counterfactual outcome. Application: “population size reduced poaching 50%?” (opposed just comparing areas low vs high poaching). Goal: Assess robustness. “strong unmeasured confounder explain away result?” (similar E-values). Implementation: Post-hoc analysis residuals.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"jags-optimization-implementation-progress","dir":"","previous_headings":"","what":"JAGS Optimization Implementation Progress","title":"Future Development Roadmap","text":"(Archived previous technical roadmap)","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"completed-2025-12-03","dir":"","previous_headings":"","what":"Completed (2025-12-03)","title":"Future Development Roadmap","text":"✅ Benchmarking: Confirmed random effects formulation ~4.6x - 15.5x faster. ✅ Code Generation: Implemented additive random effects (u_phylo + u_spatial). ✅ Variance Partitioning: Now estimates separate sigma components instead aggregate lambda. ✅ Multiple Covariance: Validated tests/test_multiple_covariance.R. ✅ Non-Gaussian Families: Validated support binomial, poisson, negbinomial, zip, zinb full multi-tree phylogenetic signal.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_12-deterministic-nodes-formula-interface-complete","dir":"","previous_headings":"","what":"12. Deterministic Nodes (Formula interface) (COMPLETE)","title":"Future Development Roadmap","text":"Status: Implemented. Feature: R/deterministic_nodes.R automatically parses formulas interactions (:), logic, functions (e.g., (x^2)). Mechanism: Converts internal deterministic nodes (det_...[] <- ...) JAGS, ensuring correct propagation interventions. Benefit: Allows “Mechanism-First” modeling (e.g. growth ~ Vmax * Light / (Km + Light)) without manual data pre-processing.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_13-state-space-models-time-series","dir":"","previous_headings":"","what":"13. State Space Models (Time Series)","title":"Future Development Roadmap","text":"Concept: addition Deterministic Nodes (Item 12) Latent Variables (Item 1), structurally capable fitting State Space Models (SSM). Missing Piece: Time Indexing (t,t−1t, t-1). Support autoregressive notation formulas: N ~ N[t-1] * S + R. Internally map JAGS loop: N[] <- N[-1] * .... Combine variability (measurement error) handle “Partially Observed” component. Combine variability (measurement error) handle “Partially Observed” component. Result: general-purpose Bayesian SSM engine can also handle phylogeny spatial autocorrelation (e.g., Spatiotemporal SSMs). “Process-based” causal inference. Strategic Note: primary mechanistic engine , ecological data discrete (year--year), making far widely useful continuous ODEs. DAGs “unrolled” time (t−1→tt-1 \\t). Independence tests check lagged effects (e.g., Xt−1X_{t-1} predict YtY_t given XtX_t?). allows testing Granger Causality-like hypotheses within Bayesian structural framework.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_14-structure-learning-discovery-engine","dir":"","previous_headings":"","what":"14. Structure Learning (Discovery Engine)","title":"Future Development Roadmap","text":"Problem: Users often many variables unknown structure. Solution: because_discover(data) Starts fully connected graph. Iteratively removes edges based conditional independence tests (D-separation). Innovation: Uses backend perform tests accounting phylogeny spatial structure, avoiding biases standard structure learning algorithms. Exploratory Phase: Use fast backend (INLA/Horseshoe JAGS) “learn” structure environmental variables theory weak. Theoretical Phase: Integrate learned environmental DAG fixed subgraph complex biological model (e.g., Occupancy) user provides strong prior theoretical knowledge. Refinement: Use d-separation tests combined model identify remaining structural misfits.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_15-automated-mediation-analysis-complete","dir":"","previous_headings":"","what":"15. Automated Mediation Analysis (COMPLETE)","title":"Future Development Roadmap","text":"Goal: Decompose effects “Direct” “Indirect” pathways. Solution: because_mediation(fit, exposure, outcome) Automatically traces paths XX YY fitted DAG using igraph. Calculates Indirect Effects (e.g., X→M→YX \\M \\Y) multiplying coefficients (βXM⋅βMY\\beta_{XM} \\cdot \\beta_{}) chain--chain. Calculates Total Effects (Sum paths). Answers: “much effect mediated M?” full Bayesian uncertainty intervals.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_16-the-front-door-criterion","dir":"","previous_headings":"","what":"16. The Front-Door Criterion","title":"Future Development Roadmap","text":"Problem: Unmeasured confounding XX YY back-door adjustment impossible. Solution: Detect exploit “Front-Door” structures (X→M→YX \\M \\Y, MM isolated confounders). Mechanism: topological check effectively allowing causal identification even standard controls missing.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_17-transportability-external-validity","dir":"","previous_headings":"","what":"17. Transportability (External Validity)","title":"Future Development Roadmap","text":"Problem: Can model learned one region (e.g., Europe) predict another (e.g., Amazon)? Solution: because_transport(fit, new_context) Mechanism: Uses Pearl’s Selection Diagrams. Users flag structural equations differ new environment (Selection Nodes SS). tool computes whether causal effect can validly transported needs recalibration.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_18-data-fusion-grand-dags","dir":"","previous_headings":"","what":"18. Data Fusion (Grand DAGs)","title":"Future Development Roadmap","text":"Problem: Disparate datasets (e.g., Dataset {X,Y}\\{X, Y\\}, Dataset B {Y,Z}\\{Y, Z\\}). Solution: because_merge(list(data1, data2)) Mechanism: treats missing data latent parameters, can combine datasets single “Grand DAG”, imputing missing variables dataset based shared structure.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_19-differential-equations-ode-solver-interface","dir":"","previous_headings":"","what":"19. Differential Equations (ODE Solver Interface)","title":"Future Development Roadmap","text":"Concept: “Gold Standard” mechanistic modeling ecology (e.g., Lotka-Volterra, SIR models). Problem: Currently, assumes discrete-time updates static relationships. Many ecological theories defined continuous time (dN/dt). Solution: Investigate JAGS extensions (like passing C++ modules) consider alternative backends (Stan/NIMBLE) specific feature, native JAGS lacks built-ode() solver. Workaround: Use discrete approximation (Euler method) within JAGS loops now. Priority: Low/Niche. noted user, ecological data discrete (e.g. annual), Item 13 (SSMs) covers 90% use cases. remains long-term goal specific sub-fields (e.g., epidemiology).","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_20-bayesian-model-averaging-bma--variable-selection-experimental","dir":"","previous_headings":"","what":"20. Bayesian Model Averaging (BMA) & Variable Selection (Experimental)","title":"Future Development Roadmap","text":"Status: Prototype Implemented (See drafts/demo_bma_rhino.R). Concept: Use Gibbs Variable Selection (Indicator Variables) calculate Posterior Inclusion Probabilities (PIPs) edges, effectively performing Bayesian D-separation tests. User specifies “Supermodel”. automatically injects z∼dbern(0.5)z \\sim dbern(0.5) optional paths. Returns PIPs structural validation. Plan: Move prototype logic () allow bma=TRUE.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_21-tidyverse-dsl-the-tidysem-wrapper","dir":"","previous_headings":"","what":"21. Tidyverse DSL (The “TidySEM” Wrapper)","title":"Future Development Roadmap","text":"Concept: optional, pipe-based interface inspired TidySEM powered . Goal: “Steal Syntax, Keep Backend”. Provide grammar users love without frequentist limitations. Core Principle: traditional () function remains stable engine. DSL lightweight wrapper. Proposed Syntax (Matching TidySEM): r     model <- tidy_because(data) |>       add_paths(Risk ~ Population + Climate) |>       set_family(Risk = \"binomial\") |>  # '' specific extension       estimate_jags() add_paths(): Incrementally build equations. set_family(): Explicitly handle families (Bernoulli, Poisson, etc). set_variability(): Explicitly handle measurement error. Base Pipe (|>): Uses native R pipe (requires R >= 4.1.0) avoid magrittr dependency. broom Compatibility: tidy(fit) glance(fit) seamless plotting. Priority: Medium (Excellent complex ecological datasets many species).","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"id_22-sequentially-linked-models-modular-bayesian-inference","dir":"","previous_headings":"","what":"22. Sequentially Linked Models (Modular Bayesian Inference)","title":"Future Development Roadmap","text":"Concept: Enable “Cut Feedback” inference linking separate models sequentially (Model →\\Model B) instead fitting one giant joint model. Use Case: Cross-scale linking (e.g., Species Occupancy →\\Trait Evolution) feedback B undesirable computationally prohibitive. Extract Samples: extract_latent(modelA, format=\"samples\", n_samples=1000) returns matrix posterior draws latent variable. Empirical Posterior Propagation: Pass matrix Model B using variability = \"samples\". JAGS Implementation: Model B uses dcat sample provided empirical distribution observation ii: ki∼Categorical(1/Nsamples)k_i \\sim \\text{Categorical}(1/N_{samples})Xi=Xsamples[,ki]X_i = X_{samples}[, k_i] Benefit: Propagates full non-Gaussian uncertainty (e.g., bimodality) without making parametric assumptions (like Mean/SE). Correctly handles “data error” fully Bayesian framework. Causal Inference: Standard d-separation tests remain valid within model step. input Model treated exogenous parent node Model B’s graph, allowing conditional independence tests involving latent variable.","code":""},{"path":[]},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"a-strategy-for-structure-learning-with-missing-data","dir":"","previous_headings":"","what":"A. Strategy for Structure Learning with Missing Data","title":"Future Development Roadmap","text":"“Purist” approach (treating missing data parameters structure learning) computationally infeasible. adopt “Pragmatic Hybrid” (Scout & Surveyor) approach: Use fast tools (e.g., Rphylopars, mice) generate KK (e.g., 5) completed datasets starting discovery. bypasses missing-predictor limitation fast engines like INLA. Run because_discover(backend=\"inla\") KK imputed datasets. exploits INLA’s speed (seconds vs hours) search massive graph space. Identify edges appear majority KK graphs (robustness check). yields Candidate Graph. Pass Candidate Graph (backend=\"jags\"). JAGS treats original missing data parameters (discarding pre-imputation) properly estimate uncertainty parameters final model.","code":""},{"path":"https://because-pkg.github.io/because/ROADMAP.html","id":"b-the-inla-vs-jags-role","dir":"","previous_headings":"","what":"B. The INLA vs. JAGS Role","title":"Future Development Roadmap","text":"Role: Structure Learning, Spatial Mapping. Constraint: handle non-linear logic (polynomials latent vars) complex missing data predictors naturally. Advantage: Speed (1000x faster). Role: ODEs, Complex Mechanistic Logic, Custom Samplers. Advantage: Compiles C++, allowing differential equation solvers arbitrary non-linear functions slow impossible JAGS. Strategic Value: bridge full “Process-Based” modeling. Role: Final Estimation, because_do (Interventions), Complex Logic. Advantage: Handles everything (interaction latent vars, mechanism-based equations). Constraint: Slow.","code":""},{"path":"https://because-pkg.github.io/because/articles/01_getting_started.html","id":"getting-started","dir":"Articles","previous_headings":"","what":"Getting started","title":"Getting Started with because","text":"R package designed easily perform causal inference Bayesian Structural Equation Models JAGS. package integrates methods proposed von Hardenberg & Gonzalez-Voyer (2025) fit Phylogenetic Bayesian Structural Equation Models (PhyBaSE) extends types covariance structures (eg. spatial autocorrelation, genetic relatedness etc.). main features: Causal Inference d-Separation: Testing conditional independencies implied causal model. Custom Priors Mechanistic Constraints: Incorporating prior knowledge mechanistic constraints. Phylogenetic Path Analysis: Using Phylogenetic Bayesian Structural Equation Model approach (PhyBaSE, von Hardenberg & Gonzalez-Voyer, 2025)(.phybase module) Phylogenetic Missing Data Imputation*: Handling missing data using Bayesian imputation (.phybase module). Gaussian (continuous data) Binomial (binary/proportion data) Multinomial (unordered categorical data) Ordinal (ordered categorical data) Poisson (count data) Negative Binomial (overdispersed count data Zero inflated Poissson (ZIP) negative binomial (ZINB) Advanced Model Specifications: random effects (mixed models, nested designs), polynomial terms, interaction terms,categorical predictors, measurement error, missing data, phylogenetic uncertainty. Hierarchical Data: Multi-level data variables different hierarchical levels. Latent Variables MAG: Measurement error models causal inference presence latent variables using MAG approach Shipley & Douda (2021). Model Diagnostics: Checking convergence, comparing models, interpreting results.","code":""},{"path":[]},{"path":"https://because-pkg.github.io/because/articles/01_getting_started.html","id":"installation","dir":"Articles","previous_headings":"Getting started > Quick Start","what":"Installation","title":"Getting Started with because","text":"using , need JAGS (Just Another Gibbs Sampler) installed machine. macOS: brew install jags download SourceForge. Windows: Download installer SourceForge. Linux: sudo apt-get install jags. installing JAGS, can install GitHub. install stable release (v0.9.6): install latest development version: Finally, load package:","code":"remotes::install_github(\"because-pkg/because@v0.9.6\", build_vignettes = TRUE) remotes::install_github(\"because-pkg/because\", build_vignettes = TRUE) library(because)"},{"path":"https://because-pkg.github.io/because/articles/01_getting_started.html","id":"your-first-model","dir":"Articles","previous_headings":"Getting started > Quick Start","what":"Your First Model","title":"Getting Started with because","text":"main function (), compiles fits specified Structural Equation Model JAGS. function rich functionalities allowing model complex models different error structures hierarchically structured data. However, , show basic workflow, use () fit simple linear model involving two variables. two variables typical SEM equivalent simple linear regression can used infer causality, serves illustrate basic usage package. Let’s start simulating two variables X Y Y correlated X: Now can fit model using . need specify structural equations (case one) using R’s formula syntax call () passing equation data frame: check convergence MCMC chains, can look Rhat values summary output (< 1.1). can also plot trace plots MCMC samples:  fit$samples MCMC object, can use coda functions analyze plot MCMC samples. can see () translates model JAGS syntax calling fit$model , fitting , using because_model(): specifing equations can include multiple predictors well factors,interaction terms polynomial terms following conventional R formula syntax.","code":"# set seed for reproducibility set.seed(67)  # Simulate predictor X <- rnorm(n = 100, mean = 50, sd = 10)  # Generate response with the chosen intercept (alpha) and slope (beta) alpha <- 20 Y <- alpha + beta * X + rnorm(n, mean = 0, sd = 10)  # Combine into data frame sim.dat <- data.frame(X, Y)  # Fit linear model with lm() function for comparison summary(lm(Y ~ X, data = sim.dat)) # Define the equations equations <- list(Y ~ X)  # Fit the model fit <- because(   equations = equations,   data = sim.dat )  # View results summary(fit) # Plot trace plots plot(fit$samples) # Generate JAGS model code jags_model_code <- because_model(   equations = equations )  cat(jags_model_code$model)"},{"path":"https://because-pkg.github.io/because/articles/01_getting_started.html","id":"next-causal-inference-with-d-separation","dir":"Articles","previous_headings":"Getting started","what":"Next: Causal Inference with D-Separation","title":"Getting Started with because","text":"One main features ability test causal model’s fit data using d-separation tests. D-separation tests evaluate whether conditional independencies implied causal model hold data (Shipley, 2016). , suggests model may misspecified may need add remove paths. details d-separation tests, interpret full tutorial can found Causal inference d-separation vignette.","code":""},{"path":"https://because-pkg.github.io/because/articles/02_dseparation.html","id":"the-problem-with-correlations","dir":"Articles","previous_headings":"","what":"The Problem with Correlations","title":"Causal inference with d-separation","text":"simple linear regression presented example previous vignette, modeled relationship two variables, X Y. However, regression tells us correlations, causation. can say X related Y also X predicts Y, say X causes Y. indeed three reasons X Y correlate (real data course, data simulated predefined correlation!): X → Y: X causes Y Y → X: Y causes X X ← Z → Y: common cause Z causing . problem correlation alone distinguish three scenarios. Let’s look classic example correlative study trying establish storks deliver babies (Matthews, 2000). investigated example previously Gonzalez-Voyer & von Hardenberg (2014), data tutorial analysing example traditional path analysis available supplementary materials book chapter : https://github.com/achazhardenberg/mpcm-OPM. Let’s load storks dataframe available package take look relationship number stork pairs number babies born different European countries (thousands per year):  can see appears positive correlation number stork pairs number babies born can confirm simple linear regression: positive relationship stork pairs births confirmed (p = 0.008, already reported Matthews, 2000), mean storks deliver babies? influenced third variable, Country Area? Let’s check Area correlates Births Storks: Indeed, Births Storks correlate significantly Area (p < 0.0001 p = 0.015 respectively). Matthews (2000) argued observed correlation Storks Births actually due confounding effect Area: larger countries storks births, leading spurious correlation Storks Births. Indeed, controlling statistically Area multiple regression, effect Storks Births becomes non-significant: causal inference framework, can represent three variables causal relationships using Directed Acyclic Graph (DAG):  Directed Acyclic Graphs (DAGs) explicitly state causal assumptions, multiple regression effectively tested conditional independence implied DAG: Storks || Birth | {Area} (Storks Births independent conditional Area) translates statistically d-separation test just performed including Area covariate regression Births Storks. causal model therefore consistent data. “Consistent” means conditional independencies implied DAG hold data, prove causal model actually correct. models may also consistent data three variables impossible distinguish different causal models. direct reader Gonzalez-Voyer & von Hardenberg (2014) detailed discussion example Shipley (2000, 2003, 2016) theoretical foundations d-separation. Gonzalez-Voyer & von Hardenberg (2014) also explored causal relationships three variables fourth variable present dataset: Humans (Human population size millions) proposed causal model tested using classic piecewise Path Analysis (follow online tutorial want replicate analysis).  Let’s now see test causal model . First, specify structural equations implied DAG: Next, good practice standardize variables prior analysis, path coefficients can interpreted standardized effects (also helps convergence mcmc chains): Now can fit model (), enabling d-separation tests dsep = TRUE argument: can see three d-separation tests pass, indicating conditional independencies implied causal model hold data. Therefore, model consistent data.","code":"# load data data(storks) plot(storks$Storks, storks$Birth,   xlab = \"Number of Stork Pairs\",   ylab = \"Number of Babies Born (thousands)\" ) lm_storks <- lm(Birth ~ Storks, data = storks) summary(lm_storks) Call: lm(formula = Birth ~ Storks, data = storks)  Residuals:    Min     1Q Median     3Q    Max  -478.8 -166.3 -144.9   -2.0  631.1   Coefficients:              Estimate Std. Error t value Pr(>|t|)    (Intercept) 2.250e+02  9.356e+01   2.405   0.0295 *  Storks      2.879e-02  9.402e-03   3.063   0.0079 ** --- Signif. codes:   0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  Residual standard error: 332.2 on 15 degrees of freedom Multiple R-squared:  0.3847,    Adjusted R-squared:  0.3437  F-statistic:  9.38 on 1 and 15 DF,  p-value: 0.007898 birth_area.lm <- lm(Birth ~ Area, data = storks) summary(birth_area.lm) # Coefficients: #              Estimate Std. Error t value Pr(>|t|) # (Intercept) -7.7754992 56.9376784  -0.137    0.893 # Area         0.0017229  0.0001861   9.259 1.36e-07 ***  storks_area.lm <- lm(Storks ~ Area, data = storks) summary(storks_area.lm) # Coefficients: #              Estimate Std. Error t value Pr(>|t|) # (Intercept) -6.069e+01  2.591e+03  -0.023   0.9816 # Area         2.331e-02  8.467e-03   2.753   0.0148 * lm_birth_storks_area <- lm(Birth ~ Storks + Area,   data = storks ) summary(lm_birth_storks_area)  # Coefficients: #               Estimate Std. Error t value Pr(>|t|) # (Intercept) -7.4116870 56.7021798  -0.131    0.898 # Storks       0.0059949  0.0056510   1.061    0.307 # Area         0.0015832  0.0002273   6.964 6.62e-06 *** library(because) dag_storks <- list(   Storks ~ Area,   Birth ~ Area)  plot_dag(dag_storks) dag_storks2 <- list(Storks ~ Area,                     Birth ~ Area,                     Humans ~ Birth)  plot_dag(dag_storks2) equations_storks <- list(   Storks ~ Area,   Birth ~ Area,   Humans ~ Birth ) storks <- scale(storks[2:5]) fit_storks <- because(   equations = equations_storks,   data = storks,   dsep = TRUE ) summary(fit_storks) d-separation Tests ==================                Param Estimate LowerCI UpperCI Indep     P  Rhat n.eff                 Test: Area _||_ Humans | {Birth}    beta_Area_Humans    0.107  -0.439   0.649   Yes 0.673 1.000  3650      Test: Birth _||_ Storks | {Area}   beta_Birth_Storks    0.129  -0.199   0.455   Yes 0.421 1.001  2826     Test: Humans _||_ Storks | {Birth,Area}  beta_Humans_Storks   -0.285  -0.691   0.141   Yes 0.169 1.002  2862   Legend:   Indep: 'Yes' = Conditionally Independent, 'No' = Dependent (based on 95% CI)   P: Bayesian probability that the posterior distribution overlaps with zero"},{"path":[]},{"path":"https://because-pkg.github.io/because/articles/02_dseparation.html","id":"output-format","dir":"Articles","previous_headings":"Reading the d-Separation results","what":"Output Format","title":"Causal inference with d-separation","text":"Test: conditional independence tested: Birth _||_ Storks | {Area} means “Storks independent Birth given Area” - _||_: Independence symbol - | {}: Conditioning set (controlling ) Param Estimate: beta estimate variable tested conditional independence - Birth _||_ Storks | {Area}, tests beta_Birth_Storks model Birth ~ Storks + Area - independent, beta ~0 LowerCI, UpperCI: Posterior mean 95% credible interval beta parameter tested - independent, Credibility intervals include zero. Indep: independence supported? - Yes: Conditional independence supported - : Variables independent. conditional independence statements fail, means proposed model plausible representation causal structure data. P: Bayesian probability posterior distribution beta parameter overlaps zero - High values (e.g., > 0.1) support independence - Low values (e.g., < 0.05) indicate dependence Rhat, n.eff: MCMC diagnostics beta parameter tested - Rhat ~ 1 indicates convergence - n.eff: Effective sample size can now fit model without d-separation tests obtain parameter estimates: parameters converged (Rhat ~ 1) path coefficients positive, indicating larger Area leads Storks Births, Births lead larger Human populations, expected. Note standardized variables prior analysis, path coefficients can interpreted standardized effects (ie relative strength can compared directly). can now use function plot_dag plot DAG fitted model estimated path coefficients:","code":"Param Estimate LowerCI UpperCI Indep     P  Rhat n.eff                 Test: Birth _||_ Storks | {Area}   beta_Birth_Storks    0.129  -0.199   0.455   Yes 0.421 1.001  2826 fit_storks_final <- because(   equations = equations_storks,   data = storks ) summary(fit_storks_final) Mean    SD Naive SE Time-series SE   2.5% alphaBirth         0.003 0.133    0.002          0.002 -0.263 alphaHumans       -0.004 0.160    0.003          0.003 -0.321 alphaStorks       -0.001 0.222    0.004          0.004 -0.445 beta_Birth_Area    0.924 0.135    0.002          0.003  0.660 beta_Humans_Birth  0.848 0.164    0.003          0.003  0.516 beta_Storks_Area   0.582 0.228    0.004          0.004  0.138 sigmaBirth         0.534 0.099    0.002          0.002  0.382 sigmaHumans        0.642 0.116    0.002          0.002  0.460 sigmaStorks        0.902 0.162    0.003          0.003  0.654                      50% 97.5%  Rhat n.eff alphaBirth         0.005 0.265 1.000  3054 alphaHumans       -0.004 0.310 1.000  3000 alphaStorks       -0.002 0.440 1.000  3277 beta_Birth_Area    0.924 1.196 1.000  2799 beta_Humans_Birth  0.849 1.168 1.001  3000 beta_Storks_Area   0.582 1.050 1.000  3000 sigmaBirth         0.519 0.762 1.000  2720 sigmaHumans        0.624 0.916 1.000  3000 sigmaStorks        0.877 1.292 1.000  3000  DIC: Mean deviance:  93.39  penalty 9.835  Penalized deviance: 103.2 plot_dag(fit_storks_final)"},{"path":"https://because-pkg.github.io/because/articles/02_dseparation.html","id":"a-note-on-the-notation-used-for-the-parameter-names-in-the-summary-output","dir":"Articles","previous_headings":"Reading the d-Separation results","what":"A note on the notation used for the parameter names in the summary output","title":"Causal inference with d-separation","text":"summary output , parameter names follow specific notation indicate relationships modelled. example, beta_Birth_Area represents path coefficient (beta) effect Area Births. format beta_<DependentVariable>_<IndependentVariable>. notation helps quickly identify variables involved path model. alpha parameters represent intercepts equation, sigma parameters represent residual standard deviations dependent variable. , example, path going Area Births represented linear regression: Birth ~ alphaBirth + beta_Birth_Area * Area + error, error normally distributed standard deviation = sigmaBirth.","code":""},{"path":"https://because-pkg.github.io/because/articles/02_dseparation.html","id":"next-phylogenetic-models","dir":"Articles","previous_headings":"","what":"Next: Phylogenetic Models","title":"Causal inference with d-separation","text":"Now understand d-separation test causal models , can explore complex models datasets. next vignette guide fitting Phylogenetic Bayesian models, account shared evolutionary history among species: Phylogenetic Models","code":""},{"path":"https://because-pkg.github.io/because/articles/02_dseparation.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Causal inference with d-separation","text":"Gonzalez-Voyer, ., & von Hardenberg, . (2014). introduction phylogenetic path analysis. Modern phylogenetic comparative methods application evolutionary biology: Concepts practice (pp. 201-229). Springer Berlin Heidelberg. Matthews, R. (2000). Storks deliver babies (p= 0.008). Teaching Statistics, 22(2), 36-38. Shipley, B. (2000). New Inferential Test Path Models Based Directed Acyclic Graphs. Structural Equation Modeling: Multidisciplinary Journal, 7(2), 206–218. https://doi.org/10.1207/S15328007SEM0702_4 Shipley, B. (2003). Testing recursive path models correlated errors using d-separation. Structural Equation Modeling, 10(2), 214-221. Shipley, B. (2016). Cause Correlation Biology: User’s Guide Path Analysis, Structural Equations Causal Inference R (2nd ed.). Cambridge University Press.","code":""},{"path":"https://because-pkg.github.io/because/articles/03_custom_priors.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Custom Priors and Mechanistic Constraints","text":"One strengths Bayesian modeling ability incorporate prior knowledge analysis. package, generally use “uninformative” weakly informative priors default let data speak . However, many cases might want inject specific information: Mechanistic Knowledge: know parameter (like growth rate) must positive lies within biologically feasible range. Previous Studies: estimates previous meta-analysis experiment want use starting point. Measurement Error: know measurement error instrument want fix constrain residual variance. vignette demonstrates use priors argument () override default priors inject mechanistic constraints.","code":""},{"path":"https://because-pkg.github.io/because/articles/03_custom_priors.html","id":"example-1-comparing-default-and-custom-priors","dir":"Articles","previous_headings":"","what":"Example 1: Comparing Default and Custom Priors","title":"Custom Priors and Mechanistic Constraints","text":"example, let’s simulate Absolute Growth Rate grams per day (g/day) hypothetical juvenile birds responding ambient temperature.","code":"library(because)  set.seed(42) N <- 30 # Ambient temperature in Celsius (Mean 20C) Temp_Raw <- rnorm(N, mean = 20, sd = 5)  # Center it so '0' represents the mean (20C). # This ensures the intercept represents growth at average conditions, # rather than at 0°C (where the bird would be frozen solid!). Temp_Centered <- Temp_Raw - 20  # True relationship: # Baseline growth at mean temp is 10 g/day. # Every degree of warming above mean adds 0.5 g/day. Growth_g_day <- 0.5 * Temp_Centered + 10 + rnorm(N, sd = 2)  df <- data.frame(Temp_Centered, Growth_g_day)"},{"path":"https://because-pkg.github.io/because/articles/03_custom_priors.html","id":"default-model","dir":"Articles","previous_headings":"Example 1: Comparing Default and Custom Priors","what":"Default Model","title":"Custom Priors and Mechanistic Constraints","text":"Let’s fit standard model first. default, assigns wide Gaussian priors (dnorm(0, 1.0E-6)) intercepts (alpha) slopes (beta), Gamma priors (dgamma(1, 1)) precisions (tau).","code":"fit_default <- because(     equations = list(Growth_g_day ~ Temp_Centered),     data = df ) #> Converted data.frame to list with 2 variables: Growth_g_day, Temp_Centered #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 30 #>    Unobserved stochastic nodes: 3 #>    Total graph size: 159 #>  #> Initializing model  summary(fit_default) #>                                  Mean    SD Naive SE Time-series SE  2.5%   50% #> alpha_Growth_g_day              9.770 0.387    0.007          0.007 9.008 9.772 #> beta_Growth_g_day_Temp_Centered 0.432 0.062    0.001          0.001 0.312 0.430 #> sigmaGrowth_g_day               2.083 0.275    0.005          0.005 1.628 2.060 #>                                  97.5%  Rhat n.eff #> alpha_Growth_g_day              10.518 1.001  3165 #> beta_Growth_g_day_Temp_Centered  0.550 1.000  3000 #> sigmaGrowth_g_day                2.703 1.000  3000 #>  #> DIC: #> Mean deviance:  130.4  #> penalty 3.165  #> Penalized deviance: 133.6"},{"path":"https://because-pkg.github.io/because/articles/03_custom_priors.html","id":"custom-prior-model","dir":"Articles","previous_headings":"Example 1: Comparing Default and Custom Priors","what":"Custom Prior Model","title":"Custom Priors and Mechanistic Constraints","text":"Now, suppose strong prior knowledge scaling theory previous literature: 1. Intercept (Alpha): mean temperatures (20°C), metabolic constraints suggest growth around 10 g/day. 2. Slope (Beta): expect positive effect temperature, likely around 0.5 g/day/°C. parameter names usually follow convention: Intercepts: alphaResponseVariable (e.g., alphaGrowth_g_day) Slopes: beta_Response_Predictor (e.g., beta_Growth_g_day_Temp_Centered) Residual precision: tau_e_Response Notice credible intervals custom model tighter centered closer priors, especially data sparse (small N).","code":"# Define our custom priors my_priors <- list(     # Strong prior on intercept: Mean 10, Precision 100 (SD = 0.1)     alphaGrowth_g_day = \"dnorm(10, 100)\",      # Informative prior on slope: Mean 0.5, Precision 400 (SD = 0.05)     beta_Growth_g_day_Temp_Centered = \"dnorm(0.5, 400)\" )  fit_custom <- because(     equations = list(Growth_g_day ~ Temp_Centered),     data = df,     priors = my_priors ) #> Converted data.frame to list with 2 variables: Growth_g_day, Temp_Centered #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 30 #>    Unobserved stochastic nodes: 3 #>    Total graph size: 161 #>  #> Initializing model  summary(fit_custom) #>                                  Mean    SD Naive SE Time-series SE  2.5%   50% #> alpha_Growth_g_day              9.756 0.386    0.007          0.007 8.992 9.760 #> beta_Growth_g_day_Temp_Centered 0.472 0.039    0.001          0.001 0.398 0.471 #> sigmaGrowth_g_day               2.077 0.272    0.005          0.005 1.629 2.051 #>                                  97.5%  Rhat n.eff #> alpha_Growth_g_day              10.500 1.001  3168 #> beta_Growth_g_day_Temp_Centered  0.546 1.000  3000 #> sigmaGrowth_g_day                2.696 1.000  3000 #>  #> DIC: #> Mean deviance:  130.2  #> penalty 2.521  #> Penalized deviance: 132.7"},{"path":"https://because-pkg.github.io/because/articles/03_custom_priors.html","id":"visualizing-the-impact","dir":"Articles","previous_headings":"Example 1: Comparing Default and Custom Priors","what":"Visualizing the Impact","title":"Custom Priors and Mechanistic Constraints","text":"can plot posterior estimates together see “shrinkage” effect informative priors.","code":"# We can use the helper function plot_posterior() to compare models. # By passing a list of models, they are overlaid on the same plot. # The 'parameter' argument uses partial matching (regex), so \"Growth_g_day\" # will match both the intercept (alphaGrowth_g_day) and the slope (beta_Growth_g_day...).  plot_posterior(     model = list(\"Default\" = fit_default, \"Custom\" = fit_custom),     parameter = \"Growth_g_day\" )"},{"path":"https://because-pkg.github.io/because/articles/03_custom_priors.html","id":"example-2-mechanistic-constraints","dir":"Articles","previous_headings":"","what":"Example 2: Mechanistic Constraints","title":"Custom Priors and Mechanistic Constraints","text":"many biological contexts, negative effect just unlikely, physically impossible. example, consider relationship Body Mass Metabolic Rate (Kleiber’s Law). larger animal simply consume less energy smaller one (negative slope), else equal. physics life requires costs scale positively mass. However, sample size small measurement error huge, might accidentally estimate negative slope. can prevent enforcing positive prior.","code":"# Simulate data following Kleiber's Law: MR = a * Mass^0.75 # Taking logs: log(MR) = log(a) + 0.75 * log(Mass) set.seed(42) Mass <- runif(30, 10, 100) # True scaling exponent is 0.75 # We add enough noise that the estimated slope might be negative by chance Log_Mass <- log(Mass) Log_MR <- 1.5 + 0.75 * Log_Mass + rnorm(30, sd = 2.5)  df_kleiber <- data.frame(Log_Mass, Log_MR)  # Prior: The scaling exponent (slope) must be positive # Physics dictates that metabolic cost increases with mass. positive_prior <- list(     beta_Log_MR_Log_Mass = \"dnorm(0, 1) T(0, )\" )  # 1. Fit Default Model (Unconstrained) - Log-Log regression fit_default_kleiber <- because(     equations = list(Log_MR ~ Log_Mass),     data = df_kleiber ) #> Converted data.frame to list with 2 variables: Log_MR, Log_Mass #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 30 #>    Unobserved stochastic nodes: 3 #>    Total graph size: 159 #>  #> Initializing model  # 2. Fit Mechanistic Model (Constrained) fit_mech_kleiber <- because(     equations = list(Log_MR ~ Log_Mass),     data = df_kleiber,     priors = positive_prior ) #> Converted data.frame to list with 2 variables: Log_MR, Log_Mass #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 30 #>    Unobserved stochastic nodes: 3 #>    Total graph size: 159 #>  #> Initializing model  # Compare Estimates summary(fit_default_kleiber) #>                       Mean    SD Naive SE Time-series SE   2.5%   50%  97.5% #> alpha_Log_MR         3.240 4.189    0.076          0.264 -5.155 3.253 11.523 #> beta_Log_MR_Log_Mass 0.111 1.023    0.019          0.066 -1.947 0.097  2.171 #> sigmaLog_MR          2.927 0.384    0.007          0.007  2.288 2.895  3.808 #>                       Rhat n.eff #> alpha_Log_MR         1.004   259 #> beta_Log_MR_Log_Mass 1.004   250 #> sigmaLog_MR          1.000  2895 #>  #> DIC: #> Mean deviance:  151.3  #> penalty 3.266  #> Penalized deviance: 154.5 summary(fit_mech_kleiber) #>                       Mean    SD Naive SE Time-series SE   2.5%   50% 97.5% #> alpha_Log_MR         1.282 1.923    0.035          0.064 -3.394 1.646 4.018 #> beta_Log_MR_Log_Mass 0.595 0.453    0.008          0.015  0.024 0.494 1.703 #> sigmaLog_MR          2.909 0.383    0.007          0.007  2.294 2.883 3.781 #>                       Rhat n.eff #> alpha_Log_MR         1.001   969 #> beta_Log_MR_Log_Mass 1.001  1003 #> sigmaLog_MR          1.000  3165 #>  #> DIC: #> Mean deviance:  150.6  #> penalty 2.305  #> Penalized deviance: 152.9  # Visualize: Unconstrained vs. Truncated plot_posterior(     list(Unconstrained = fit_default_kleiber, Mechanistic = fit_mech_kleiber),     parameter = \"beta_Log_MR_Log_Mass\",     density_args = list(Mechanistic = list(from = 0)) )"},{"path":"https://because-pkg.github.io/because/articles/03_custom_priors.html","id":"example-3-informing-residual-variance-components","dir":"Articles","previous_headings":"","what":"Example 3: Informing Residual Variance components","title":"Custom Priors and Mechanistic Constraints","text":"usually estimate residual variance (sigma inverse tau) data. However, might prior knowledge expected noise level. [!NOTE] Distinction variability argument: variability argument () designed Measurement Error predictors (Error--Variables) repeated measures per individual. Custom priors tau_e, shown , providing information Residual Variance response variable (includes Process Error unrecognized Observation Error). example, know precision scale roughly 2 g, gives strong expectation residual standard deviation (sigma).","code":"# Simulate small, noisy dataset set.seed(42) N_small <- 15 Temp_Small <- rnorm(N_small, 20, 5) # Actual residual SD = 3 (quite noisy) Growth_Small <- 0.5 * Temp_Small + rnorm(N_small, sd = 3) df_small <- data.frame(Growth_g_day = Growth_Small, Temp_Centered = Temp_Small - 20)  # 1. Default Model (Weak Prior) # The data (SD=3) will dominate, finding a sigma around 3 with wide uncertainty. fit_default_var <- because(     equations = list(Growth_g_day ~ Temp_Centered),     data = df_small,     quiet = TRUE )  # 2. Constrained Model (Strong Prior) # Suppose we have theoretical reasons to believe residual SD should be small (~1.0). # Precision = 1/1^2 = 1. # dgamma(20, 20) -> Mean 1, Variance 0.05 (Strong) variance_prior <- list(     tau_e_Growth_g_day = \"dgamma(20, 20)\" )  fit_constrained_var <- because(     equations = list(Growth_g_day ~ Temp_Centered),     data = df_small,     priors = variance_prior,     quiet = TRUE )  # Visualize: The constrained posterior will be shifted left (towards 1) and sharper plot_posterior(     list(Default = fit_default_var, Constrained = fit_constrained_var),     parameter = \"sigma\" )"},{"path":"https://because-pkg.github.io/because/articles/03_custom_priors.html","id":"default-priors-reference","dir":"Articles","previous_headings":"","what":"Default Priors Reference","title":"Custom Priors and Mechanistic Constraints","text":"important know overriding. aims use weakly informative defaults provide minimal regularization allowing data dominate posterior. Precision vs Variance: JAGS uses precision τ=1/σ2\\tau = 1/\\sigma^2. prior dnorm(0, 1.0E-6) means normal distribution mean 0 precision 0.0000010.000001, corresponds variance 1,000,0001,000,000 (SD = 1000). flat.","code":""},{"path":"https://because-pkg.github.io/because/articles/03_custom_priors.html","id":"parameter-names-reference","dir":"Articles","previous_headings":"","what":"Parameter Names Reference","title":"Custom Priors and Mechanistic Constraints","text":"use custom priors, need know exact internal name parameter JAGS code. Common patterns: alpha_{Response}: Intercept beta_{Response}_{Predictor}: Regression coefficient tau_e_{Response}: Residual precision sigma_{Response}: Residual standard deviation (derived, usually set directly prior, set tau instead) lambda_{Response}: Phylogenetic signal (0-1) psi_{Response}: Zero-inflation probability unsure, run quick model n.adapt=0, n.iter=0 (just compilation) check generated model code: ```","code":"fit_check <- because(     equations = list(Growth_g_day ~ Temp_Centered),     data = df,     n.iter = 0, quiet = TRUE )  # Print the JAGS model fit_check$model #> JAGS model: #>  #> model { #>   # Structural equations #>   for (i in 1:N) { #>  #>     mu_Growth_g_day[i] <- alpha_Growth_g_day + beta_Growth_g_day_Temp_Centered*Temp_Centered[i] #>   } #>   # Multivariate normal likelihoods #>   for (i in 1:N) { #>     Growth_g_day[i] ~ dnorm(mu_Growth_g_day[i], tau_e_Growth_g_day) #>     log_lik_Growth_g_day[i] <- logdensity.norm(Growth_g_day[i], mu_Growth_g_day[i], tau_e_Growth_g_day) #>   } #>   # Priors for structural parameters #>   alpha_Growth_g_day ~ dnorm(0, 1.0E-6) #>   tau_e_Growth_g_day ~ dgamma(1, 1) #>   sigmaGrowth_g_day <- 1/sqrt(tau_e_Growth_g_day) #>   beta_Growth_g_day_Temp_Centered ~ dnorm(0, 1.0E-6) #> } #> Fully observed variables: #>  Growth_g_day N Temp_Centered"},{"path":"https://because-pkg.github.io/because/articles/04_mediation.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Mediation Analysis","text":"Causal inference often requires investigating effect occurs. XX affect YY directly, work mediator MM? package provides fully automated Bayesian mediation analysis tool, because_mediation(), decomposes Total Effect exposure outcome : 1. Direct Effect: effect X→YX \\Y mediated variables graph. 2. Indirect Effect(s): effect propagated intermediate variables (X→M→YX \\M \\Y). calculated multiplying posterior distributions coefficients along path, preserving full uncertainty quantification.","code":""},{"path":"https://because-pkg.github.io/because/articles/04_mediation.html","id":"example-ecological-mediation-elevation-gradient","dir":"Articles","previous_headings":"","what":"Example: Ecological Mediation (Elevation Gradient)","title":"Mediation Analysis","text":"example, investigate Elevation affects Plant Abundance. hypothesize Elevation acts causal chain involving Temperature Soil Moisture: Elevation determines Temperature (higher elevation →\\lower temperature). Temperature influences Soil Moisture (lower temperature →\\lower evaporation →\\higher moisture). Abundance driven Moisture, Temperature, potentially direct effect Elevation (e.g., due UV radiation partial pressure gases).","code":""},{"path":"https://because-pkg.github.io/because/articles/04_mediation.html","id":"simulate-data","dir":"Articles","previous_headings":"Example: Ecological Mediation (Elevation Gradient)","what":"1. Simulate Data","title":"Mediation Analysis","text":"simulate N=200N=200 plots along elevation gradient.","code":"library(because)  set.seed(42) N <- 200  # 1. Elevation (Exogenous variable) # Ranges roughly from 500m to 1500m Elevation <- rnorm(N, mean = 1000, sd = 200)  # 2. Temperature (Mediator 1) # Decreases with Elevation (Lapse rate approx effect) # Coef: -0.01 implies 100m climb -> -1 degree C Temp <- 25 - 0.01 * Elevation + rnorm(N, sd = 2)  # 3. Moisture (Mediator 2) # Driven by Temperature. Cooler -> Moister. # We model a negative relationship with Temp. Moisture <- 20 - 2 * Temp + rnorm(N, sd = 5)  # 4. Plant Abundance (Outcome) # - Positive effect of Moisture (+0.5) # - Positive effect of Temperature (+1.5) # - Direct negative effect of Elevation (-0.005) due to harsh conditions Abundance <- 10 + 0.5 * Moisture + 1.5 * Temp - 0.005 * Elevation + rnorm(N, sd = 10)  eco_data <- data.frame(Elevation, Temp, Moisture, Abundance) head(eco_data) #>   Elevation      Temp   Moisture Abundance #> 1 1274.1917  8.256225  10.162114  18.60961 #> 2  887.0604 16.796951 -17.940260  26.01320 #> 3 1072.6257 16.616393 -12.955352  32.96032 #> 4 1126.5725 17.853353 -15.461372  31.77216 #> 5 1080.8537 11.437740  -5.767259  12.26349 #> 6  978.7751 12.910538 -10.814769  34.70524"},{"path":"https://because-pkg.github.io/because/articles/04_mediation.html","id":"standardize-data","dir":"Articles","previous_headings":"Example: Ecological Mediation (Elevation Gradient)","what":"2. Standardize Data","title":"Mediation Analysis","text":"Important: mediation analysis, highly recommended standardize continuous variables (mean = 0, sd = 1) fitting. Standardization ensures : 1. Coefficients comparable: effects expressed standard deviation units (standardized effects). 2. Scale Invariance: calculation Indirect Effects (product coefficients) interpretable relative Total Effect. 3. Convergence: MCMC sampling often behaves better standardized scales.","code":"# Standardize all variables eco_data_std <- scale(eco_data) head(eco_data_std) #>        Elevation       Temp    Moisture  Abundance #> [1,]  1.43491089 -2.4146372  2.79684187 -0.2519564 #> [2,] -0.55122296  0.6086453 -1.01750576  0.4847317 #> [3,]  0.40079909  0.5447309 -0.34090197  1.1759989 #> [4,]  0.67756730  0.9825952 -0.68104515  1.0577725 #> [5,]  0.44301183 -1.2884308  0.63474109 -0.8834208 #> [6,] -0.08069081 -0.7670836 -0.05035969  1.3496260"},{"path":"https://because-pkg.github.io/because/articles/04_mediation.html","id":"fit-the-structural-equation-model","dir":"Articles","previous_headings":"Example: Ecological Mediation (Elevation Gradient)","what":"3. Fit the Structural Equation Model","title":"Mediation Analysis","text":"define structural equations reflecting causal DAG. Notice chain: Elevation -> Temp -> Moisture -> Abundance. can also plot fitted causal model standardised paths:","code":"# Define the structural equations eco_eqs <- list(   Temp ~ Elevation,   Moisture ~ Temp,   Abundance ~ Moisture + Temp + Elevation )  # Fit the model # We use a short chain for demonstration purposes. Use more iterations for real analysis. fit <- because(   equations = eco_eqs,   data = eco_data_std,   n.iter = 2000 ) #> Converted data.frame to list with 4 variables: Temp, Elevation, Moisture, Abundance #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 600 #>    Unobserved stochastic nodes: 11 #>    Total graph size: 3021 #>  #> Initializing model summary(fit) #>                            Mean    SD Naive SE Time-series SE   2.5%    50% #> alpha_Abundance           0.000 0.069    0.003          0.003 -0.132 -0.001 #> alpha_Moisture           -0.002 0.051    0.002          0.002 -0.099 -0.003 #> alpha_Temp                0.005 0.048    0.002          0.002 -0.080  0.004 #> beta_Abundance_Elevation -0.157 0.101    0.005          0.005 -0.341 -0.160 #> beta_Abundance_Moisture   0.353 0.091    0.004          0.004  0.180  0.356 #> beta_Abundance_Temp       0.408 0.119    0.005          0.005  0.189  0.411 #> beta_Moisture_Temp       -0.709 0.052    0.002          0.002 -0.806 -0.709 #> beta_Temp_Elevation      -0.738 0.048    0.002          0.002 -0.830 -0.743 #> sigmaAbundance            0.935 0.047    0.002          0.002  0.854  0.932 #> sigmaMoisture             0.712 0.035    0.002          0.001  0.644  0.712 #> sigmaTemp                 0.678 0.034    0.002          0.001  0.617  0.678 #>                           97.5%  Rhat n.eff #> alpha_Abundance           0.138 1.004   480 #> alpha_Moisture            0.087 1.002   480 #> alpha_Temp                0.107 1.001   693 #> beta_Abundance_Elevation  0.054 1.001   480 #> beta_Abundance_Moisture   0.537 0.998   493 #> beta_Abundance_Temp       0.628 1.000   578 #> beta_Moisture_Temp       -0.612 0.998   550 #> beta_Temp_Elevation      -0.648 1.013   492 #> sigmaAbundance            1.030 0.998   442 #> sigmaMoisture             0.783 0.998   603 #> sigmaTemp                 0.744 1.000   604 #>  #> DIC: #> Mean deviance:  1377  #> penalty 11.16  #> Penalized deviance: 1388 plot_dag(fit)"},{"path":"https://because-pkg.github.io/because/articles/04_mediation.html","id":"perform-mediation-analysis","dir":"Articles","previous_headings":"Example: Ecological Mediation (Elevation Gradient)","what":"4. Perform Mediation Analysis","title":"Mediation Analysis","text":"want understand Total Effect Elevation Abundance, decompose direct indirect components.","code":"# Run Mediation Analysis for Elevation -> Abundance med_results <- because_mediation(fit, exposure = \"Elevation\", outcome = \"Abundance\")"},{"path":"https://because-pkg.github.io/because/articles/04_mediation.html","id":"inspect-the-summary","dir":"Articles","previous_headings":"Example: Ecological Mediation (Elevation Gradient) > 4. Perform Mediation Analysis","what":"Inspect the Summary","title":"Mediation Analysis","text":"Interpretation (Standardized Units): * Total Effect: net impact Elevation Abundance SD units. * Direct Effect: path Elevation -> Abundance (independent mediators). * Total Indirect Effect: sum mediated paths. simulation, Elevation lowers Temp, raises Moisture, increases Abundance.","code":"med_results$summary #>                    Type       Mean         SD      Lower       Upper #> 1          Total Effect -0.2736813 0.06781102 -0.4064066 -0.12873398 #> 2         Direct Effect -0.1570835 0.10138569 -0.3412616  0.05359304 #> 3 Total Indirect Effect -0.1165978 0.07616327 -0.2766890  0.02484438"},{"path":"https://because-pkg.github.io/because/articles/04_mediation.html","id":"inspect-individual-paths","dir":"Articles","previous_headings":"Example: Ecological Mediation (Elevation Gradient) > 4. Perform Mediation Analysis","what":"Inspect Individual Paths","title":"Mediation Analysis","text":"because_mediation function automatically traces valid paths exposure outcome DAG. expect see three distinct paths: Direct: Elevation -> Abundance Elevation lowers Temp (negative correlation); Temp increases Abundance (positive correlation). product effects Negative. Elevation lowers Temp (negative). Lower Temp raises Moisture (negative relationship →\\positive change moisture). Higher Moisture raises Abundance (positive). chain involves two negative links one positive link, resulting Positive indirect effect. function handles decomposition automatically, providing credibility intervals specific mechanism.","code":"med_results$paths #>                                         Path     Type       Mean         SD #> 1 Elevation -> Temp -> Moisture -> Abundance Indirect  0.1847236 0.05171803 #> 2             Elevation -> Temp -> Abundance Indirect -0.3013214 0.09070711 #> 3                     Elevation -> Abundance   Direct -0.1570835 0.10138569 #>         Lower       Upper #> 1  0.09250807  0.30043116 #> 2 -0.47230373 -0.14221839 #> 3 -0.34126157  0.05359304"},{"path":"https://because-pkg.github.io/because/articles/04_mediation.html","id":"technical-note","dir":"Articles","previous_headings":"Example: Ecological Mediation (Elevation Gradient)","what":"Technical Note","title":"Mediation Analysis","text":"function calculates indirect effect product coefficients along path. example, long chain: Indirectchain=βElev→Temp×βTemp→Moist×βMoist→Abund \\text{Indirect}_{\\text{chain}} = \\beta_{Elev \\Temp} \\times \\beta_{Temp \\Moist} \\times \\beta_{Moist \\Abund}  approach standard linear models. non-linear models, represents approximation average causal effect.","code":""},{"path":[]},{"path":"https://because-pkg.github.io/because/articles/extensions.html","id":"phybase-because-phybase","dir":"Articles","previous_headings":"Available packages","what":"PhyBaSE (because.phybase)","title":"Extensions","text":".phybase package adds support phylogenetic covariance structures, enabling fitting Phylogenetic Bayesian Structural Equation Models (PhyBaSE; von Hardenberg & Gonzalez-Voyer, 2025). Features Phylogenetic Covariance: Incorporates phylogenetic relatedness models. Phylogenetic Uncertainty: Supports multiPhylo objects account uncertainty tree topology branch lengths. Measurement error: Accounting measurement error traits providing repeated measures well specifying known measurement error variances. Phylogenetic missing data imputation: informs imputation missing data using phylogenetic relationships. Seamless Integration: Designed work transparently via S3 method dispatch.","code":""},{"path":[]},{"path":"https://because-pkg.github.io/because/articles/extensions.html","id":"occupancy-because-occupancy","dir":"Articles","previous_headings":"Planned packages","what":"Occupancy (because.occupancy)","title":"Extensions","text":"Status: Development Adds support hierarchical single joint-species single-season occupancy models within causal inference framework (Occupancy SEMs).","code":""},{"path":"https://because-pkg.github.io/because/articles/extensions.html","id":"spatial-because-spatial","dir":"Articles","previous_headings":"Planned packages","what":"Spatial (because.spatial)","title":"Extensions","text":"Status: Planned add support spatially structured residuals (CAR/SAR models).","code":""},{"path":"https://because-pkg.github.io/because/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Achaz von Hardenberg. Author, maintainer.","code":""},{"path":"https://because-pkg.github.io/because/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"von Hardenberg, . (2025). : Bayesian Estimation Causal Effects. R package version 0.9.5. https://github.com/achazhardenberg/","code":"@Manual{,   title = {because: Bayesian Estimation of Causal Effects},   author = {Achaz {von Hardenberg}},   year = {2025},   note = {R package version 0.9.5},   url = {https://github.com/achazhardenberg/because}, }"},{"path":[]},{"path":"https://because-pkg.github.io/because/index.html","id":"bayesian-estimation-of-causal-effects","dir":"","previous_headings":"","what":"Bayesian Estimation of Causal Effects","title":"Bayesian Estimation of Causal Effects","text":"provides unified framework specifying fitting Bayesian structural equation models R using JAGS. focus causal inference, providing tools facilitate correct estimation testng direct indirect causal effects complex systems quantify uncertainty estimates. Note logo: package hexagon sticker features mathematical symbol “”, represented three dots inverted triangle (∵\\).","code":""},{"path":"https://because-pkg.github.io/because/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Bayesian Estimation of Causal Effects","text":"simplifies process running complex Bayesian Structural Equation Models automatically generating JAGS code standard R formulas. Key features include: Automatic JAGS Code Generation: Builds models directly list structural equations. Generalized Covariance Structures: Supports specification custom covariance structures data. Missing Data Support: Imputes missing values response predictor variables (assuming data missing random (MAR) completely random (MCAR). Measurement Error: Accounts measurement error providing repeated measures known error variances. Distribution families: Supports Gaussian, Binomial, Multinomial, Ordinal, Poisson,Negative Binomial well Zero Inflated Poisson (ZIP) Zero Inflated Negative Binomial (ZINP) distributions. Categorical Predictors: Automatic handling factor variables dummy variable expansion. Polynomial Interaction Terms: Easily include polynomial terms interactions structural equations. Hierachical Models: Support random effects multi-level structures. Latent Variables: Support explicitly including Latent variables modelling induced correlations latent common causes Maximum Acyclic Graph (MAG) method. Causal inference tools: native support d-separation m-separation testing mediation analysis. Parallel Computing: Run MCMC chains parallel multi-core systems faster computation. Visualisation tools: Functions visualizing model structures posterior distributions. Extension packages: Full S3 support extension packages build core functionality.","code":""},{"path":"https://because-pkg.github.io/because/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian Estimation of Causal Effects","text":"install stable release (v0.9.8), run: install latest development version (unstable), run:","code":"remotes::install_github(\"because-pkg/because@v0.9.8\", build_vignettes = TRUE) remotes::install_github(\"because-pkg/because\", build_vignettes = TRUE)"},{"path":"https://because-pkg.github.io/because/index.html","id":"prerequisites","dir":"","previous_headings":"","what":"Prerequisites","title":"Bayesian Estimation of Causal Effects","text":"using , need JAGS (Just Another Gibbs Sampler) installed machine. macOS: brew install jags download SourceForge. Windows: Download installer SourceForge. Linux: sudo apt-get install jags.","code":""},{"path":"https://because-pkg.github.io/because/reference/auto_detect_hierarchical.html","id":null,"dir":"Reference","previous_headings":"","what":"Auto-Detect Hierarchical Data Structure — auto_detect_hierarchical","title":"Auto-Detect Hierarchical Data Structure — auto_detect_hierarchical","text":"Infers levels, hierarchy, link variables list data.frames","code":""},{"path":"https://because-pkg.github.io/because/reference/auto_detect_hierarchical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auto-Detect Hierarchical Data Structure — auto_detect_hierarchical","text":"","code":"auto_detect_hierarchical(data, eq_vars, quiet = FALSE)"},{"path":"https://because-pkg.github.io/because/reference/auto_detect_hierarchical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auto-Detect Hierarchical Data Structure — auto_detect_hierarchical","text":"data List data.frames different hierarchical levels eq_vars Character vector variable names used equations quiet Logical, TRUE suppress messages","code":""},{"path":"https://because-pkg.github.io/because/reference/auto_detect_hierarchical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auto-Detect Hierarchical Data Structure — auto_detect_hierarchical","text":"List 'levels', 'hierarchy', 'link_vars'","code":""},{"path":"https://because-pkg.github.io/because/reference/auto_stack_multispecies_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Auto-Stack Multispecies Data — auto_stack_multispecies_data","title":"Auto-Stack Multispecies Data — auto_stack_multispecies_data","text":"Converts list matrices (Wide) stacked dataframe (Long) hierarchical analysis. Replicates site species covariates accordingly.","code":""},{"path":"https://because-pkg.github.io/because/reference/auto_stack_multispecies_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auto-Stack Multispecies Data — auto_stack_multispecies_data","text":"","code":"auto_stack_multispecies_data(data, equations, quiet = FALSE)"},{"path":"https://because-pkg.github.io/because/reference/auto_stack_multispecies_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auto-Stack Multispecies Data — auto_stack_multispecies_data","text":"data Input list data (e.g. list(Y=list(Sp1=mat...), Hab=vec, Trait=vec)) equations List model equations quiet Logical, suppress messages","code":""},{"path":"https://because-pkg.github.io/because/reference/auto_stack_multispecies_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auto-Stack Multispecies Data — auto_stack_multispecies_data","text":"List components: data New stacked dataframe random_part String append random formula (e.g. \"+ (1|SpeciesID)\") is_stacked Logical, whether stacking occurred","code":""},{"path":"https://because-pkg.github.io/because/reference/because.html","id":null,"dir":"Reference","previous_headings":"","what":"Run a Bayesian Structural Equation Model — because","title":"Run a Bayesian Structural Equation Model — because","text":"function fits Bayesian ...","code":""},{"path":"https://because-pkg.github.io/because/reference/because.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run a Bayesian Structural Equation Model — because","text":"","code":"because(   equations,   data,   id_col = NULL,   structure = NULL,   tree = NULL,   monitor = \"interpretable\",   n.chains = 3,   n.iter = 12500,   n.burnin = floor(n.iter/5),   n.thin = 10,   DIC = TRUE,   WAIC = FALSE,   n.adapt = floor(n.iter/5),   quiet = FALSE,   verbose = FALSE,   dsep = FALSE,   variability = NULL,   family = NULL,   distribution = NULL,   latent = NULL,   latent_method = \"correlations\",   standardize_latent = TRUE,   parallel = FALSE,   n.cores = parallel::detectCores() - 1,   cl = NULL,   ic_recompile = TRUE,   optimise = TRUE,   random = NULL,   levels = NULL,   hierarchy = NULL,   link_vars = NULL,   fix_residual_variance = NULL,   priors = NULL,   reuse_models = NULL )"},{"path":"https://because-pkg.github.io/because/reference/because.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run a Bayesian Structural Equation Model — because","text":"equations list model formulas describing structural equation model. id_col Character string specifying column name data.frame containing unit identifiers (species, individuals, sites, etc.). used : Match data rows tree tip labels (phylogenetic models) Link data external spatial custom covariance matrices. Note: standard random effects models (e.g. random = ~(1|species)) external structure (like tree) provided, argument required. grouping column read directly data. NULL (default): uses meaningful row names available. Ignored data already list. structure covariance structure model. Accepts: \"phylo\" object: Phylogenetic tree (Standard PGLS/PhyloSEM). \"multiPhylo\" object: List trees (incorporates phylogenetic uncertainty). NULL: Independent model (Standard SEM, covariance structure). matrix: Custom covariance precision matrix (e.g., spatial connectivity, kinship). tree (Deprecated alias structure). single phylogenetic tree class \"phylo\" list trees. Use structure instead new code. monitor Parameter monitoring mode. Options: \"interpretable\" (default): Monitor scientifically meaningful parameters: intercepts (alpha), regression coefficients (beta), phylogenetic signals (lambda) responses, WAIC terms. Excludes variance components (tau) auxiliary predictor parameters. \"\": Monitor model parameters including variance components implicit equation parameters. Custom vector: Provide character vector specific parameter names monitor. NULL: Auto-detect based model structure (equivalent \"interpretable\"). n.chains Number MCMC chains (default = 3). n.iter Total number MCMC iterations (default = 12500). n.burnin Number burn-iterations (default = n.iter / 5). n.thin Thinning rate (default = 10). DIC Logical; whether compute DIC using dic.samples() (default = TRUE). Note: DIC penalty inflated models measurement error repeated measures latent variables counted parameters (penalty ~ structural parameters + N). model comparison, use WAIC compare mean deviance across models similar structure. WAIC Logical; whether sample values WAIC deviance (default = FALSE). WAIC generally appropriate DIC hierarchical models latent variables. n.adapt Number adaptation iterations (default = n.iter / 5). quiet Logical; suppress JAGS output (default = FALSE). verbose Logical; TRUE, print generated JAGS model code data names (default = FALSE). dsep Logical; TRUE, monitor first beta structural equation (used d-separation testing). variability Optional specification variables measurement error within-species variability. Global Setting: \"reps\": Applies repeat-measures modeling continuous variables equations (except grouping variables). Expects X_obs matrix long-format data. \"se\": Applies measurement error modeling continuous variables. Expects X_se columns. Manual Specification (Named Vector/List): Simple: c(X = \"se\", Y = \"reps\") - mixed types Custom columns: list(X = list(type = \"se\", se_col = \"X_sd\")) SE: se_col (SE column), mean_col (mean column, optional) reps: obs_col (observations matrix column) Auto-Detection: specified, package attempts detect variability based column names: X_se -> type=\"se\" X_obs matrix column -> type=\"reps\" family Optional named character vector specifying family/distribution response variables. Default \"gaussian\" variables. Supported values: \"gaussian\" (default) \"binomial\" (binary data) \"multinomial\" (unordered categorical > 2 levels) \"ordinal\" (ordered categorical > 2 levels) \"poisson\" (count data) \"negbinomial\" (overdispersed count data) \"zip\" (zero-inflated poisson): Models excess zeros probability psi counts mean lambda. \"zinb\" (zero-inflated negative binomial): Models excess zeros probability psi overdispersed counts mean mu size r. \"occupancy\": Single-season site-occupancy model. State process: z ~ Bernoulli(psi). Observation process: y ~ Bernoulli(z * p). Requires data detection history matrix (sites x visits). model estimate zero-inflation probability parameter psi_Response distributions. Example: family = c(Gregarious = \"binomial\"). latent Optional character vector latent (unmeasured) variable names. specified, model account induced correlations among observed variables share latent common causes. latent_method Method handling latent variables (default = \"correlations\"). \"correlations\": MAG approach - marginalize latent variables estimate induced correlations (rho) observed variables share latent parents. \"explicit\": Model latent variables JAGS nodes estimate structural paths latents observed variables. standardize_latent Logical; TRUE latent_method = \"explicit\", adds standardized priors (N(0,1)) latent variables identify scale location. improves convergence makes regression coefficients interpretable standardized effects. applicable using explicit latent variable modeling (default = TRUE). parallel Logical; TRUE, run MCMC chains parallel (default = FALSE). Note: Requires n.cores > 1 take effect. n.cores Integer; number CPU cores use parallel chains (default = 1). used parallel = TRUE. cl Optional; cluster object created parallel::makeCluster(). NULL, cluster created destroyed automatically. ic_recompile Logical; TRUE parallel = TRUE, recompile model parallel chains compute DIC/WAIC (default = TRUE). adds small sequential overhead enables information criteria calculation. optimise Logical; TRUE (default), use optimized random effects formulation phylogenetic models. significantly faster (5-10x) numerically stable. FALSE, use traditional marginal formulation (slower, provided comparison). random Optional formula list formulas specifying global random effects applied equations (e.g. ~(1|species)). levels (Hierarchical Data) named list mapping variables hierarchy levels. Required data list data frames (hierarchical format). Example: list(individual = c(\"y\", \"x\"), site = c(\"z\")). hierarchy (Hierarchical Data) Character string describing topological ordering levels (e.g., \"site > individual\"). Required hierarchical data fully inferred random effects. link_vars (Hierarchical Data) Optional named character vector specifying variables used link data levels (e.g. c(site = \"site_id\")). fix_residual_variance Optional named vector fixing residual variances. Useful handling non-identified models specific theoretical constraints. Example: c(response_var = 1). priors Optional named list character strings specifying custom priors specific parameters. Enables overriding default uninformative priors. Example: list(alpha_Response = \"dnorm(0, 0.001)\", beta_Response_Predictor = \"dnorm(1, 10)\"). reuse_models List previously fitted '' models scan reusable d-separation test results. test current run matches test reused model (formula), result copied instead re-running JAGS. Note: Computing standard consistent data user's responsibility.","code":""},{"path":"https://because-pkg.github.io/because/reference/because.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run a Bayesian Structural Equation Model — because","text":"object class \"\" containing: samples MCMC samples (mcmc.list). parameter_map Data frame mapping parameter names model variables. model JAGS model code. summary Summary posterior samples. dsep_results List d-separation test results (dsep=TRUE). DIC Deviance Information Criterion (DIC=TRUE). WAIC Watanabe-Akaike Information Criterion (WAIC=TRUE).","code":""},{"path":"https://because-pkg.github.io/because/reference/because_compare.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare Because Models — because_compare","title":"Compare Because Models — because_compare","text":"unified function either (1) compare previously fitted models, (2) run multiple model specifications parallel compare .","code":""},{"path":"https://because-pkg.github.io/because/reference/because_compare.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare Because Models — because_compare","text":"","code":"because_compare(   ...,   model_specs = NULL,   data = NULL,   tree = NULL,   n.cores = 1,   cl = NULL,   sort = TRUE )"},{"path":"https://because-pkg.github.io/because/reference/because_compare.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare Because Models — because_compare","text":"... comparing fitted models: individual fitted model objects class \"\". running models: additional arguments passed (e.g., n.iter). model_specs named list model specifications run (Mode 2). element list containing arguments . Alternatively, argument can accept first fitted model object (Mode 1). data dataset (required Mode 2). Alternatively, second fitted model object (Mode 1). tree phylogenetic tree (optional Mode 2). Alternatively, third fitted model object (Mode 1). n.cores Number cores parallel execution (Mode 2). Default 1. cl Optional cluster object (Mode 2). sort Logical. TRUE (default), sort comparison table WAIC.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_compare.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare Because Models — because_compare","text":"comparing fitted models: class \"because_comparison\" object (data frame) WAIC rankings. running models: list containing: results List fitted model objects. comparison comparison data frame.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_compare.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compare Because Models — because_compare","text":"Mode 1: Compare Fitted Models Call because_compare(fit1, fit2) because_compare(models = list(fit1, fit2)). Extracts WAIC (SE) model ranks . Mode 2: Run Compare Call because_compare(model_specs = list(m1=..., m2=...), data=data, tree=tree). runs models parallel returns comparison.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_compare.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare Because Models — because_compare","text":"","code":"if (FALSE) { # \\dontrun{   # Mode 1: Compare existing fits   because_compare(fit1, fit2)    # Mode 2: Run and compare   specs <- list(m1 = list(equations = list(Y ~ X)), m2 = list(equations = list(Y ~ X + Z)))   res <- because_compare(specs, data = df, tree = tr, n.cores = 2)   print(res$comparison) } # }"},{"path":"https://because-pkg.github.io/because/reference/because_dsep.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract d-separation statements from a structural equation model — because_dsep","title":"Extract d-separation statements from a structural equation model — because_dsep","text":"function takes set structural equations defining causal model returns conditional independence statements (d-separation m-separation tests) implied model structure. latent variables specified, function uses MAG (Mixed Acyclic Graph) approach Shipley Douma (2021) account unmeasured latent variables.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_dsep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract d-separation statements from a structural equation model — because_dsep","text":"","code":"because_dsep(   equations,   latent = NULL,   random_terms = list(),   hierarchical_info = NULL,   poly_terms = NULL,   categorical_vars = NULL,   family = NULL,   quiet = FALSE )"},{"path":"https://because-pkg.github.io/because/reference/because_dsep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract d-separation statements from a structural equation model — because_dsep","text":"equations list model formulas (one per structural equation), e.g., list(Y ~ X1 + X2, Z ~ Y). latent Optional character vector latent (unmeasured) variable names. provided, function converts DAG MAG returns m-separation tests. random_terms Optional list random effects (group, type) parsed equations. hierarchical_info Internal argument used pass data hierarchy information (levels, grouping variables) future implementation multilevel d-separation tests (following Shipley 2009). Currently unused d-separation logic. quiet Logical; FALSE (default), print basis set MAG structure. TRUE, suppress informational output.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_dsep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract d-separation statements from a structural equation model — because_dsep","text":"latent NULL, returns list formulas representing conditional independence tests. latent specified, returns list : tests: List m-separation test formulas correlations: List variable pairs induced correlations","code":""},{"path":"https://because-pkg.github.io/because/reference/because_dsep.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract d-separation statements from a structural equation model — because_dsep","text":"function implements basis set approach d-separation testing (Shipley 2000, 2009, 2016). standard DAGs without latent variables, identifies pairs non-adjacent variables creates conditional independence tests. latent variables specified, function uses DAG--MAG conversion (Shipley & Douma 2021) identify m-separation statements induced correlations among observed variables arise shared latent common causes.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_dsep.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Extract d-separation statements from a structural equation model — because_dsep","text":"Shipley, B. (2000). new inferential test path models based directed acyclic graphs. Structural Equation Modeling, 7(2), 206-218. Shipley, B. (2009). Confirmatory path analysis generalized multilevel context. Ecology, 90(2), 363-368. Shipley, B. (2016). Cause Correlation Biology (2nd ed.). Cambridge University Press. Shipley, B., & Douma, J. C. (2021). Testing Piecewise Structural Equations Models Presence Latent Variables Including Correlated Errors. Structural Equation Modeling: Multidisciplinary Journal, 28(4), 582–589. https://doi.org/10.1080/10705511.2020.1871355","code":""},{"path":"https://because-pkg.github.io/because/reference/because_dsep.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract d-separation statements from a structural equation model — because_dsep","text":"","code":"# Standard DAG equations <- list(LS ~ BM, NL ~ BM + RS, DD ~ NL) ind_tests <- because_dsep(equations) #> Basis Set for DAG:  #> I(X,Y|Z) means X is d-separated from Y given the set Z in the DAG  #> I( RS , BM |  )  #> I( RS , DD | NL )  #> I( RS , LS | BM )  #> I( BM , DD | NL )  #> I( NL , LS | BM, RS )  #> I( DD , LS | BM, NL )   # With latent variable equations_latent <- list(X ~ Quality, Y ~ Quality) result <- because_dsep(equations_latent, latent = \"Quality\") #> Basis Set for MAG:  #> I(X,Y|Z) means X is m-separated from Y given the set Z in the MAG  #> No elements in the basis set  # result$tests: m-separation tests # result$correlations: induced correlation between X and Y"},{"path":"https://because-pkg.github.io/because/reference/because_family.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Custom Family (Distribution) for use with because — because_family","title":"Create a Custom Family (Distribution) for use with because — because_family","text":"helper function allows users easily create custom distribution families providing JAGS likelihood code. function handles S3 method registration.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_family.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Custom Family (Distribution) for use with because — because_family","text":"","code":"because_family(   name,   jags_likelihood,   link = \"identity\",   extra_priors = NULL,   description = NULL )"},{"path":"https://because-pkg.github.io/because/reference/because_family.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Custom Family (Distribution) for use with because — because_family","text":"name Character string; name family (e.g., \"student_t\"). jags_likelihood character string JAGS likelihood code. Use placeholders: {response} variable name, {mu} mean, {} loop index, {tau} precision parameter. link Link function name (default: \"identity\"). Options: \"identity\", \"log\", \"logit\". extra_priors Character vector additional JAGS prior statements. Use {response} placeholder variable-specific naming. description Optional description family.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_family.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Custom Family (Distribution) for use with because — because_family","text":"constructor function family can passed (..., family = ...).","code":""},{"path":"https://because-pkg.github.io/because/reference/because_family.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Custom Family (Distribution) for use with because — because_family","text":"","code":"if (FALSE) { # \\dontrun{ # Create a Student-t family for robust regression student_t <- because_family(   name = \"student_t\",   jags_likelihood = \"{response}[{i}] ~ dt({mu}[{i}], {tau}, df_{response})\",   extra_priors = c(\"df_{response} ~ dunif(2, 100)\") )  # Use it fit <- because(Y ~ X, data = data, family = student_t()) } # }"},{"path":"https://because-pkg.github.io/because/reference/because_format_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Format Data for Because Analysis — because_format_data","title":"Format Data for Because Analysis — because_format_data","text":"Converts data long format (one row per observation) list format required .","code":""},{"path":"https://because-pkg.github.io/because/reference/because_format_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format Data for Because Analysis — because_format_data","text":"","code":"because_format_data(data, species_col = \"SP\", tree = NULL)"},{"path":"https://because-pkg.github.io/because/reference/because_format_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format Data for Because Analysis — because_format_data","text":"data data.frame long format one row per observation. species_col Name column containing species identifiers (default: \"SP\"). tree phylogenetic tree (class phylo). Optional. provided, determines species order.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_format_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format Data for Because Analysis — because_format_data","text":"named list element either: numeric vector (species exactly 1 observation) numeric matrix species rows replicates columns Species ordered match tree$tip.label (provided) sorted alphabetically.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_format_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Format Data for Because Analysis — because_format_data","text":"function handles: Different numbers replicates per species (creates rectangular matrix NA padding) Missing values (NA) Automatic alignment phylogenetic tree tip labels (provided) species different numbers replicates, function creates matrix dimensions (number species) x (maximum number replicates). Species fewer replicates padded NA values. tree provided: Species tree data NA values. Species data tree excluded warning. tree provided: species data included, sorted alphabetically ID.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_format_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Format Data for Because Analysis — because_format_data","text":"","code":"if (FALSE) { # \\dontrun{ # Example data in long format data_long <- data.frame(   SP = c(\"sp1\", \"sp1\", \"sp1\", \"sp2\", \"sp2\", \"sp3\"),   BM = c(1.2, 1.3, 1.1, 2.1, 2.2, 1.8),   NL = c(0.5, 0.6, NA, 0.7, 0.8, 0.9) )  # With tree tree <- ape::read.tree(text = \"(sp1:1,sp2:1,sp3:1);\") data_list <- because_format_data(data_long, species_col = \"SP\", tree = tree)  # Without tree (general repeated measures) data_list_no_tree <- because_format_data(data_long, species_col = \"SP\") } # }"},{"path":"https://because-pkg.github.io/because/reference/because_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Pagel's Lambda from Variance Components — because_lambda","title":"Calculate Pagel's Lambda from Variance Components — because_lambda","text":"function calculates Pagel's lambda response variable fitted model extracting posterior samples phylogenetic residual variance components.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Pagel's Lambda from Variance Components — because_lambda","text":"","code":"because_lambda(model, prob = 0.95)"},{"path":"https://because-pkg.github.io/because/reference/because_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Pagel's Lambda from Variance Components — because_lambda","text":"model fitted model object class \"\". prob numeric value specifying probability mass credibility intervals (default 0.95).","code":""},{"path":"https://because-pkg.github.io/because/reference/because_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Pagel's Lambda from Variance Components — because_lambda","text":"data frame containing summary statistics derived lambda parameter(s): Mean Posterior mean SD Posterior standard deviation Median Posterior median LowerCI Lower bound credibility interval UpperCI Upper bound credibility interval","code":""},{"path":"https://because-pkg.github.io/because/reference/because_lambda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Pagel's Lambda from Variance Components — because_lambda","text":"optimized formulation , phylogenetic signal (\\(\\lambda\\)) always explicitly monitored complex models multiple structures. However, can derived post-hoc estimated standard deviations phylogenetic (\\(\\sigma_{phylo}\\)) residual (\\(\\sigma_{res}\\)) components: $$\\lambda = \\frac{\\sigma_{phylo}^2}{\\sigma_{phylo}^2 + \\sigma_{res}^2}$$ function performs calculation full posterior chains provide valid Bayesian estimates credibility intervals.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_lambda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Pagel's Lambda from Variance Components — because_lambda","text":"","code":"if (FALSE) { # \\dontrun{   fit <- because(...)   because_lambda(fit) } # }"},{"path":"https://because-pkg.github.io/because/reference/because_loo.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate LOO-CV for a Because Model — because_loo","title":"Calculate LOO-CV for a Because Model — because_loo","text":"Calculates Leave-One-Cross-Validation using Pareto Smoothed Importance Sampling (PSIS-LOO) fitted model.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_loo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate LOO-CV for a Because Model — because_loo","text":"","code":"because_loo(model, ...)"},{"path":"https://because-pkg.github.io/because/reference/because_loo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate LOO-CV for a Because Model — because_loo","text":"model fitted model object class \"\" returned . Note: model fitted WAIC = TRUE (log_lik missing), function automatically refit model (using short MCMC run) calculate likelihoods. ... Additional arguments passed loo::loo().","code":""},{"path":"https://because-pkg.github.io/because/reference/because_loo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate LOO-CV for a Because Model — because_loo","text":"loo object containing: estimates Table ELPD (expected log pointwise predictive density), LOO-IC, p_loo diagnostics Pareto k diagnostic values observation pointwise Pointwise contributions LOO-IC","code":""},{"path":"https://because-pkg.github.io/because/reference/because_loo.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate LOO-CV for a Because Model — because_loo","text":"LOO-CV (Leave-One-Cross-Validation) uses Pareto Smoothed Importance Sampling approximate leave-one-predictive performance without refitting model N times. particularly useful : Model comparison models different numbers latent variables Identifying influential observations (via Pareto k diagnostics) Robust predictive performance assessment Pareto k diagnostics: k < 0.5: Excellent (estimates reliable) 0.5 < k < 0.7: Good (estimates okay) 0.7 < k < 1: Problematic (estimates unreliable) k > 1: problematic (refit model excluding observations) Note implementation: function extracts pointwise log-likelihoods calculated JAGS model (monitored log_lik[]) WAIC = TRUE. re-compute likelihoods posterior samples R, ensuring consistency fitted model structure.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_loo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate LOO-CV for a Because Model — because_loo","text":"","code":"if (FALSE) { # \\dontrun{   fit <- because(data, tree, equations, WAIC = TRUE)   loo_result <- because_loo(fit)   print(loo_result)    # Check for problematic observations   plot(loo_result)    # Compare models   loo_compare(loo_result1, loo_result2) } # }"},{"path":"https://because-pkg.github.io/because/reference/because_loo_compare.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare Models Using LOO-CV — because_loo_compare","title":"Compare Models Using LOO-CV — because_loo_compare","text":"Wrapper loo::loo_compare() compare multiple models.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_loo_compare.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare Models Using LOO-CV — because_loo_compare","text":"","code":"because_loo_compare(...)"},{"path":"https://because-pkg.github.io/because/reference/because_loo_compare.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare Models Using LOO-CV — because_loo_compare","text":"... Two loo objects because_loo().","code":""},{"path":"https://because-pkg.github.io/because/reference/because_loo_compare.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare Models Using LOO-CV — because_loo_compare","text":"comparison table ranking models expected --sample predictive accuracy.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_loo_compare.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare Models Using LOO-CV — because_loo_compare","text":"","code":"if (FALSE) { # \\dontrun{   loo1 <- because_loo(fit1)   loo2 <- because_loo(fit2)   because_loo_compare(loo1, loo2) } # }"},{"path":"https://because-pkg.github.io/because/reference/because_mediation.html","id":null,"dir":"Reference","previous_headings":"","what":"Automated Mediation Analysis — because_mediation","title":"Automated Mediation Analysis — because_mediation","text":"Decomposes total effect exposure outcome direct indirect pathways tracing paths fitted DAG multiplying posterior coefficients.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_mediation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Automated Mediation Analysis — because_mediation","text":"","code":"because_mediation(fit, exposure, outcome, prob = 0.95)"},{"path":"https://because-pkg.github.io/because/reference/because_mediation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Automated Mediation Analysis — because_mediation","text":"fit fitted object (). exposure Character string; name exposure variable. outcome Character string; name outcome variable. prob Numeric; probability mass credible interval (default 0.95).","code":""},{"path":"https://because-pkg.github.io/because/reference/because_mediation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Automated Mediation Analysis — because_mediation","text":"list containing: paths: data frame summarizing path (Path string, Mean, SD, CI). summary: data frame summarizing Total, Direct, Total Indirect effects. samples: matrix posterior samples path total effect.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_mediation.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Automated Mediation Analysis — because_mediation","text":"function reconstructs causal graph parameter_map stored fit object. uses igraph find simple paths exposure outcome. path, identifies corresponding regression coefficients (beta_...) computes product across MCMC samples. Note: assumes linear relationships indirect effects (\\(\\beta_1 \\times \\beta_2\\)). non-linear models, approximation average causal effect.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a JAGS model string for Phylogenetic Bayesian SEM (Because) — because_model","title":"Generate a JAGS model string for Phylogenetic Bayesian SEM (Because) — because_model","text":"function builds model code passed JAGS based set structural equations. supports single multiple phylogenetic trees (account phylogenetic uncertainty). Missing values handled response predictor variables treating stochastic nodes.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a JAGS model string for Phylogenetic Bayesian SEM (Because) — because_model","text":"","code":"because_model(   equations,   multi.tree = FALSE,   latent_method = \"correlations\",   structure_names = \"phylo\",   structures = NULL,   random_structure_names = NULL,   random_terms = list(),   vars_with_na = NULL,   induced_correlations = NULL,   variability = NULL,   family = NULL,   optimise = TRUE,   standardize_latent = TRUE,   poly_terms = NULL,   latent = NULL,   categorical_vars = NULL,   fix_residual_variance = NULL,   priors = NULL,   hierarchical_info = NULL )"},{"path":"https://because-pkg.github.io/because/reference/because_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a JAGS model string for Phylogenetic Bayesian SEM (Because) — because_model","text":"equations list model formulas. multi.tree Logical; TRUE, incorporates phylogenetic uncertainty sampling across set trees. structure_names (Internal) Character vector names multiple trees/structures. vars_with_na Optional character vector response variable names missing data. variables use element-wise likelihoods instead multivariate normal. induced_correlations Optional list variable pairs induced correlations latent variables. element character vector length 2 specifying pair variables share latent common cause. variability Optional character vector named character vector variable names measurement error within-species variability. named, names variable names values type variability: \"se\" (mean standard error) \"reps\" (repeated measures). unnamed, defaults \"se\" specified variables. \"se\": Expects Var_mean Var_se data. model fixes observation error: Var_mean ~ dnorm(Var, 1/Var_se^2). \"reps\": Expects Var_obs (matrix) N_reps_Var (vector) data. model estimates observation error: Var_obs[,j] ~ dnorm(Var[], Var_tau). family Optional named character vector specifying family/distribution response variables. Default \"gaussian\" variables. Supported values: \"gaussian\", \"binomial\", \"multinomial\". \"binomial\" variables, model uses logit link Bernoulli likelihood, phylogenetic correlation modeled latent scale. optimise Logical. TRUE (default), use random effects formulation 4.6× speedup. FALSE, use original marginal covariance formulation. standardize_latent Logical (default TRUE). TRUE, standardizes latent variables unit variance. poly_terms (Internal) List polynomial terms model generation. latent Optional character vector latent variable names. fix_residual_variance Optional numeric value named vector fix residual variance.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a JAGS model string for Phylogenetic Bayesian SEM (Because) — because_model","text":"list two elements: model: character string containing JAGS model code. parameter_map: data frame mapping response variables predictors parameter names.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_model.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate a JAGS model string for Phylogenetic Bayesian SEM (Because) — because_model","text":"generated model includes: Linear predictors multivariate normal likelihoods response variable. Priors intercepts (alpha), slopes (beta), lambda parameters (lambda), residual precisions (tau). Phylogenetic covariance modeled via single VCV matrix (multi.tree = FALSE) 3D array multiVCV[,,K] categorical sampling across trees (multi.tree = TRUE). (Optional) Observation models variables measurement error: Type \"se\": Var_mean ~ dnorm(Var, 1/Var_se^2) Type \"reps\": Var_obs[,j] ~ dnorm(Var[], Var_tau) (Optional) Generalized linear mixed models non-Gaussian responses (e.g., binomial). (Optional) Element-wise likelihoods response variables missing data.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a JAGS model string for Phylogenetic Bayesian SEM (Because) — because_model","text":"","code":"eqs <- list(BR ~ BM, S ~ BR, G ~ BR, L ~ BR) cat(because_model(eqs, multi.tree = TRUE)$model) #> model { #>   # Structural equations #>   for (i in 1:N) { #>  #>     mu_BR[i] <- alpha_BR + beta_BR_BM*BM[i] #>     mu_S[i] <- alpha_S + beta_S_BR*BR[i] #>     mu_G[i] <- alpha_G + beta_G_BR*BR[i] #>     mu_L[i] <- alpha_L + beta_L_BR*BR[i] #>   } #>   # Multivariate normal likelihoods #>   u_std_BR_phylo[1:N] ~ dmnorm(zeros[1:N], Prec_phylo[1:N, 1:N, K]) #>   for (i in 1:N) { u_BR_phylo[i] <- u_std_BR_phylo[i] / sqrt(tau_u_BR_phylo) } #>   for (i in 1:N) { #>     BR[i] ~ dnorm(mu_BR[i] + u_BR_phylo[i], tau_e_BR) #>     log_lik_BR[i] <- logdensity.norm(BR[i], mu_BR[i] + u_BR_phylo[i], tau_e_BR) #>   } #>   u_std_S_phylo[1:N] ~ dmnorm(zeros[1:N], Prec_phylo[1:N, 1:N, K]) #>   for (i in 1:N) { u_S_phylo[i] <- u_std_S_phylo[i] / sqrt(tau_u_S_phylo) } #>   for (i in 1:N) { #>     S[i] ~ dnorm(mu_S[i] + u_S_phylo[i], tau_e_S) #>     log_lik_S[i] <- logdensity.norm(S[i], mu_S[i] + u_S_phylo[i], tau_e_S) #>   } #>   u_std_G_phylo[1:N] ~ dmnorm(zeros[1:N], Prec_phylo[1:N, 1:N, K]) #>   for (i in 1:N) { u_G_phylo[i] <- u_std_G_phylo[i] / sqrt(tau_u_G_phylo) } #>   for (i in 1:N) { #>     G[i] ~ dnorm(mu_G[i] + u_G_phylo[i], tau_e_G) #>     log_lik_G[i] <- logdensity.norm(G[i], mu_G[i] + u_G_phylo[i], tau_e_G) #>   } #>   u_std_L_phylo[1:N] ~ dmnorm(zeros[1:N], Prec_phylo[1:N, 1:N, K]) #>   for (i in 1:N) { u_L_phylo[i] <- u_std_L_phylo[i] / sqrt(tau_u_L_phylo) } #>   for (i in 1:N) { #>     L[i] ~ dnorm(mu_L[i] + u_L_phylo[i], tau_e_L) #>     log_lik_L[i] <- logdensity.norm(L[i], mu_L[i] + u_L_phylo[i], tau_e_L) #>   } #>   # Priors for structural parameters #>   alpha_BR ~ dnorm(0, 1.0E-6) #>   tau_e_BR ~ dgamma(1, 1) #>   tau_u_BR_phylo ~ dgamma(1, 1) #>   sigma_BR_phylo <- 1/sqrt(tau_u_BR_phylo) #>   lambdaBR <- (1/tau_u_BR_phylo) / ((1/tau_u_BR_phylo) + (1/tau_e_BR)) #>   sigma_BR_res <- 1/sqrt(tau_e_BR) #>   alpha_S ~ dnorm(0, 1.0E-6) #>   tau_e_S ~ dgamma(1, 1) #>   tau_u_S_phylo ~ dgamma(1, 1) #>   sigma_S_phylo <- 1/sqrt(tau_u_S_phylo) #>   lambdaS <- (1/tau_u_S_phylo) / ((1/tau_u_S_phylo) + (1/tau_e_S)) #>   sigma_S_res <- 1/sqrt(tau_e_S) #>   alpha_G ~ dnorm(0, 1.0E-6) #>   tau_e_G ~ dgamma(1, 1) #>   tau_u_G_phylo ~ dgamma(1, 1) #>   sigma_G_phylo <- 1/sqrt(tau_u_G_phylo) #>   lambdaG <- (1/tau_u_G_phylo) / ((1/tau_u_G_phylo) + (1/tau_e_G)) #>   sigma_G_res <- 1/sqrt(tau_e_G) #>   alpha_L ~ dnorm(0, 1.0E-6) #>   tau_e_L ~ dgamma(1, 1) #>   tau_u_L_phylo ~ dgamma(1, 1) #>   sigma_L_phylo <- 1/sqrt(tau_u_L_phylo) #>   lambdaL <- (1/tau_u_L_phylo) / ((1/tau_u_L_phylo) + (1/tau_e_L)) #>   sigma_L_res <- 1/sqrt(tau_e_L) #>   beta_BR_BM ~ dnorm(0, 1.0E-6) #>   beta_S_BR ~ dnorm(0, 1.0E-6) #>   beta_G_BR ~ dnorm(0, 1.0E-6) #>   beta_L_BR ~ dnorm(0, 1.0E-6) #>  #>   for (k in 1:Ntree) { #>     p[k] <- 1 / Ntree #>   } #>   K ~ dcat(p[]) #> }"},{"path":"https://because-pkg.github.io/because/reference/because_structure.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Custom Covariance Structure for use with because — because_structure","title":"Create a Custom Covariance Structure for use with because — because_structure","text":"helper function allows users easily create custom covariance structures providing just function computes precision (covariance) matrix. function handles S3 method registration automatically.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_structure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Custom Covariance Structure for use with because — because_structure","text":"","code":"because_structure(name, precision_fn, description = NULL)"},{"path":"https://because-pkg.github.io/because/reference/because_structure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Custom Covariance Structure for use with because — because_structure","text":"name Character string; name structure (e.g., \"spatial_knn\"). used create S3 class methods. precision_fn function takes structure data returns precision matrix (N x N). first return value precision matrix. Additional list elements can returned passed JAGS data. description Optional description structure documentation.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_structure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Custom Covariance Structure for use with because — because_structure","text":"constructor function creates structure objects custom class.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_structure.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a Custom Covariance Structure for use with because — because_structure","text":"function creates: constructor function (returned) creating structure objects S3 methods jags_structure_definition (generates JAGS code) S3 methods prepare_structure_data (prepares data JAGS) precision function return either: single matrix (precision matrix) list Prec (precision matrix) optionally data","code":""},{"path":"https://because-pkg.github.io/because/reference/because_structure.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Custom Covariance Structure for use with because — because_structure","text":"","code":"if (FALSE) { # \\dontrun{ # Create a spatial distance-decay structure spatial_decay <- because_structure(   name = \"spatial_decay\",   precision_fn = function(coords, decay_rate = 0.1) {     dist_mat <- as.matrix(dist(coords))     W <- exp(-decay_rate * dist_mat)     diag(W) <- 0     D <- diag(rowSums(W))     D - 0.99 * W  # Precision matrix   } )  # Use it my_struct <- spatial_decay(coords = my_coords, decay_rate = 0.2) fit <- because(Y ~ X, data = data, structure = my_struct) } # }"},{"path":"https://because-pkg.github.io/because/reference/because_waic.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate WAIC with Standard Errors for a Because Model — because_waic","title":"Calculate WAIC with Standard Errors for a Because Model — because_waic","text":"Calculates Widely Applicable Information Criterion (WAIC) standard errors fitted model using pointwise log-likelihoods.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_waic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate WAIC with Standard Errors for a Because Model — because_waic","text":"","code":"because_waic(model)"},{"path":"https://because-pkg.github.io/because/reference/because_waic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate WAIC with Standard Errors for a Because Model — because_waic","text":"model fitted model object class \"\" returned WAIC = TRUE.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_waic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate WAIC with Standard Errors for a Because Model — because_waic","text":"data frame columns Estimate SE containing: elpd_waic Expected log pointwise predictive density (higher better) p_waic Effective number parameters waic WAIC value (lower better model comparison) returned object also pointwise attribute containing individual observation contributions model comparison.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_waic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate WAIC with Standard Errors for a Because Model — because_waic","text":"function automatically called WAIC = TRUE. can also called manually. model originally fitted WAIC = TRUE (pointwise log-likelihoods missing), function automatically refit model (using short MCMC run) compute .","code":""},{"path":"https://because-pkg.github.io/because/reference/because_waic.html","id":"waic-definition","dir":"Reference","previous_headings":"","what":"WAIC Definition","title":"Calculate WAIC with Standard Errors for a Because Model — because_waic","text":"Widely Applicable Information Criterion (WAIC) calculated : $$WAIC = -2 \\times (lppd - p_{waic})$$ : \\(lppd = \\sum_{=1}^N \\log(\\frac{1}{S} \\sum_{s=1}^S \\exp(log\\_lik_{}))\\) log pointwise predictive density \\(p_{waic} = \\sum_{=1}^N \\text{var}(log\\_lik_{})\\) effective number parameters WAIC Algorithm: lpd (log pointwise predictive density): observation \\(\\), compute \\(\\log(\\text{mean}(\\exp(\\text{log\\_lik}_i)))\\) across MCMC samples p_waic: observation \\(\\), compute \\(\\text{var}(\\text{log\\_lik}_i)\\) across MCMC samples elpd_waic: \\(\\text{lpd}_i - \\text{p\\_waic}_i\\) observation waic: \\(-2 \\times \\sum \\text{elpd\\_waic}_i\\)","code":""},{"path":"https://because-pkg.github.io/because/reference/because_waic.html","id":"standard-errors","dir":"Reference","previous_headings":"","what":"Standard Errors","title":"Calculate WAIC with Standard Errors for a Because Model — because_waic","text":"Standard errors WAIC calculated using pointwise contributions: $$SE(WAIC) = \\sqrt{N \\times \\text{var}(waic_i)}$$ \\(waic_i = -2 \\times (lppd_i - p_{waic,})\\).","code":""},{"path":"https://because-pkg.github.io/because/reference/because_waic.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate WAIC with Standard Errors for a Because Model — because_waic","text":"Vehtari, ., Gelman, ., & Gabry, J. (2017). Practical Bayesian model evaluation using leave-one-cross-validation WAIC. Statistics Computing, 27(5), 1413-1432.","code":""},{"path":"https://because-pkg.github.io/because/reference/because_waic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate WAIC with Standard Errors for a Because Model — because_waic","text":"","code":"if (FALSE) { # \\dontrun{   # Fit model with WAIC monitoring   fit <- because(data, tree, equations, WAIC = TRUE)    # View WAIC with standard errors   fit$WAIC   #             Estimate   SE   # elpd_waic   -617.3   12.4   # p_waic        12.3    3.1   # waic        1234.5   24.8    # Compare two models   fit1$WAIC   fit2$WAIC   # Model with lower WAIC is preferred   # Difference is significant if |WAIC1 - WAIC2| > 2 * sqrt(SE1^2 + SE2^2) } # }"},{"path":"https://because-pkg.github.io/because/reference/ensure_log_lik.html","id":null,"dir":"Reference","previous_headings":"","what":"Ensure Log-Likelihoods are Available — ensure_log_lik","title":"Ensure Log-Likelihoods are Available — ensure_log_lik","text":"Internal helper check model object pointwise log-likelihoods. , automatically refits model (reduced settings) calculate .","code":""},{"path":"https://because-pkg.github.io/because/reference/ensure_log_lik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ensure Log-Likelihoods are Available — ensure_log_lik","text":"","code":"ensure_log_lik(model, quiet = FALSE)"},{"path":"https://because-pkg.github.io/because/reference/ensure_log_lik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ensure Log-Likelihoods are Available — ensure_log_lik","text":"model fitted model object. quiet Logical; TRUE, suppresses messages.","code":""},{"path":"https://because-pkg.github.io/because/reference/ensure_log_lik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ensure Log-Likelihoods are Available — ensure_log_lik","text":"matrix pointwise log-likelihoods (samples x observations).","code":""},{"path":"https://because-pkg.github.io/because/reference/equations_to_dag.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert becauseR equations to ggm DAG adjacency matrix — equations_to_dag","title":"Convert becauseR equations to ggm DAG adjacency matrix — equations_to_dag","text":"Convert becauseR equations ggm DAG adjacency matrix","code":""},{"path":"https://because-pkg.github.io/because/reference/equations_to_dag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert becauseR equations to ggm DAG adjacency matrix — equations_to_dag","text":"","code":"equations_to_dag(equations, exclude_vars = NULL)"},{"path":"https://because-pkg.github.io/because/reference/equations_to_dag.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert becauseR equations to ggm DAG adjacency matrix — equations_to_dag","text":"equations List formulas exclude_vars Character vector variable names exclude (e.g., grouping variables)","code":""},{"path":"https://because-pkg.github.io/because/reference/equations_to_dag.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert becauseR equations to ggm DAG adjacency matrix — equations_to_dag","text":"Named adjacency matrix ggm format","code":""},{"path":"https://because-pkg.github.io/because/reference/expand_nesting_syntax.html","id":null,"dir":"Reference","previous_headings":"","what":"Expand Nesting Syntax in Random Effects — expand_nesting_syntax","title":"Expand Nesting Syntax in Random Effects — expand_nesting_syntax","text":"Converts lme4-style nesting (1|/B) (1|) + (1|:B)","code":""},{"path":"https://because-pkg.github.io/because/reference/expand_nesting_syntax.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expand Nesting Syntax in Random Effects — expand_nesting_syntax","text":"","code":"expand_nesting_syntax(rhs)"},{"path":"https://because-pkg.github.io/because/reference/expand_nesting_syntax.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Expand Nesting Syntax in Random Effects — expand_nesting_syntax","text":"rhs Character string, RHS random effects formula","code":""},{"path":"https://because-pkg.github.io/because/reference/expand_nesting_syntax.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Expand Nesting Syntax in Random Effects — expand_nesting_syntax","text":"Expanded character string","code":""},{"path":"https://because-pkg.github.io/because/reference/expand_polynomial_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Expand Polynomial Terms in Formula — expand_polynomial_formula","title":"Expand Polynomial Terms in Formula — expand_polynomial_formula","text":"Replaces (var^power) internal variable names","code":""},{"path":"https://because-pkg.github.io/because/reference/expand_polynomial_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expand Polynomial Terms in Formula — expand_polynomial_formula","text":"","code":"expand_polynomial_formula(formula, poly_terms)"},{"path":"https://because-pkg.github.io/because/reference/expand_polynomial_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Expand Polynomial Terms in Formula — expand_polynomial_formula","text":"formula Formula object poly_terms List polynomial term info extract_polynomial_terms","code":""},{"path":"https://because-pkg.github.io/because/reference/expand_polynomial_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Expand Polynomial Terms in Formula — expand_polynomial_formula","text":"Modified formula internal names","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_bidirected_edges.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract bidirected edges (induced correlations) from MAG — extract_bidirected_edges","title":"Extract bidirected edges (induced correlations) from MAG — extract_bidirected_edges","text":"Extract bidirected edges (induced correlations) MAG","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_bidirected_edges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract bidirected edges (induced correlations) from MAG — extract_bidirected_edges","text":"","code":"extract_bidirected_edges(mag)"},{"path":"https://because-pkg.github.io/because/reference/extract_bidirected_edges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract bidirected edges (induced correlations) from MAG — extract_bidirected_edges","text":"mag MAG adjacency matrix DAG..MAG","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_bidirected_edges.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract bidirected edges (induced correlations) from MAG — extract_bidirected_edges","text":"List variable pairs induced correlations","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_deterministic_terms.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Deterministic Terms from Formulas — extract_deterministic_terms","title":"Extract Deterministic Terms from Formulas — extract_deterministic_terms","text":"Scans list formulas terms require deterministic nodes JAGS (interactions, () calls, etc.)","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_deterministic_terms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Deterministic Terms from Formulas — extract_deterministic_terms","text":"","code":"extract_deterministic_terms(equations)"},{"path":"https://because-pkg.github.io/because/reference/extract_deterministic_terms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Deterministic Terms from Formulas — extract_deterministic_terms","text":"equations List formulas","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_deterministic_terms.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Deterministic Terms from Formulas — extract_deterministic_terms","text":"List deterministic term definitions","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_imputed.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Imputed Values for Missing Data — extract_imputed","title":"Extract Imputed Values for Missing Data — extract_imputed","text":"Extracts posterior distributions missing values imputed model.","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_imputed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Imputed Values for Missing Data — extract_imputed","text":"","code":"extract_imputed(object, id_col = NULL)"},{"path":"https://because-pkg.github.io/because/reference/extract_imputed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Imputed Values for Missing Data — extract_imputed","text":"object model object. id_col Optional character vector IDs (e.g., species names) corresponding rows data. data model object already names (e.g., phylogenetic model), used automatically. provided, vector must length number observations model (N).","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_imputed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Imputed Values for Missing Data — extract_imputed","text":"data frame containing: Variable: Name variable missing data. ID: identifier (e.g., Species) observation (available). RowIndex: original row index data. Mean: Posterior mean imputed value. SD: Posterior standard deviation. Q2.5: 2.5% quantile (lower credible interval). Q50: Median. Q97.5: 97.5% quantile (upper credible interval).","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_imputed.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract Imputed Values for Missing Data — extract_imputed","text":"function identifies values original data missing (NA) looks corresponding imputed nodes posterior samples. Note: imputed values available monitored run. must use monitor = \"\" (include variable names monitor) running () ensure values saved.","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_imputed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Imputed Values for Missing Data — extract_imputed","text":"","code":"if (FALSE) { # \\dontrun{ # Assuming 'fit' is a because model run with missing data and monitor=\"all\" imputed_values <- extract_imputed(fit) head(imputed_values) } # }"},{"path":"https://because-pkg.github.io/because/reference/extract_latent.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Latent Parameters from a because Model — extract_latent","title":"Extract Latent Parameters from a because Model — extract_latent","text":"function extracts posterior distributions latent variables occupancy probability (psi), detection probability (p), latent occupancy state (z). designed handle multispecies models mapping stacked results back species sites.","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_latent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Latent Parameters from a because Model — extract_latent","text":"","code":"extract_latent(object, type = \"occupancy\", variables = NULL)"},{"path":"https://because-pkg.github.io/because/reference/extract_latent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Latent Parameters from a because Model — extract_latent","text":"object model object. type Character; type latent variable extract. Currently supports \"occupancy\". variables Optional character vector specifying latent variables extract (e.g., c(\"psi\", \"p\", \"z\")). NULL, extracts available given type.","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_latent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Latent Parameters from a because Model — extract_latent","text":"tidy data frame (tibble) containing: Variable: base name latent parameter (e.g., \"psi\"). Response: response variable name model (e.g., \"Y\"). SpeciesID: species identifier (multispecies models). SiteID: site identifier. Mean, SD, Q2.5, Q50, Q97.5: Posterior summary statistics.","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_latent.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract Latent Parameters from a because Model — extract_latent","text":"occupancy models, function looks parameters starting psi_, p_, z_. uses internal results$data results$species_order map indices back meaningful identifiers.","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_polynomial_terms.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Polynomial Terms from Formula — extract_polynomial_terms","title":"Extract Polynomial Terms from Formula — extract_polynomial_terms","text":"Detects (variable^power) patterns formula extracts transformation info","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_polynomial_terms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Polynomial Terms from Formula — extract_polynomial_terms","text":"","code":"extract_polynomial_terms(formula)"},{"path":"https://because-pkg.github.io/because/reference/extract_polynomial_terms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Polynomial Terms from Formula — extract_polynomial_terms","text":"formula Formula object","code":""},{"path":"https://because-pkg.github.io/because/reference/extract_polynomial_terms.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Polynomial Terms from Formula — extract_polynomial_terms","text":"List polynomial term information, NULL none found","code":""},{"path":"https://because-pkg.github.io/because/reference/family_definitions.html","id":null,"dir":"Reference","previous_headings":"","what":"Family Definition Generics and Default Methods — family_definitions","title":"Family Definition Generics and Default Methods — family_definitions","text":"S3 generics methods distribution families . enables custom distributions added defining S3 methods.","code":""},{"path":"https://because-pkg.github.io/because/reference/find_reusable_tests.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify Reusable D-Separation Tests — find_reusable_tests","title":"Identify Reusable D-Separation Tests — find_reusable_tests","text":"Scans list previously fitted '' models find d-separation tests already run can reused. Reusability requires strict data identity identical test formula + required support equations.","code":""},{"path":"https://because-pkg.github.io/because/reference/find_reusable_tests.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify Reusable D-Separation Tests — find_reusable_tests","text":"","code":"find_reusable_tests(   current_tests,   current_equations,   reuse_models,   current_data,   family = NULL,   quiet = FALSE )"},{"path":"https://because-pkg.github.io/because/reference/find_reusable_tests.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify Reusable D-Separation Tests — find_reusable_tests","text":"current_tests List formula objects representing d-separation tests run. current_equations List model formulas current model (support equations). reuse_models List '' model objects scan reusable results. current_data data object (list environment) used current run. family Named vector families (needed dependency resolution). quiet Logical; suppress messages (default = FALSE).","code":""},{"path":"https://because-pkg.github.io/because/reference/find_reusable_tests.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify Reusable D-Separation Tests — find_reusable_tests","text":"list two components: found: list d-separation result objects found previous models. missing_indices: numeric vector indices current_tests need run.","code":""},{"path":"https://because-pkg.github.io/because/reference/generate_deterministic_jags.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate JAGS Code for Deterministic Nodes — generate_deterministic_jags","title":"Generate JAGS Code for Deterministic Nodes — generate_deterministic_jags","text":"writers 'Internal_Vari <- ...' lines","code":""},{"path":"https://because-pkg.github.io/because/reference/generate_deterministic_jags.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate JAGS Code for Deterministic Nodes — generate_deterministic_jags","text":"","code":"generate_deterministic_jags(deterministic_terms)"},{"path":"https://because-pkg.github.io/because/reference/generate_deterministic_jags.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate JAGS Code for Deterministic Nodes — generate_deterministic_jags","text":"deterministic_terms List extract_deterministic_terms","code":""},{"path":"https://because-pkg.github.io/because/reference/generate_deterministic_jags.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate JAGS Code for Deterministic Nodes — generate_deterministic_jags","text":"Vector JAGS code strings","code":""},{"path":"https://because-pkg.github.io/because/reference/generate_polynomial_jags.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate JAGS Code for Polynomial Transformations — generate_polynomial_jags","title":"Generate JAGS Code for Polynomial Transformations — generate_polynomial_jags","text":"Creates deterministic nodes polynomial terms","code":""},{"path":"https://because-pkg.github.io/because/reference/generate_polynomial_jags.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate JAGS Code for Polynomial Transformations — generate_polynomial_jags","text":"","code":"generate_polynomial_jags(poly_terms)"},{"path":"https://because-pkg.github.io/because/reference/generate_polynomial_jags.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate JAGS Code for Polynomial Transformations — generate_polynomial_jags","text":"poly_terms List polynomial term info","code":""},{"path":"https://because-pkg.github.io/because/reference/generate_polynomial_jags.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate JAGS Code for Polynomial Transformations — generate_polynomial_jags","text":"Character vector JAGS code lines","code":""},{"path":"https://because-pkg.github.io/because/reference/get_all_polynomial_terms.html","id":null,"dir":"Reference","previous_headings":"","what":"Get All Polynomial Terms from Equations — get_all_polynomial_terms","title":"Get All Polynomial Terms from Equations — get_all_polynomial_terms","text":"Extracts unique polynomial terms across equations","code":""},{"path":"https://because-pkg.github.io/because/reference/get_all_polynomial_terms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get All Polynomial Terms from Equations — get_all_polynomial_terms","text":"","code":"get_all_polynomial_terms(equations)"},{"path":"https://because-pkg.github.io/because/reference/get_all_polynomial_terms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get All Polynomial Terms from Equations — get_all_polynomial_terms","text":"equations List formula objects","code":""},{"path":"https://because-pkg.github.io/because/reference/get_all_polynomial_terms.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get All Polynomial Terms from Equations — get_all_polynomial_terms","text":"List polynomial terms","code":""},{"path":"https://because-pkg.github.io/because/reference/get_data_for_variables.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Data for Variables — get_data_for_variables","title":"Get Data for Variables — get_data_for_variables","text":"Determine finest grain level needed set variables return appropriate dataset (joining needed)","code":""},{"path":"https://because-pkg.github.io/because/reference/get_data_for_variables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Data for Variables — get_data_for_variables","text":"","code":"get_data_for_variables(variables, data, levels, hierarchy, link_vars)"},{"path":"https://because-pkg.github.io/because/reference/get_data_for_variables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Data for Variables — get_data_for_variables","text":"variables Character vector variable names data List data.frames different levels levels List mapping variable names level names hierarchy Character string specifying nesting link_vars Character vector linking variables","code":""},{"path":"https://because-pkg.github.io/because/reference/get_data_for_variables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Data for Variables — get_data_for_variables","text":"data.frame","code":""},{"path":"https://because-pkg.github.io/because/reference/get_dsep_support_equations.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper to extract support equations (duplicates logic in run_single_dsep_test) — get_dsep_support_equations","title":"Helper to extract support equations (duplicates logic in run_single_dsep_test) — get_dsep_support_equations","text":"Helper extract support equations (duplicates logic run_single_dsep_test)","code":""},{"path":"https://because-pkg.github.io/because/reference/get_dsep_support_equations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper to extract support equations (duplicates logic in run_single_dsep_test) — get_dsep_support_equations","text":"","code":"get_dsep_support_equations(test_eq, all_equations, family)"},{"path":"https://because-pkg.github.io/because/reference/get_family.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a family object for a given distribution — get_family","title":"Create a family object for a given distribution — get_family","text":"Returns family object can dispatched via S3.","code":""},{"path":"https://because-pkg.github.io/because/reference/get_family.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a family object for a given distribution — get_family","text":"","code":"get_family(name)"},{"path":"https://because-pkg.github.io/because/reference/get_family.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a family object for a given distribution — get_family","text":"name Character string; family name (e.g., \"gaussian\", \"binomial\")","code":""},{"path":"https://because-pkg.github.io/because/reference/get_family.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a family object for a given distribution — get_family","text":"family object appropriate S3 class","code":""},{"path":"https://because-pkg.github.io/because/reference/get_family_object.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Family Object for S3 Dispatch — get_family_object","title":"Get Family Object for S3 Dispatch — get_family_object","text":"Converts family name string family class object S3 dispatch. gatekeeper ensures module packages installed allowing specialized families used.","code":""},{"path":"https://because-pkg.github.io/because/reference/get_family_object.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Family Object for S3 Dispatch — get_family_object","text":"","code":"get_family_object(family_name)"},{"path":"https://because-pkg.github.io/because/reference/get_family_object.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Family Object for S3 Dispatch — get_family_object","text":"family_name name family (e.g., \"occupancy\", \"gaussian\").","code":""},{"path":"https://because-pkg.github.io/because/reference/get_family_object.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Family Object for S3 Dispatch — get_family_object","text":"object class because_family_<name> because_family.","code":""},{"path":"https://because-pkg.github.io/because/reference/infer_variable_level.html","id":null,"dir":"Reference","previous_headings":"","what":"Infer Variable Level — infer_variable_level","title":"Infer Variable Level — infer_variable_level","text":"Determine hierarchical level variable belongs ","code":""},{"path":"https://because-pkg.github.io/because/reference/infer_variable_level.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Infer Variable Level — infer_variable_level","text":"","code":"infer_variable_level(var, levels)"},{"path":"https://because-pkg.github.io/because/reference/infer_variable_level.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Infer Variable Level — infer_variable_level","text":"var Character, variable name levels List mapping variable names level names","code":""},{"path":"https://because-pkg.github.io/because/reference/infer_variable_level.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Infer Variable Level — infer_variable_level","text":"Character, level name","code":""},{"path":"https://because-pkg.github.io/because/reference/jags_family_definition.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Default Method for Family Definition — jags_family_definition.default","title":"Default Method for Family Definition — jags_family_definition.default","text":"Default Method Family Definition","code":""},{"path":"https://because-pkg.github.io/because/reference/jags_family_definition.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default Method for Family Definition — jags_family_definition.default","text":"","code":"# Default S3 method jags_family_definition(family, response, predictors, ...)"},{"path":"https://because-pkg.github.io/because/reference/jags_family_definition.html","id":null,"dir":"Reference","previous_headings":"","what":"Define JAGS Family Implementation — jags_family_definition","title":"Define JAGS Family Implementation — jags_family_definition","text":"Modules implement method inject specific JAGS model code response families.","code":""},{"path":"https://because-pkg.github.io/because/reference/jags_family_definition.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define JAGS Family Implementation — jags_family_definition","text":"","code":"jags_family_definition(family, response, predictors, ...)"},{"path":"https://because-pkg.github.io/because/reference/jags_family_definition.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define JAGS Family Implementation — jags_family_definition","text":"family S3 family object (e.g., because_family_occupancy). response name response variable. predictors Character vector predictor names. ... Additional arguments.","code":""},{"path":"https://because-pkg.github.io/because/reference/jags_family_definition.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define JAGS Family Implementation — jags_family_definition","text":"list containing model_code (likelihood block) monitor_params.","code":""},{"path":"https://because-pkg.github.io/because/reference/jags_family_likelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate JAGS likelihood code for a distribution family — jags_family_likelihood","title":"Generate JAGS likelihood code for a distribution family — jags_family_likelihood","text":"generic allows S3 dispatch generate appropriate JAGS likelihood code distribution family.","code":""},{"path":"https://because-pkg.github.io/because/reference/jags_family_likelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate JAGS likelihood code for a distribution family — jags_family_likelihood","text":"","code":"jags_family_likelihood(   family,   response,   predictors = NULL,   suffix = \"\",   has_structure = FALSE,   link = \"identity\",   ... )"},{"path":"https://because-pkg.github.io/because/reference/jags_family_likelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate JAGS likelihood code for a distribution family — jags_family_likelihood","text":"family family object (created get_family_object custom constructor) response Character string; name response variable predictors Character vector; names predictor variables (may NULL) suffix Character string; suffix variable names (e.g., \"1\" multiple responses) has_structure Logical; whether model includes structure (e.g., phylogenetic) link Character string; link function (\"identity\", \"log\", \"logit\") ... Additional arguments passed methods","code":""},{"path":"https://because-pkg.github.io/because/reference/jags_family_likelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate JAGS likelihood code for a distribution family — jags_family_likelihood","text":"list : likelihood_code Character vector JAGS likelihood statements prior_code Character vector JAGS prior statements (NULL) data_requirements Character vector required data elements (NULL)","code":""},{"path":"https://because-pkg.github.io/because/reference/jags_structure_definition.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Default Method for Structure Definition (Independent Model) — jags_structure_definition.default","title":"Default Method for Structure Definition (Independent Model) — jags_structure_definition.default","text":"Default Method Structure Definition (Independent Model)","code":""},{"path":"https://because-pkg.github.io/because/reference/jags_structure_definition.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default Method for Structure Definition (Independent Model) — jags_structure_definition.default","text":"","code":"# Default S3 method jags_structure_definition(structure, variable_name = \"err\", ...)"},{"path":"https://because-pkg.github.io/because/reference/jags_structure_definition.html","id":null,"dir":"Reference","previous_headings":"","what":"Define JAGS Structure Implementation — jags_structure_definition","title":"Define JAGS Structure Implementation — jags_structure_definition","text":"Modules implement method inject specific JAGS code covariance structures.","code":""},{"path":"https://because-pkg.github.io/because/reference/jags_structure_definition.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define JAGS Structure Implementation — jags_structure_definition","text":"","code":"jags_structure_definition(structure, variable_name = \"err\", ...)"},{"path":"https://because-pkg.github.io/because/reference/jags_structure_definition.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define JAGS Structure Implementation — jags_structure_definition","text":"structure structure object (e.g., phylo, list, custom class). variable_name Name error variable (default \"err\"). ... Additional arguments.","code":""},{"path":"https://because-pkg.github.io/because/reference/jags_structure_definition.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define JAGS Structure Implementation — jags_structure_definition","text":"list containing setup_code (e.g. priors, matrix inversion) error_prior (likelihood/prior definition residuals).","code":""},{"path":"https://because-pkg.github.io/because/reference/mag_basis_to_formulas.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert MAG basis set to becauseR formula format — mag_basis_to_formulas","title":"Convert MAG basis set to becauseR formula format — mag_basis_to_formulas","text":"Convert MAG basis set becauseR formula format","code":""},{"path":"https://because-pkg.github.io/because/reference/mag_basis_to_formulas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert MAG basis set to becauseR formula format — mag_basis_to_formulas","text":"","code":"mag_basis_to_formulas(   basis_set,   latent_children = NULL,   categorical_vars = NULL,   family = NULL )"},{"path":"https://because-pkg.github.io/because/reference/mag_basis_to_formulas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert MAG basis set to becauseR formula format — mag_basis_to_formulas","text":"basis_set Basis set basiSet.mag() latent_children Optional character vector variables direct children latents","code":""},{"path":"https://because-pkg.github.io/because/reference/mag_basis_to_formulas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert MAG basis set to becauseR formula format — mag_basis_to_formulas","text":"List formulas test_var attribute","code":""},{"path":"https://because-pkg.github.io/because/reference/parse_hierarchy_from_random.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse Hierarchy from Random Effects — parse_hierarchy_from_random","title":"Parse Hierarchy from Random Effects — parse_hierarchy_from_random","text":"Extract hierarchical nesting structure random effects formula","code":""},{"path":"https://because-pkg.github.io/because/reference/parse_hierarchy_from_random.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse Hierarchy from Random Effects — parse_hierarchy_from_random","text":"","code":"parse_hierarchy_from_random(random, data = NULL)"},{"path":"https://because-pkg.github.io/because/reference/parse_hierarchy_from_random.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse Hierarchy from Random Effects — parse_hierarchy_from_random","text":"random Formula specifying random effects data List data.frames different hierarchical levels (optional, currently unused)","code":""},{"path":"https://because-pkg.github.io/because/reference/parse_hierarchy_from_random.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse Hierarchy from Random Effects — parse_hierarchy_from_random","text":"Character string hierarchy (e.g., \"site_year > individual\") NULL","code":""},{"path":"https://because-pkg.github.io/because/reference/plot_dag.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot DAG from Equations or Fitted Model — plot_dag","title":"Plot DAG from Equations or Fitted Model — plot_dag","text":"Visualizes Directed Acyclic Graph (DAG) implied set equations fitted model. fitted model provided: Path coefficients displayed edges. Edge colors determined edge_color_scheme argument (e.g., Red/Blue directional, Black/Grey binary). Structural edges (without fitted data) colored black. Edge thickness scales absolute effect size.","code":""},{"path":"https://because-pkg.github.io/because/reference/plot_dag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot DAG from Equations or Fitted Model — plot_dag","text":"","code":"plot_dag(   x,   layout = \"sugiyama\",   latent = NULL,   node_size = 14,   node_color = \"black\",   node_fill = \"white\",   node_stroke = 1.5,   text_size = 4,   edge_width_range = c(0.5, 2),   edge_color_scheme = c(\"directional\", \"binary\", \"monochrome\"),   show_coefficients = TRUE,   coords = NULL,   family = NULL )"},{"path":"https://because-pkg.github.io/because/reference/plot_dag.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot DAG from Equations or Fitted Model — plot_dag","text":"x list formulas (equations), model object, list . layout layout algorithm use (default \"sugiyama\"). See ggdag. latent Character vector latent variable names. Overrides model's latent variables provided. node_size Size nodes (default 14). node_color Color node border (default \"black\"). node_fill Color node interior (default \"white\"). node_stroke Thickness node border (default 1.5). text_size Size labels (default 4). edge_width_range Vector length 2 defining range arrow widths (min, max) based effect size. edge_color_scheme Character; one \"directional\" (default), \"binary\", \"monochrome\". \"directional\" colors edges red/blue/grey based effect direction whether 95\\ \"binary\" colors edges black/grey based whether 95\\ \"monochrome\" colors edges black. show_coefficients Logical; whether print coefficient values edges (fitted models). coords Optional named list coordinates nodes, e.g. list(= c(1, 1), B = c(2, 2)). provided, override layout algorithm.","code":""},{"path":"https://because-pkg.github.io/because/reference/plot_dag.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot DAG from Equations or Fitted Model — plot_dag","text":"ggplot object can customized standard ggplot2 functions (e.g., + theme_...(), + ggtitle(...)).","code":""},{"path":"https://because-pkg.github.io/because/reference/plot_dag.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot DAG from Equations or Fitted Model — plot_dag","text":"","code":"if (FALSE) { # \\dontrun{ # Basic plotting eq <- list(y ~ x + z, x ~ z) plot_dag(eq)  # Custom Layout my_coords <- list(   y = c(1, 1),   x = c(0, 0),   z = c(2, 0) ) plot_dag(eq, coords = my_coords) } # }"},{"path":"https://because-pkg.github.io/because/reference/plot_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Posterior Distributions for Model Comparison — plot_posterior","title":"Plot Posterior Distributions for Model Comparison — plot_posterior","text":"Visualizes posterior density distributions selected parameters, allowing easy comparison multiple models (e.g., Default vs. Custom priors) inspection single model.","code":""},{"path":"https://because-pkg.github.io/because/reference/plot_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Posterior Distributions for Model Comparison — plot_posterior","text":"","code":"plot_posterior(   models,   parameter,   col = NULL,   lwd = 2,   legend_pos = \"topleft\",   density_args = list(),   ... )"},{"path":"https://because-pkg.github.io/because/reference/plot_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Posterior Distributions for Model Comparison — plot_posterior","text":"models object named list objects. list provided, names used legend. Example: list(\"Default\" = fit1, \"Custom\" = fit2). parameter Character string. regular expression exact name parameter(s) plot. Example: \"beta\", \"^alpha\", \"beta_Y_X\". Plots matching parameters. col Optional vector colors. Defaults standard palette (black, blue, red, etc.). lwd Line width (default = 2). legend_pos Legend position (default = \"topleft\"). Set NULL suppress. density_args List additional arguments passed stats::density(). Useful handling boundary corrections (e.g., list(=0) truncated priors). ... Additional arguments passed plot().","code":""},{"path":"https://because-pkg.github.io/because/reference/plot_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Posterior Distributions for Model Comparison — plot_posterior","text":"Invisible NULL. Produces plot.","code":""},{"path":"https://because-pkg.github.io/because/reference/prepare_hierarchical_jags_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare Hierarchical Data for JAGS — prepare_hierarchical_jags_data","title":"Prepare Hierarchical Data for JAGS — prepare_hierarchical_jags_data","text":"Transforms hierarchical dataframes flat list vectors ID indices suitable JAGS","code":""},{"path":"https://because-pkg.github.io/because/reference/prepare_hierarchical_jags_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare Hierarchical Data for JAGS — prepare_hierarchical_jags_data","text":"","code":"prepare_hierarchical_jags_data(hierarchical_info, vars_needed)"},{"path":"https://because-pkg.github.io/because/reference/prepare_hierarchical_jags_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare Hierarchical Data for JAGS — prepare_hierarchical_jags_data","text":"hierarchical_info List containing 'data', 'levels', 'hierarchy', 'link_vars' vars_needed Character vector variable names needed model","code":""},{"path":"https://because-pkg.github.io/because/reference/prepare_hierarchical_jags_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare Hierarchical Data for JAGS — prepare_hierarchical_jags_data","text":"List 'data_list' (jags) 'n_vec' (named vector sample sizes)","code":""},{"path":"https://because-pkg.github.io/because/reference/prepare_structure_data.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Default Method for Structure Data Preparation — prepare_structure_data.default","title":"Default Method for Structure Data Preparation — prepare_structure_data.default","text":"Default Method Structure Data Preparation","code":""},{"path":"https://because-pkg.github.io/because/reference/prepare_structure_data.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default Method for Structure Data Preparation — prepare_structure_data.default","text":"","code":"# Default S3 method prepare_structure_data(structure, data, ...)"},{"path":"https://because-pkg.github.io/because/reference/prepare_structure_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare Structure Data — prepare_structure_data","title":"Prepare Structure Data — prepare_structure_data","text":"Modules implement process structure object data JAGS.","code":""},{"path":"https://because-pkg.github.io/because/reference/prepare_structure_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare Structure Data — prepare_structure_data","text":"","code":"prepare_structure_data(structure, data, ...)"},{"path":"https://because-pkg.github.io/because/reference/prepare_structure_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare Structure Data — prepare_structure_data","text":"structure structure object. data model data. ... Additional arguments.","code":""},{"path":"https://because-pkg.github.io/because/reference/prepare_structure_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare Structure Data — prepare_structure_data","text":"named list data passed JAGS (e.g., list(VCV = ...)).","code":""},{"path":"https://because-pkg.github.io/because/reference/preprocess_categorical_vars.html","id":null,"dir":"Reference","previous_headings":"","what":"Preprocess categorical variables (character/factor) to integer codes and dummies — preprocess_categorical_vars","title":"Preprocess categorical variables (character/factor) to integer codes and dummies — preprocess_categorical_vars","text":"Preprocess categorical variables (character/factor) integer codes dummies","code":""},{"path":"https://because-pkg.github.io/because/reference/preprocess_categorical_vars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Preprocess categorical variables (character/factor) to integer codes and dummies — preprocess_categorical_vars","text":"","code":"preprocess_categorical_vars(   data,   target_vars = NULL,   dummy_vars = NULL,   exclude_cols = NULL,   quiet = FALSE )"},{"path":"https://because-pkg.github.io/because/reference/preprocess_categorical_vars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Preprocess categorical variables (character/factor) to integer codes and dummies — preprocess_categorical_vars","text":"data data.frame list data.frames quiet Logical; whether suppress informational messages","code":""},{"path":"https://because-pkg.github.io/because/reference/preprocess_categorical_vars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Preprocess categorical variables (character/factor) to integer codes and dummies — preprocess_categorical_vars","text":"modified data object categorical_vars attribute","code":""},{"path":"https://because-pkg.github.io/because/reference/print.summary.because.html","id":null,"dir":"Reference","previous_headings":"","what":"Print Summary for Because Model — print.summary.because","title":"Print Summary for Because Model — print.summary.because","text":"Print Summary Model","code":""},{"path":"https://because-pkg.github.io/because/reference/print.summary.because.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print Summary for Because Model — print.summary.because","text":"","code":"# S3 method for class 'summary.because' print(x, ...)"},{"path":"https://because-pkg.github.io/because/reference/print.summary.because.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print Summary for Because Model — print.summary.because","text":"x summary object class \"summary.\". ... Additional arguments.","code":""},{"path":"https://because-pkg.github.io/because/reference/sanitize_term_name.html","id":null,"dir":"Reference","previous_headings":"","what":"Sanitize Term Name for JAGS — sanitize_term_name","title":"Sanitize Term Name for JAGS — sanitize_term_name","text":"Converts complex R terms valid JAGS variable names","code":""},{"path":"https://because-pkg.github.io/because/reference/sanitize_term_name.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sanitize Term Name for JAGS — sanitize_term_name","text":"","code":"sanitize_term_name(term)"},{"path":"https://because-pkg.github.io/because/reference/sanitize_term_name.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sanitize Term Name for JAGS — sanitize_term_name","text":"term Character string (e.g., \":B\", \"(^2)\")","code":""},{"path":"https://because-pkg.github.io/because/reference/sanitize_term_name.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sanitize Term Name for JAGS — sanitize_term_name","text":"Sanitized string (e.g., \"A_x_B\", \"A_pow2\")","code":""},{"path":"https://because-pkg.github.io/because/reference/storks.html","id":null,"dir":"Reference","previous_headings":"","what":"Data on Stork Populations and Human Birth Rates — storks","title":"Data on Stork Populations and Human Birth Rates — storks","text":"dataset containing information stork populations, human birth rates, area size 17 European countries, described Matthews (2000). dataset famously used demonstrate spurious correlations (d-separation).","code":""},{"path":"https://because-pkg.github.io/because/reference/storks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data on Stork Populations and Human Birth Rates — storks","text":"","code":"storks"},{"path":"https://because-pkg.github.io/because/reference/storks.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data on Stork Populations and Human Birth Rates — storks","text":"data frame 17 rows 5 variables: Country Name country Area Area country square kilometers Storks Number breeding stork pairs Humans Human population size (millions) Birth Human birth rate (1000s per year)","code":""},{"path":"https://because-pkg.github.io/because/reference/storks.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Data on Stork Populations and Human Birth Rates — storks","text":"Matthews, R. (2000). Storks deliver babies (p= 0.008). Teaching Statistics, 22(2), 36-38.","code":""},{"path":"https://because-pkg.github.io/because/reference/summary.because.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary for Because Model — summary.because","title":"Summary for Because Model — summary.because","text":"Summarizes output model run.","code":""},{"path":"https://because-pkg.github.io/because/reference/summary.because.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary for Because Model — summary.because","text":"","code":"# S3 method for class 'because' summary(   object,   show_internal = FALSE,   show_nodes = FALSE,   show_random = FALSE,   ... )"},{"path":"https://because-pkg.github.io/because/reference/summary.because.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary for Because Model — summary.because","text":"show_internal Logical. TRUE, shows internal parameters created deterministically defined nodes (e.g., beta_..._det_...). Defaults FALSE. show_nodes Logical. TRUE, shows latent node values (e.g., Age[1]). Defaults FALSE prevent clutter monitor=\"\". show_random Logical. TRUE, shows random effect estimates (e.g., u_...). Defaults FALSE. ... Additional arguments passed summary.mcmc.","code":""},{"path":"https://because-pkg.github.io/because/reference/summary.because.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary for Because Model — summary.because","text":"summary object containing statistics monitored parameters. dsep = TRUE used , summary focuses conditional independence tests.","code":""},{"path":"https://because-pkg.github.io/because/reference/term_to_jags_expression.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert R Term to JAGS Expression — term_to_jags_expression","title":"Convert R Term to JAGS Expression — term_to_jags_expression","text":"Transforms R syntax JAGS-compatible deterministic code","code":""},{"path":"https://because-pkg.github.io/because/reference/term_to_jags_expression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert R Term to JAGS Expression — term_to_jags_expression","text":"","code":"term_to_jags_expression(term)"},{"path":"https://because-pkg.github.io/because/reference/term_to_jags_expression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert R Term to JAGS Expression — term_to_jags_expression","text":"term Original R term (e.g., \":B\")","code":""},{"path":"https://because-pkg.github.io/because/reference/term_to_jags_expression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert R Term to JAGS Expression — term_to_jags_expression","text":"JAGS expression (e.g., \"Ai * Bi\")","code":""},{"path":"https://because-pkg.github.io/because/reference/transform_graph_for_dsep.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Default Method for D-Sep Transformation — transform_graph_for_dsep.default","title":"Default Method for D-Sep Transformation — transform_graph_for_dsep.default","text":"Default Method D-Sep Transformation","code":""},{"path":"https://because-pkg.github.io/because/reference/transform_graph_for_dsep.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default Method for D-Sep Transformation — transform_graph_for_dsep.default","text":"","code":"# Default S3 method transform_graph_for_dsep(family, equations, ...)"},{"path":"https://because-pkg.github.io/because/reference/transform_graph_for_dsep.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform Graph for D-Separation — transform_graph_for_dsep","title":"Transform Graph for D-Separation — transform_graph_for_dsep","text":"Modules implement rename variables causal graph match latent structure.","code":""},{"path":"https://because-pkg.github.io/because/reference/transform_graph_for_dsep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform Graph for D-Separation — transform_graph_for_dsep","text":"","code":"transform_graph_for_dsep(family, equations, ...)"},{"path":"https://because-pkg.github.io/because/reference/transform_graph_for_dsep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform Graph for D-Separation — transform_graph_for_dsep","text":"family S3 family object. equations list structural formulas. ... Additional arguments.","code":""},{"path":"https://because-pkg.github.io/because/reference/transform_graph_for_dsep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform Graph for D-Separation — transform_graph_for_dsep","text":"transformed list formulas.","code":""},{"path":"https://because-pkg.github.io/because/reference/validate_hierarchical_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate Hierarchical Data Structure — validate_hierarchical_data","title":"Validate Hierarchical Data Structure — validate_hierarchical_data","text":"Validate Hierarchical Data Structure","code":""},{"path":"https://because-pkg.github.io/because/reference/validate_hierarchical_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate Hierarchical Data Structure — validate_hierarchical_data","text":"","code":"validate_hierarchical_data(data, levels, hierarchy, link_vars)"},{"path":"https://because-pkg.github.io/because/reference/validate_hierarchical_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate Hierarchical Data Structure — validate_hierarchical_data","text":"data List data.frames different hierarchical levels levels List mapping variable names level names hierarchy Character string specifying nesting (e.g., \"site_year > individual\") link_vars Character vector variables link levels","code":""}]
