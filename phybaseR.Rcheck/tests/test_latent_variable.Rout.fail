
R version 4.5.2 (2025-10-31) -- "[Not] Part in a Rumble"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # Test script for Latent Variable implementation in phybaseR
> 
> library(phybaseR)
> library(ape)
> 
> # 1. Simulate data with a latent common cause
> # L -> X
> # L -> Y
> # This induces correlation between X and Y residuals
> 
> set.seed(123)
> N <- 50
> tree <- rtree(N)
> tree$edge.length <- tree$edge.length / max(branching.times(tree))
> 
> # Latent variable L (phylogenetically structured)
> L <- rTraitCont(tree, model = "BM", sigma = 1)
> 
> # X and Y depend on L plus independent error
> X <- 0.5 * L + rnorm(N, 0, 0.5)
> Y <- -0.5 * L + rnorm(N, 0, 0.5)
> 
> data <- list(
+     X = X,
+     Y = Y,
+     N = N
+ )
> 
> # 2. Define model with latent variable
> # We specify L in the equations but mark it as latent
> equations <- list(
+     X ~ L,
+     Y ~ L
+ )
> 
> # 3. Run phybase_run with latent argument
> # We expect:
> # - d-sep to identify induced correlation between X and Y
> # - JAGS model to include correlated residuals for X and Y
> 
> cat("Running phybase_run with latent variable...\n")
Running phybase_run with latent variable...
> fit <- phybase_run(
+     data = data,
+     tree = tree,
+     equations = equations,
+     latent = "L",
+     dsep = TRUE,
+     n.iter = 1000,
+     n.burnin = 500,
+     n.chains = 2,
+     quiet = FALSE
+ )
Note: WAIC and DIC are not computed for d-separation tests (not needed for conditional independence testing).
Generating m-separation tests (MAG with latent variables)...
the original DAG is: 
L -> X 
L -> Y 
latent variable(s):  L 
_____________________ 
Mixed Acyclic Graph involving only the observed variables: 
X <-> Y 
___________________________ 
X->Y means X that is a cause of Y given these observed variables 
although there could also be latent common causes between them as well. 
 
X<->Y means that X and Y are not causes of each other but are correlated 
via one or more marginal common latent causes. 
 
X--Y means that X and Y are not causes of each other but are  
correlated via one or more common latent effects that have been conditioned 
due to biased sampling. 
 
___________________________ 
___________________________ 
Basis Set for MAG: 
I(X,Y|Z) means X is m-separated from Y given the set Z in the MAG 
No elements in the basis set 
Basis Set for MAG: 
I(X,Y|Z) means X is m-separated from Y given the set Z in the MAG 
No elements in the basis set 
Found 1 induced correlation(s) from latent variable(s)
Error in phybase_run(data = data, tree = tree, equations = equations,  : 
  No d-separation tests implied by the model (model is saturated). Stopping run.
Execution halted
