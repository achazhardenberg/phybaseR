
R version 4.5.2 (2025-10-31) -- "[Not] Part in a Rumble"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(phybaseR)
> 
> data("rhino.dat")
> data("rhino.tree")
> 
> data_list <- list(
+     BM = rhino.dat$BM,
+     NL = rhino.dat$NL,
+     DD = rhino.dat$DD,
+     LS = rhino.dat$LS,
+     RS = rhino.dat$RS
+ )
> 
> equations_1 <- list(LS ~ BM, NL ~ BM, DD ~ NL, RS ~ DD)
> 
> # Test model saving
> cat("\n=== Testing Model Saving for d-sep ===\n")

=== Testing Model Saving for d-sep ===
> fit_rhino_dsep <- phybase_run(
+     data = data_list,
+     tree = rhino.tree,
+     equations = equations_1,
+     dsep = TRUE,
+     n.iter = 500,
+     n.burnin = 250
+ )
Standardizing tree (max_bt: 3.31 -> 1.0)
Note: WAIC and DIC are not computed for d-separation tests (not needed for conditional independence testing).
Generating d-separation tests...
Basis Set for DAG: 
I(X,Y|Z) means X is d-separated from Y given the set Z in the DAG 
I( LS , NL | BM ) 
I( LS , DD |  ) 
I( LS , RS |  ) 
I( NL , RS |  ) 
I( DD , BM |  ) 
I( RS , BM |  ) 
Running 6 d-separation tests sequentially...
  Test 1/6: LS ~ NL + BM
    Monitoring: beta_LS_NL, beta_LS_BM
  Test 2/6: LS ~ DD
    Monitoring: beta_LS_DD
  Test 3/6: LS ~ RS
    Monitoring: beta_LS_RS
  Test 4/6: NL ~ RS
    Monitoring: beta_NL_RS
  Test 5/6: DD ~ BM
    Monitoring: beta_DD_BM
  Test 6/6: RS ~ BM
    Monitoring: beta_RS_BM
There were 23 warnings (use warnings() to see them)
> 
> cat("\n\n=== Checking Models Field ===\n")


=== Checking Models Field ===
> cat("Number of models saved:", length(fit_rhino_dsep$models), "\n")
Number of models saved: 6 
> cat("Names of list elements:", names(fit_rhino_dsep), "\n\n")
Names of list elements: samples parameter_map models dsep dsep_tests induced_correlations 

> 
> cat("=== Model 1 (first 30 lines) ===\n")
=== Model 1 (first 30 lines) ===
> model_1_lines <- strsplit(fit_rhino_dsep$models[[1]], "\n")[[1]]
Error in strsplit(fit_rhino_dsep$models[[1]], "\n") : 
  non-character argument
Execution halted
