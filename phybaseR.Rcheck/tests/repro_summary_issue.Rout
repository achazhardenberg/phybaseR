
R version 4.5.2 (2025-10-31) -- "[Not] Part in a Rumble"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(phybaseR)
> library(ape)
> 
> # Simulate data
> set.seed(123)
> N <- 50
> tree <- rtree(N)
> data <- data.frame(
+     X = rnorm(N),
+     Y = rnorm(N)
+ )
> data$Y <- 0.5 * data$X + rnorm(N)
> 
> cat("=== TEST 1: 3 Chains (Should show Rhat and n.eff) ===\n")
=== TEST 1: 3 Chains (Should show Rhat and n.eff) ===
> fit3 <- phybase_run(
+     data = data,
+     tree = tree,
+     equations = list(Y ~ X),
+     n.chains = 3,
+     n.iter = 1000,
+     n.burnin = 500,
+     quiet = TRUE
+ )
Warning message:
In rjags::jags.model(model_file, data = data, n.chains = n.chains,  :
  Unused variable "ID2" in data
> print(summary(fit3))
           Mean    SD Naive SE Time-series SE   2.5%   50% 97.5%  Rhat n.eff
alphaY   -0.013 0.348    0.028          0.028 -0.682 0.002 0.673 1.006   150
beta_Y_X  0.341 0.189    0.015          0.015  0.007 0.328 0.693 0.992   150
lambdaY   0.315 0.143    0.012          0.012  0.107 0.290 0.670 0.993   150
sigmaY    1.298 0.139    0.011          0.011  1.065 1.284 1.581 0.995   152

DIC:
Mean deviance:  150 
penalty 12.91 
Penalized deviance: 162.9 
           Mean    SD Naive SE Time-series SE   2.5%   50% 97.5%  Rhat n.eff
alphaY   -0.013 0.348    0.028          0.028 -0.682 0.002 0.673 1.006   150
beta_Y_X  0.341 0.189    0.015          0.015  0.007 0.328 0.693 0.992   150
lambdaY   0.315 0.143    0.012          0.012  0.107 0.290 0.670 0.993   150
sigmaY    1.298 0.139    0.011          0.011  1.065 1.284 1.581 0.995   152
> 
> cat("\n=== TEST 2: 1 Chain (Should show n.eff, NO Rhat) ===\n")

=== TEST 2: 1 Chain (Should show n.eff, NO Rhat) ===
> fit1 <- phybase_run(
+     data = data,
+     tree = tree,
+     equations = list(Y ~ X),
+     n.chains = 1,
+     n.iter = 1000,
+     n.burnin = 500,
+     quiet = TRUE
+ )
Warning messages:
1: In rjags::jags.model(model_file, data = data, n.chains = n.chains,  :
  Unused variable "ID2" in data
2: In phybase_run(data = data, tree = tree, equations = list(Y ~ X),  :
  DIC and WAIC require at least 2 chains. Disabling calculation.
> print(summary(fit1))
          Mean    SD Naive SE Time-series SE   2.5%   50% 97.5% n.eff
alphaY   0.185 0.415    0.059          0.080 -0.287 0.106 1.365    27
beta_Y_X 0.369 0.185    0.026          0.026  0.023 0.385 0.677    50
lambdaY  0.324 0.146    0.021          0.022  0.117 0.296 0.644    45
sigmaY   1.340 0.133    0.019          0.028  1.148 1.322 1.662    23
          Mean    SD Naive SE Time-series SE   2.5%   50% 97.5% n.eff
alphaY   0.185 0.415    0.059          0.080 -0.287 0.106 1.365    27
beta_Y_X 0.369 0.185    0.026          0.026  0.023 0.385 0.677    50
lambdaY  0.324 0.146    0.021          0.022  0.117 0.296 0.644    45
sigmaY   1.340 0.133    0.019          0.028  1.148 1.322 1.662    23
> 
> proc.time()
   user  system elapsed 
  4.177   0.092   4.587 
