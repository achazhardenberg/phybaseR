
R version 4.5.2 (2025-10-31) -- "[Not] Part in a Rumble"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(phybaseR)
> 
> # Create simple test data
> set.seed(123)
> N <- 20
> df <- data.frame(
+     SP = paste0("sp", 1:N),
+     Y = rnorm(N, mean = 10, sd = 2),
+     X = rnorm(N)
+ )
> 
> # Run model and check if log_lik is in the JAGS model
> cat("Running simple Gaussian model...\n")
Running simple Gaussian model...
> fit <- phybase_run(
+     data = df,
+     id_col = "SP",
+     equations = list(Y ~ X),
+     n.chains = 1,
+     n.iter = 100,
+     quiet = FALSE
+ )
No structure/tree provided. Running standard (non-phylogenetic) SEM.
No tree provided. Running standard (non-phylogenetic) SEM.
Converted data.frame to list with 2 variables: Y, X
Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 20
   Unobserved stochastic nodes: 3
   Total graph size: 509

Initializing model

Warning messages:
1: In rjags::jags.model(model_file, data = data, n.chains = n.chains,  :
  Unused variable "ID2" in data
2: In phybase_run(data = df, id_col = "SP", equations = list(Y ~ X),  :
  DIC and WAIC require at least 2 chains. Disabling calculation.
> 
> # Check if model code contains log_lik
> cat("\n=== Checking JAGS Model for log_lik ===\n")

=== Checking JAGS Model for log_lik ===
> model_str <- fit$model_code
> 
> if (grepl("log_lik", model_str)) {
+     cat("✓ PASS: log_lik found in model\n")
+ 
+     # Extract log_lik lines
+     model_lines <- strsplit(model_str, "\n")[[1]]
+     log_lik_lines <- grep("log_lik", model_lines, value = TRUE)
+     cat("\nlog_lik statements:\n")
+     cat(paste(log_lik_lines, collapse = "\n"), "\n")
+ } else {
+     cat("✗ FAIL: log_lik NOT found in model\n")
+ }
✓ PASS: log_lik found in model

log_lik statements:
    log_lik_Y[i] <- logdensity.norm(Y[i], muY[i], tau_e_Y) 
> 
> # Check if log_lik would be in monitored parameters if we had enabled it
> cat("\n=== Summary ===\n")

=== Summary ===
> cat("Model compiled successfully!\n")
Model compiled successfully!
> cat("Next step: Add log_lik to monitored parameters in phybase_run()\n")
Next step: Add log_lik to monitored parameters in phybase_run()
> 
> proc.time()
   user  system elapsed 
  0.321   0.047   0.386 
