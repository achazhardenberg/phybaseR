
R version 4.5.2 (2025-10-31) -- "[Not] Part in a Rumble"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(phybaseR)
> library(ape)
> 
> # Create synthetic data
> set.seed(42)
> N <- 40
> tree <- rtree(N)
> df <- data.frame(
+     SP = tree$tip.label,
+     Y = rnorm(N, 10, 2),
+     X1 = rnorm(N),
+     X2 = rnorm(N)
+ )
> 
> cat("Running Model 1 (Simple)...\n")
Running Model 1 (Simple)...
> fit1 <- phybase_run(
+     data = df,
+     structure = tree,
+     id_col = "SP",
+     equations = list(Y ~ X1),
+     WAIC = TRUE,
+     quiet = TRUE
+ )
Warning message:
In rjags::jags.model(model_file, data = data, n.chains = n.chains,  :
  Unused variable "ID2" in data
> 
> cat("Running Model 2 (Complex)...\n")
Running Model 2 (Complex)...
> fit2 <- phybase_run(
+     data = df,
+     structure = tree,
+     id_col = "SP",
+     equations = list(Y ~ X1 + X2),
+     WAIC = TRUE,
+     quiet = TRUE
+ )
Warning message:
In rjags::jags.model(model_file, data = data, n.chains = n.chains,  :
  Unused variable "ID2" in data
> 
> cat("Running Model 3 (Null)...\n")
Running Model 3 (Null)...
> fit3 <- phybase_run(
+     data = df,
+     structure = tree,
+     id_col = "SP",
+     equations = list(Y ~ 1),
+     WAIC = TRUE,
+     quiet = TRUE
+ )
Warning message:
In rjags::jags.model(model_file, data = data, n.chains = n.chains,  :
  Unused variable "ID2" in data
> 
> cat("\n=== Testing phybase_compare (individual args) ===\n")

=== Testing phybase_compare (individual args) ===
> comp <- phybase_compare(fit1, fit2, fit3)
> print(comp)
Model Comparison (ordered by WAIC):
        WAIC  SE dWAIC dSE p_waic weight
Model_3  167 6.8   0.0 0.0    8.8   0.62
Model_1  169 7.1   1.8 1.3    9.3   0.25
Model_2  170 6.9   3.0 1.4    9.7   0.14

> 
> cat("\n=== Testing phybase_compare (named args) ===\n")

=== Testing phybase_compare (named args) ===
> comp_named <- phybase_compare(Simple = fit1, Complex = fit2, Null = fit3)
> print(comp_named)
Model Comparison (ordered by WAIC):
        WAIC  SE dWAIC dSE p_waic weight
Null     167 6.8   0.0 0.0    8.8   0.62
Simple   169 7.1   1.8 1.3    9.3   0.25
Complex  170 6.9   3.0 1.4    9.7   0.14

> 
> cat("\n=== Testing phybase_compare (list arg) ===\n")

=== Testing phybase_compare (list arg) ===
> comp_list <- phybase_compare(models = list(M1 = fit1, M2 = fit2, M3 = fit3))
> print(comp_list)
Model Comparison (ordered by WAIC):
   WAIC  SE dWAIC dSE p_waic weight
M3  167 6.8   0.0 0.0    8.8   0.62
M1  169 7.1   1.8 1.3    9.3   0.25
M2  170 6.9   3.0 1.4    9.7   0.14

> 
> cat("\n✓ SUCCESS!\n")

✓ SUCCESS!
> 
> proc.time()
   user  system elapsed 
 47.165   0.446  48.473 
