
R version 4.5.2 (2025-10-31) -- "[Not] Part in a Rumble"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # ==============================================================================
> # Test Script: JAGS Optimization (Simple Model)
> # ==============================================================================
> # Verifies that the optimized random effects formulation works correctly
> # for a simple regression model.
> # ==============================================================================
> 
> # library(phybaseR)
> library(ape)
> library(coda)
> library(rjags)
Linked to JAGS 4.3.2
Loaded modules: basemod,bugs
> 
> # Source local files
> 
> cat("\n=== Testing JAGS Optimization (Simple Model) ===\n\n")

=== Testing JAGS Optimization (Simple Model) ===

> 
> # 1. Simulate Data
> set.seed(123)
> N <- 50
> tree <- rtree(N)
> tree$edge.length <- tree$edge.length / max(branching.times(tree))
> VCV <- vcv.phylo(tree)
> 
> # True parameters
> beta <- 0.5
> lambda <- 0.7
> sigma <- 1.0
> tau <- 1 / sigma^2
> 
> # Simulate Y ~ N(beta*X, sigma^2 * (lambda*V + (1-lambda)*I))
> X <- rnorm(N)
> mu <- beta * X
> Sigma <- sigma^2 * (lambda * VCV + (1 - lambda) * diag(N))
> Y <- MASS::mvrnorm(1, mu, Sigma)
> 
> data <- list(Y = Y, X = X)
> equations <- list(Y ~ X)
> 
> # Debug: Print model code
> cat("Generating model code...\n")
Generating model code...
> model_out <- phybase_model(
+     equations = equations,
+     optimise = TRUE
+ )
Error in phybase_model(equations = equations, optimise = TRUE) : 
  could not find function "phybase_model"
Execution halted
