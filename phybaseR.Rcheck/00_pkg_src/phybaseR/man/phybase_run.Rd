% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phybase_run.R
\name{phybase_run}
\alias{phybase_run}
\title{Run a Phylogenetic Bayesian Structural Equation model (PhyBaSE)}
\usage{
phybase_run(
  data,
  tree,
  equations,
  monitor = NULL,
  n.chains = 3,
  n.iter = 2000,
  n.burnin = floor(n.iter/2),
  n.thin = max(1, floor((n.iter - n.burnin)/1000)),
  DIC = TRUE,
  WAIC = FALSE,
  n.adapt = 1000,
  quiet = FALSE,
  dsep = FALSE,
  variability = NULL,
  distribution = NULL,
  latent = NULL,
  latent_method = c("correlations", "explicit"),
  parallel = FALSE,
  n.cores = 1,
  cl = NULL,
  ic_recompile = TRUE
)
}
\arguments{
\item{data}{A named list of data for JAGS.}

\item{tree}{A single phylogenetic tree of class \code{"phylo"} or a list of trees of class \code{"multiPhylo"} (i.e., a list of \code{"phylo"} objects). If multiple trees are provided, phylogenetic uncertainty is incorporated by sampling among them during model fitting.}

\item{equations}{A list of model formulas describing the structural equation model.}

\item{monitor}{Optional character vector of parameter names to monitor. If \code{NULL}, parameters will be selected automatically based on model structure.}

\item{n.chains}{Number of MCMC chains (default = 3).}

\item{n.iter}{Total number of MCMC iterations (default = 2000).}

\item{n.burnin}{Number of burn-in iterations (default = n.iter / 2).}

\item{n.thin}{Thinning rate (default = max(1, floor((n.iter - n.burnin) / 1000))).}

\item{DIC}{Logical; whether to compute DIC using \code{dic.samples()} (default = TRUE).
**Note**: DIC penalty will be inflated for models with measurement error or repeated measures
because latent variables are counted as parameters (penalty â‰ˆ structural parameters + N).
For model comparison, use WAIC or compare mean deviance across models with similar structure.}

\item{WAIC}{Logical; whether to sample values for WAIC and deviance (default = FALSE).
WAIC is generally more appropriate than DIC for hierarchical models with latent variables.}

\item{n.adapt}{Number of adaptation iterations (default = 1000).}

\item{quiet}{Logical; suppress JAGS output (default = FALSE).}

\item{dsep}{Logical; if \code{TRUE}, monitor only the first beta in each structural equation (used for d-separation testing).}

\item{variability}{Optional specification for variables with measurement error or within-species variability.
  **AUTO-DETECTION**: If a variable \code{X} has a corresponding column \code{X_se} (standard errors),
  \code{X_obs} (repeated measures), or is provided as a matrix, variability is automatically detected.

  **Manual specification** (for non-standard column names):
  \itemize{
    \item Simple: \code{list(X = "se", Y = "reps")} - uses standard \code{X_se}/\code{Y_obs} naming
    \item Custom columns: \code{list(X = list(type = "se", se_col = "X_SD"))} - specify custom column names
    \item For SE: \code{se_col} (SE column), \code{mean_col} (mean column, optional)
    \item For reps: \code{obs_col} (observations matrix column)
  }}

\item{distribution}{Optional named character vector specifying the distribution for response variables.
Default is "gaussian" for all variables. Supported values: "gaussian", "binomial".
Example: \code{distribution = c(Gregarious = "binomial")}.}

\item{latent}{Optional character vector of latent (unmeasured) variable names.
If specified, the model will account for induced correlations among observed
variables that share these latent common causes.}

\item{latent_method}{Method for handling latent variables (default = "correlations").
\itemize{
  \item \code{"correlations"}: MAG approach - marginalize latent variables and estimate
        induced correlations (\code{rho}) between observed variables that share latent parents.
  \item \code{"explicit"}: Model latent variables as JAGS nodes and estimate structural
        paths from latents to observed variables.
}}

\item{parallel}{Logical; if \code{TRUE}, run MCMC chains in parallel (default = FALSE).
Note: Requires \code{n.cores > 1} to take effect.}

\item{n.cores}{Integer; number of CPU cores to use for parallel chains (default = 1).
Only used when \code{parallel = TRUE}.}

\item{cl}{Optional; a cluster object created by \code{parallel::makeCluster()}.
If \code{NULL}, a cluster will be created and destroyed automatically.}

\item{ic_recompile}{Logical; if \code{TRUE} and \code{parallel = TRUE}, recompile the model
after parallel chains to compute DIC/WAIC (default = TRUE).
This adds a small sequential overhead but enables information criteria calculation.}
}
\value{
A list of class \code{"phybase"} with model output and diagnostics.
}
\description{
Run a Phylogenetic Bayesian Structural Equation model (PhyBaSE)
}
