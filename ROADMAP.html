<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Future Development Roadmap • because</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" sizes="any" href="favicon.ico"><link rel="manifest" href="site.webmanifest"><script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Future Development Roadmap"><meta property="og:image" content="https://because-pkg.github.io/because/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">because</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/01_getting_started.html">Getting Started with because</a></li>
    <li><a class="dropdown-item" href="articles/02_dseparation.html">Causal inference with d-separation</a></li>
    <li><a class="dropdown-item" href="articles/03_custom_priors.html">Custom Priors and Mechanistic Constraints</a></li>
    <li><a class="dropdown-item" href="articles/04_mediation.html">Automated Mediation Analysis</a></li>
    <li><a class="dropdown-item" href="articles/modules.html">Extension Packages</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="articles/modules.html">Extensions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/because-pkg/because/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="logo.png" class="logo" alt=""><h1>Future Development Roadmap</h1>
      <small class="dont-index">Source: <a href="https://github.com/because-pkg/because/blob/master/ROADMAP.md" class="external-link"><code>ROADMAP.md</code></a></small>
    </div>


<div id="future-development-roadmap" class="section level1">

<p>This document outlines planned features and extensions for the <code>because</code> package.</p>
<div class="section level2">
<h2 id="id_1-custom-priors">1. Custom Priors<a class="anchor" aria-label="anchor" href="#id_1-custom-priors"></a></h2>
<ul><li>
<strong>Request</strong>: Users need the ability to override default informative/weakly-informative priors, <strong>crucial for mechanistic models</strong>.</li>
<li>
<strong>Implementation</strong>: Add a <code>priors</code> argument to <code><a href="reference/because.html">because()</a></code>.</li>
<li>
<strong>Mechanism</strong>:
<ul><li>Accept a named list: <code>list(alpha_Birth = "dnorm(0, 0.001)", sigma_Storks = "dunif(0, 10)")</code>.</li>
<li>During JAGS model generation, replace the default prior string for that specific parameter with the user-supplied string.</li>
</ul></li>
<li>
<strong>Validation</strong>: Check that the provided string is valid JAGS syntax (or catch errors from JAGS).</li>
</ul></div>
<div class="section level2">
<h2 id="id_2-occupancy-models-binomial-measurement-error">2. Occupancy Models (Binomial Measurement Error)<a class="anchor" aria-label="anchor" href="#id_2-occupancy-models-binomial-measurement-error"></a></h2>
<p><strong>Concept</strong>: Occupancy models are structurally identical to the Measurement Error (Latent Variable) framework already implemented in <code>because</code>. * <strong>State Process</strong>: True Presence <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>∼</mo><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">z_i \sim \text{Bernoulli}(\psi_i)</annotation></semantics></math> (Latent Variable) * <strong>Observation Process</strong>: Detection History <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y_{ij} \sim \text{Bernoulli}(z_i \cdot p_{ij})</annotation></semantics></math> (Measurement Error)</p>
<p><strong>Current Limitation</strong>: * The <code>variability</code> argument currently hardcodes a <strong>Gaussian</strong> observation process: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow></msub><mo>,</mo><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_{obs} \sim N(X_{true}, \sigma)</annotation></semantics></math>.</p>
<p><strong>Proposed Implementation</strong>: * Extend <code>variability</code> to accept a distribution type. * Example API: <code>variability = c(Sighting = list(type="binomial", trials="reps"))</code> * Update JAGS model generation to support <code>dbin</code> or <code>dbern</code> detection layers.</p>
<p><strong>Output</strong>: * The model would return estimates for: * <strong>Occupancy (</strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>): The probability a site is occupied (Latent State parameter). * <strong>Detection (</strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>): The probability of detecting the species if present (Observation Error parameter). * Both can be modeled as functions of covariates.</p>
<p><strong>Killer Feature: Causal Multi-Species Occupancy</strong> * Because <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math> (Occupancy) and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math> (Detection) are typically treated as nuisance parameters in other software, <code>because</code> can treat them as <strong>endogenous response variables</strong>. * <strong>Causal Links on Detection</strong>: Test behavioral hypotheses (e.g., <em>Predator Presence -&gt; Prey Detection Probability</em>). Prey hide when predators are around (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>↓</mo></mrow><annotation encoding="application/x-tex">p \downarrow</annotation></semantics></math>). * <strong>Causal Links on Occupancy</strong>: Test demographic hypotheses (e.g., <em>Predator Presence -&gt; Prey Occupancy</em>). Prey avoid predator-rich sites (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>↓</mo></mrow><annotation encoding="application/x-tex">z \downarrow</annotation></semantics></math>). * <strong>Confounding Control</strong>: Use latent variables (MAG approach) to control for unmeasured environmental confounders that affect both species, allowing robust D-separation tests on the latent occupancy states. * This effectively creates a <strong>Causal Occupancy Engine</strong>, moving beyond simple correlation. * <strong>Backend Strategy</strong>: Adopt the <strong>Rota et al. (2016)</strong> approach (Multivariate Bernoulli). Unlike Latent MVN (Pollock), this models interaction probabilities directly (Log-linear), allowing for covariate-dependent interactions (e.g., Competition varies with Temperature).</p>
</div>
<div class="section level2">
<h2 id="id_3-spatial-modeling-car-models">3. Spatial Modeling (CAR Models)<a class="anchor" aria-label="anchor" href="#id_3-spatial-modeling-car-models"></a></h2>
<ul class="task-list"><li><label><input type="checkbox"><strong>Native CAR Model Support</strong>: Implement <code>dcar_normal()</code> in JAGS models to support Conditional Autoregressive (CAR) spatial models natively. - Proper estimation of the spatial dependence parameter (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>). - Better alignment with standard ecological spatial modelling practices (e.g. <code>spdep</code>).</label></li>
</ul></div>
<div class="section level2">
<h2 id="id_4-non-gaussian-optimization">4. Non-Gaussian Optimization<a class="anchor" aria-label="anchor" href="#id_4-non-gaussian-optimization"></a></h2>
<ul><li>Extend the optimized linear algebra (matrix inversion) approach to Binomial and Poisson response models using PQL (Penalized Quasi-Likelihood) or similar approximations, or improved sampling schemes.</li>
</ul></div>
<div class="section level2">
<h2 id="id_5-phylogeography-spatial-phylogenetic-interactions">5. Phylogeography (Spatial-Phylogenetic Interactions)<a class="anchor" aria-label="anchor" href="#id_5-phylogeography-spatial-phylogenetic-interactions"></a></h2>
<ul><li>
<strong>Concept</strong>: Allow the strength of the phylogenetic signal to vary across space, or spatial autocorrelation to vary by clade.</li>
<li>
<strong>Implementation</strong>: A tensor product of the Phylogenetic and Spatial precision matrices (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mrow><mi>p</mi><mi>h</mi><mi>y</mi></mrow></msub><mo>⊗</mo><msub><mi>K</mi><mrow><mi>s</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{phy} \otimes K_{spatial}</annotation></semantics></math>).</li>
<li>
<strong>Application</strong>: Testing if evolutionary rates differ between regions (e.g., Tropics vs Temperate), effectively bridging Macroecology and Phylogeography.</li>
</ul></div>
<div class="section level2">
<h2 id="id_6-integrated-population-models-ipms">6. Integrated Population Models (IPMs)<a class="anchor" aria-label="anchor" href="#id_6-integrated-population-models-ipms"></a></h2>
<ul><li>
<strong>Concept</strong>: IPMs are the logical endpoint of this framework. They combine multiple observation datasets (Counts, Mark-Recapture, Productivity) to estimate shared latent population parameters.</li>
<li>
<strong>Architecture</strong>:
<ul><li>
<strong>Latent Process</strong>: Population dynamics (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>N</mi><mi>t</mi></msub><mo>⋅</mo><mi>S</mi><mo>+</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">N_{t+1} = N_t \cdot S + R</annotation></semantics></math>).</li>
<li>
<strong>Observation Models</strong>: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub><mo>∼</mo><mtext mathvariant="normal">Poisson</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">C_t \sim \text{Poisson}(N_t)</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y_{ij} \sim \text{Bernoulli}(S)</annotation></semantics></math>.</li>
</ul></li>
<li>
<strong>Potential</strong>: Since <code>because</code> already explicitly separates Latent States from Observations, extending it to support time-series dynamics (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>→</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t \to t+1</annotation></semantics></math>) would allow it to fit full IPMs.</li>
</ul><p><strong>Killer Feature: Causal Demographic Hypothesis Testing</strong> * Because demographic rates (Survival, Recruitment) and states (Population Size <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mi>t</mi></msub><annotation encoding="application/x-tex">N_t</annotation></semantics></math>) are latent variables, they can be used in causal tests. * Example: Test if <strong>Density Dependence</strong> is real (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>t</mi></msub><mo>→</mo><msub><mi>S</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">N_t \to S_t</annotation></semantics></math>) or if <strong>Climate</strong> drives population via Recruitment (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>l</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo>→</mo><msub><mi>R</mi><mi>t</mi></msub><mo>→</mo><msub><mi>N</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">Climate \to R_t \to N_{t+1}</annotation></semantics></math>). * This moves IPMs from “estimation tools” to “hypothesis testing engines”.</p>
</div>
<div class="section level2">
<h2 id="id_7-automatic-dag-visualization-complete">7. Automatic DAG Visualization (COMPLETE)<a class="anchor" aria-label="anchor" href="#id_7-automatic-dag-visualization-complete"></a></h2>
<ul><li>
<strong>Goal</strong>: Replace text summaries with publication-ready path diagrams.</li>
<li>
<strong>Implementation</strong>:
<ul><li>S3 method <code>plot(fit)</code>.</li>
<li>Uses <code>igraph</code> or <code>DiagrammeR</code> to draw the causal graph.</li>
<li>Edges colored by significance (Red/Blue); Width scaled by coefficient magnitude.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_8-zero-inflation-support-complete">8. Zero-Inflation Support (COMPLETE)<a class="anchor" aria-label="anchor" href="#id_8-zero-inflation-support-complete"></a></h2>
<ul><li>
<strong>Problem</strong>: Ecological count data often has excess zeros (true absence vs. undetected).</li>
<li>
<strong>Solution</strong>: Support <code>family = "zip"</code> (Zero-Inflated Poisson) and <code>zinb</code> (Zero-Inflated Negative Binomial).</li>
<li>
<strong>Mechanism</strong>: A mixture model with a binary “structural zero” process and a count process.</li>
</ul></div>
<div class="section level2">
<h2 id="id_9-alternative-backends-nimble--inla">9. Alternative Backends (NIMBLE &amp; INLA)<a class="anchor" aria-label="anchor" href="#id_9-alternative-backends-nimble--inla"></a></h2>
<ul><li>
<strong>Goal</strong>: Enable high-performance computing for massive datasets (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&gt;</mo><mn>10</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">N &gt; 10,000</annotation></semantics></math>) or complex mixtures.</li>
<li>
<strong>Strategy</strong>: <strong>Multi-Backend API</strong>.
<ul><li>Add a <code>backend</code> argument to <code>because(..., backend = "jags")</code>.</li>
<li>
<strong>“jags”</strong> (Default): Fast startup, no compiler needed. Best for prototyping and standard usage.</li>
<li>
<strong>“nimble”</strong>: Compiles to C++. User can customize samplers (e.g. HMC + Gibbs). <strong>Crucial for ODEs and complex mechanistic models</strong>.</li>
<li>
<strong>“inla”</strong>: Approximate Bayesian Inference.
<ul><li>
<strong>Use Case</strong>: Massive spatial/temporal datasets where MCMC is too slow.</li>
<li>
<strong>Role</strong>: The engine for <code>because_discover</code> (Structure Learning) and large-scale Spatiotemporal mapping.</li>
<li>
<strong>Trade-off</strong>: Extremely fast, but less flexible for very custom non-standard distributions.</li>
</ul></li>
</ul></li>
<li>
<strong>Implementation</strong>: Refactor <code>because.R</code> to adopt a plugin architecture for model execution.</li>
<li>
<strong>Note</strong>: Stan support is deferred indefinitely due to the need for a separate code generator.</li>
</ul></div>
<div class="section level2">
<h2 id="id_10-causal-biodiversity-modeling-hill-numbers">10. Causal Biodiversity Modeling (Hill Numbers)<a class="anchor" aria-label="anchor" href="#id_10-causal-biodiversity-modeling-hill-numbers"></a></h2>
<ul><li>
<strong>Concept</strong>: Instead of just estimating diversity, <em>test causes</em> of diversity patterns using Hill numbers (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>q</mi></msup><mi>D</mi></mrow><annotation encoding="application/x-tex">^{q}D</annotation></semantics></math>) as response variables.</li>
<li>
<strong>Integration</strong>:
<ul><li>
<strong>Response</strong>: Site-level diversity (Taxonomic, Phylogenetic, or Functional Hill numbers).</li>
<li>
<strong>Predictors</strong>: Environmental drivers (Temperature, Productivity).</li>
<li>
<strong>Controls</strong>: Spatial autocorrelation (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mrow><mi>s</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>a</mi><mi>l</mi></mrow></msub><annotation encoding="application/x-tex">u_{spatial}</annotation></semantics></math>) and Biogeographic history.</li>
</ul></li>
<li>
<strong>Causal Tests</strong>: Test if e.g., <em>Productivity -&gt; Functional Diversity -&gt; Ecosystem Stability</em>.</li>
<li>
<strong>Innovation</strong>: Most diversity studies are correlative. <code>because</code> allows formally testing causal pathways to biodiversity while accounting for spatial-phylogenetic non-independence.</li>
</ul></div>
<div class="section level2">
<h2 id="id_11-causal-utilities-interventions--robustness">11. Causal Utilities (Interventions &amp; Robustness)<a class="anchor" aria-label="anchor" href="#id_11-causal-utilities-interventions--robustness"></a></h2>
<ul><li>
<strong><code>because_do(fit, ...)</code></strong>: Counterfactual Simulation.
<ul><li>
<strong>Concept</strong>: Implements Pearl’s <strong>do-operator</strong> (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">do</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{do}(X=x)</annotation></semantics></math>) for structural interventions.</li>
<li>
<strong>Mechanism</strong>:
<ol style="list-style-type: decimal"><li>
<strong>Surgery</strong>: Removes incoming edges to the intervened variable in the DAG.</li>
<li>
<strong>Propagation</strong>: Propagates the fixed value <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> to all downstream descendants (children) using the fitted structural equations.</li>
<li>
<strong>Bayesian</strong>: Returns the full posterior distribution of the counterfactual outcome.</li>
</ol></li>
<li>
<strong>Application</strong>: “What would the population size be if we had reduced poaching by 50%?” (as opposed to just comparing areas with low vs high poaching).</li>
</ul></li>
<li>
<strong><code>because_sensitivity(fit)</code></strong>: Unmeasured Confounding Analysis.
<ul><li>
<strong>Goal</strong>: Assess robustness. “How strong would an unmeasured confounder have to be to explain away this result?” (similar to E-values).</li>
<li>
<strong>Implementation</strong>: Post-hoc analysis of the residuals.</li>
</ul></li>
</ul><hr></div>
</div>
<div class="section level1">
<h1 id="jags-optimization-implementation-progress">JAGS Optimization Implementation Progress<a class="anchor" aria-label="anchor" href="#jags-optimization-implementation-progress"></a></h1>
<p><em>(Archived from previous technical roadmap)</em></p>
<div class="section level2">
<h2 id="completed-2025-12-03">Completed (2025-12-03)<a class="anchor" aria-label="anchor" href="#completed-2025-12-03"></a></h2>
<ul><li>✅ <strong>Benchmarking</strong>: Confirmed random effects formulation is ~4.6x - 15.5x faster.</li>
<li>✅ <strong>Code Generation</strong>: Implemented additive random effects (<code>u_phylo + u_spatial</code>).</li>
<li>✅ <strong>Variance Partitioning</strong>: Now estimates separate <code>sigma</code> components instead of aggregate lambda.</li>
<li>✅ <strong>Multiple Covariance</strong>: Validated with <code>tests/test_multiple_covariance.R</code>.</li>
<li>✅ <strong>Non-Gaussian Families</strong>: Validated support for <code>binomial</code>, <code>poisson</code>, <code>negbinomial</code>, <code>zip</code>, <code>zinb</code> with full multi-tree phylogenetic signal.</li>
</ul></div>
<div class="section level2">
<h2 id="id_12-deterministic-nodes-formula-interface-complete">12. Deterministic Nodes (Formula interface) (COMPLETE)<a class="anchor" aria-label="anchor" href="#id_12-deterministic-nodes-formula-interface-complete"></a></h2>
<ul><li>
<strong>Status</strong>: <strong>Implemented</strong>.</li>
<li>
<strong>Feature</strong>: <code>R/deterministic_nodes.R</code> automatically parses formulas with interactions (<code>:</code>), logic, and functions (e.g., <code>I(x^2)</code>).</li>
<li>
<strong>Mechanism</strong>: Converts them into internal deterministic nodes (<code>det_...[i] &lt;- ...</code>) in JAGS, ensuring correct propagation of interventions.</li>
<li>
<strong>Benefit</strong>: Allows “Mechanism-First” modeling (e.g. <code>growth ~ Vmax * Light / (Km + Light)</code>) without manual data pre-processing.</li>
</ul></div>
<div class="section level2">
<h2 id="id_13-state-space-models-time-series">13. State Space Models (Time Series)<a class="anchor" aria-label="anchor" href="#id_13-state-space-models-time-series"></a></h2>
<ul><li>
<strong>Concept</strong>: With the addition of <strong>Deterministic Nodes</strong> (Item 12) and <strong>Latent Variables</strong> (Item 1), <code>because</code> is structurally capable of fitting State Space Models (SSM).</li>
<li>
<strong>Missing Piece</strong>: <strong>Time Indexing</strong> (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t, t-1</annotation></semantics></math>).</li>
<li>
<strong>Proposed Implementation</strong>:
<ul><li>Support autoregressive notation in formulas: <code>N ~ N[t-1] * S + R</code>.</li>
<li>Internally map this to a JAGS loop: <code>N[i] &lt;- N[i-1] * ...</code>.</li>
<li>Combine with <code>variability</code> (measurement error) to handle the “Partially Observed” component.</li>
<li>Combine with <code>variability</code> (measurement error) to handle the “Partially Observed” component.</li>
<li>
<strong>Result</strong>: A general-purpose Bayesian SSM engine that can <em>also</em> handle phylogeny and spatial autocorrelation (e.g., Spatiotemporal SSMs). “Process-based” causal inference.</li>
<li>
<strong>Strategic Note</strong>: This is the <strong>primary mechanistic engine</strong> for <code>because</code>, as most ecological data is discrete (year-to-year), making this far more widely useful than continuous ODEs.</li>
<li>
<strong>Temporal D-Separation</strong>:
<ul><li>DAGs are “unrolled” over time (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mo>→</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">t-1 \to t</annotation></semantics></math>).</li>
<li>Independence tests check for <strong>lagged effects</strong> (e.g., does <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">X_{t-1}</annotation></semantics></math> predict <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>t</mi></msub><annotation encoding="application/x-tex">Y_t</annotation></semantics></math> given <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>t</mi></msub><annotation encoding="application/x-tex">X_t</annotation></semantics></math>?).</li>
<li>This allows testing Granger Causality-like hypotheses within the Bayesian structural framework.</li>
</ul></li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_14-structure-learning-discovery-engine">14. Structure Learning (Discovery Engine)<a class="anchor" aria-label="anchor" href="#id_14-structure-learning-discovery-engine"></a></h2>
<ul><li>
<strong>Problem</strong>: Users often have many variables and unknown structure.</li>
<li>
<strong>Solution</strong>: <strong><code>because_discover(data)</code></strong>
</li>
<li>
<strong>Mechanism</strong>: A “Phylogenetic PC Algorithm”.
<ul><li>Starts with a fully connected graph.</li>
<li>Iteratively removes edges based on conditional independence tests (D-separation).</li>
<li>
<strong>Innovation</strong>: Uses the <code>because</code> backend to perform these tests <em>while accounting for phylogeny and spatial structure</em>, avoiding the biases of standard structure learning algorithms.</li>
</ul></li>
<li>
<strong>Hybrid Discovery-Confirmation Workflow</strong>:
<ol style="list-style-type: decimal"><li>
<strong>Exploratory Phase</strong>: Use a fast backend (INLA/Horseshoe JAGS) to “learn” the structure of environmental variables where theory is weak.</li>
<li>
<strong>Theoretical Phase</strong>: Integrate the learned environmental DAG as a fixed subgraph into a more complex biological model (e.g., Occupancy) where user provides strong prior theoretical knowledge.</li>
<li>
<strong>Refinement</strong>: Use d-separation tests on the combined model to identify remaining structural misfits.</li>
</ol></li>
</ul></div>
<div class="section level2">
<h2 id="id_15-automated-mediation-analysis-complete">15. Automated Mediation Analysis (COMPLETE)<a class="anchor" aria-label="anchor" href="#id_15-automated-mediation-analysis-complete"></a></h2>
<ul><li>
<strong>Goal</strong>: Decompose effects into “Direct” and “Indirect” pathways.</li>
<li>
<strong>Solution</strong>: <strong><code>because_mediation(fit, exposure, outcome)</code></strong>
</li>
<li>
<strong>Mechanism</strong>:
<ul><li>Automatically traces all paths from <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math> to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> in the fitted DAG using <code>igraph</code>.</li>
<li>Calculates Indirect Effects (e.g., <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>M</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to M \to Y</annotation></semantics></math>) by multiplying coefficients (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mrow><mi>X</mi><mi>M</mi></mrow></msub><mo>⋅</mo><msub><mi>β</mi><mrow><mi>M</mi><mi>Y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\beta_{XM} \cdot \beta_{MY}</annotation></semantics></math>) chain-by-chain.</li>
<li>Calculates Total Effects (Sum of all paths).</li>
<li>Answers: <em>“How much of the effect is mediated by M?”</em> with full Bayesian uncertainty intervals.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_16-the-front-door-criterion">16. The Front-Door Criterion<a class="anchor" aria-label="anchor" href="#id_16-the-front-door-criterion"></a></h2>
<ul><li>
<strong>Problem</strong>: Unmeasured confounding between <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> where back-door adjustment is impossible.</li>
<li>
<strong>Solution</strong>: Detect and exploit “Front-Door” structures (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>M</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to M \to Y</annotation></semantics></math>, with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math> isolated from confounders).</li>
<li>
<strong>Mechanism</strong>: A topological check effectively allowing causal identification even when standard controls are missing.</li>
</ul></div>
<div class="section level2">
<h2 id="id_17-transportability-external-validity">17. Transportability (External Validity)<a class="anchor" aria-label="anchor" href="#id_17-transportability-external-validity"></a></h2>
<ul><li>
<strong>Problem</strong>: Can a model learned in one region (e.g., Europe) predict in another (e.g., Amazon)?</li>
<li>
<strong>Solution</strong>: <strong><code>because_transport(fit, new_context)</code></strong>
</li>
<li>
<strong>Mechanism</strong>: Uses <strong>Pearl’s Selection Diagrams</strong>. Users flag which structural equations differ in the new environment (Selection Nodes <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>). The tool computes whether the causal effect can be validly transported or needs recalibration.</li>
</ul></div>
<div class="section level2">
<h2 id="id_18-data-fusion-grand-dags">18. Data Fusion (Grand DAGs)<a class="anchor" aria-label="anchor" href="#id_18-data-fusion-grand-dags"></a></h2>
<ul><li>
<strong>Problem</strong>: Disparate datasets (e.g., Dataset A has <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{X, Y\}</annotation></semantics></math>, Dataset B has <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>Y</mi><mo>,</mo><mi>Z</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{Y, Z\}</annotation></semantics></math>).</li>
<li>
<strong>Solution</strong>: <strong><code>because_merge(list(data1, data2))</code></strong>
</li>
<li>
<strong>Mechanism</strong>: Because <code>because</code> treats missing data as latent parameters, it can combine datasets into a single “Grand DAG”, imputing the missing variables for each dataset based on the shared structure.</li>
</ul></div>
<div class="section level2">
<h2 id="id_19-differential-equations-ode-solver-interface">19. Differential Equations (ODE Solver Interface)<a class="anchor" aria-label="anchor" href="#id_19-differential-equations-ode-solver-interface"></a></h2>
<ul><li>
<strong>Concept</strong>: The “Gold Standard” of mechanistic modeling in ecology (e.g., Lotka-Volterra, SIR models).</li>
<li>
<strong>Problem</strong>: Currently, <code>because</code> assumes discrete-time updates or static relationships. Many ecological theories are defined in continuous time (<code>dN/dt</code>).</li>
<li>
<strong>Solution</strong>: Investigate JAGS extensions (like passing C++ modules) or consider alternative backends (Stan/NIMBLE) for this specific feature, as native JAGS lacks a built-in <code>ode()</code> solver.</li>
<li>
<strong>Workaround</strong>: Use discrete approximation (Euler method) within JAGS loops for now.</li>
<li>
<strong>Priority</strong>: <strong>Low/Niche</strong>. As noted by user, most ecological data is discrete (e.g. annual), so Item 13 (SSMs) covers 90% of use cases. This remains a long-term goal for specific sub-fields (e.g., epidemiology).</li>
</ul></div>
<div class="section level2">
<h2 id="id_20-bayesian-model-averaging-bma--variable-selection-experimental">20. Bayesian Model Averaging (BMA) &amp; Variable Selection (Experimental)<a class="anchor" aria-label="anchor" href="#id_20-bayesian-model-averaging-bma--variable-selection-experimental"></a></h2>
<ul><li>
<strong>Status</strong>: <strong>Prototype Implemented</strong> (See <code>drafts/demo_bma_rhino.R</code>).</li>
<li>
<strong>Concept</strong>: Use <strong>Gibbs Variable Selection</strong> (Indicator Variables) to calculate Posterior Inclusion Probabilities (PIPs) for edges, effectively performing Bayesian D-separation tests.</li>
<li>
<strong>Mechanism</strong>:
<ul><li>User specifies a “Supermodel”.</li>
<li>
<code>because</code> automatically injects <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>∼</mo><mi>d</mi><mi>b</mi><mi>e</mi><mi>r</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">z \sim dbern(0.5)</annotation></semantics></math> for optional paths.</li>
<li>Returns PIPs for structural validation.</li>
</ul></li>
<li>
<strong>Plan</strong>: Move prototype logic into <code><a href="reference/because.html">because()</a></code> to allow <code>bma=TRUE</code>.</li>
</ul></div>
<div class="section level2">
<h2 id="id_21-tidyverse-dsl-the-tidysem-wrapper">21. Tidyverse DSL (The “TidySEM” Wrapper)<a class="anchor" aria-label="anchor" href="#id_21-tidyverse-dsl-the-tidysem-wrapper"></a></h2>
<ul><li>
<strong>Concept</strong>: An optional, pipe-based interface inspired by <code>TidySEM</code> but powered by <code>because</code>.</li>
<li>
<strong>Goal</strong>: “Steal the Syntax, Keep the Backend”. Provide the grammar users love without the frequentist limitations.</li>
<li>
<strong>Core Principle</strong>: The traditional <code><a href="reference/because.html">because()</a></code> function remains the stable engine. This DSL is a lightweight wrapper.</li>
<li>
<strong>Proposed Syntax</strong> (Matching TidySEM): <code>r     model &lt;- tidy_because(data) |&gt;       add_paths(Risk ~ Population + Climate) |&gt;       set_family(Risk = "binomial") |&gt;  # 'because' specific extension       estimate_jags()</code>
</li>
<li>
<strong>Key Features</strong>:
<ul><li>
<strong><code>add_paths()</code></strong>: Incrementally build equations.</li>
<li>
<strong><code>set_family()</code></strong>: Explicitly handle families (Bernoulli, Poisson, etc).</li>
<li>
<strong><code>set_variability()</code></strong>: Explicitly handle measurement error.</li>
<li>
<strong>Base Pipe (<code>|&gt;</code>)</strong>: Uses the native R pipe (requires R &gt;= 4.1.0) to avoid <code>magrittr</code> dependency.</li>
<li>
<strong><code>broom</code> Compatibility</strong>: <code>tidy(fit)</code> and <code>glance(fit)</code> for seamless plotting.</li>
</ul></li>
<li>
<strong>Priority</strong>: <strong>Medium</strong> (Excellent for complex ecological datasets with many species).</li>
</ul></div>
<div class="section level2">
<h2 id="id_22-sequentially-linked-models-modular-bayesian-inference">22. Sequentially Linked Models (Modular Bayesian Inference)<a class="anchor" aria-label="anchor" href="#id_22-sequentially-linked-models-modular-bayesian-inference"></a></h2>
<ul><li>
<strong>Concept</strong>: Enable “Cut Feedback” inference by linking separate models sequentially (Model A <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\to</annotation></semantics></math> Model B) instead of fitting one giant joint model.</li>
<li>
<strong>Use Case</strong>: Cross-scale linking (e.g., Species Occupancy <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\to</annotation></semantics></math> Trait Evolution) where feedback from B to A is undesirable or computationally prohibitive.</li>
<li>
<strong>Mechanism</strong>:
<ol style="list-style-type: decimal"><li>
<strong>Extract Samples</strong>: <code>extract_latent(modelA, format="samples", n_samples=1000)</code> returns a matrix of posterior draws for the latent variable.</li>
<li>
<strong>Empirical Posterior Propagation</strong>: Pass this matrix to Model B using <code>variability = "samples"</code>.</li>
<li>
<strong>JAGS Implementation</strong>: Model B uses <code>dcat</code> to sample from the provided empirical distribution for each observation <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub><mo>∼</mo><mtext mathvariant="normal">Categorical</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><msub><mi>N</mi><mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k_i \sim \text{Categorical}(1/N_{samples})</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><msub><mi>X</mi><mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>s</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo>,</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">X_i = X_{samples}[i, k_i]</annotation></semantics></math></li>
</ol></li>
<li>
<strong>Benefit</strong>: Propagates full non-Gaussian uncertainty (e.g., bimodality) without making parametric assumptions (like Mean/SE). Correctly handles “data with error” in a fully Bayesian framework.</li>
<li>
<strong>Causal Inference</strong>: Standard d-separation tests remain valid <strong>within</strong> each model step. The input from Model A is treated as an exogenous parent node in Model B’s graph, allowing for conditional independence tests involving this latent variable.</li>
</ul><hr></div>
</div>
<div class="section level1">
<h1 id="appendix-technical-implementation-strategies">Appendix: Technical Implementation Strategies<a class="anchor" aria-label="anchor" href="#appendix-technical-implementation-strategies"></a></h1>
<div class="section level2">
<h2 id="a-strategy-for-structure-learning-with-missing-data">A. Strategy for Structure Learning with Missing Data<a class="anchor" aria-label="anchor" href="#a-strategy-for-structure-learning-with-missing-data"></a></h2>
<p>The “Purist” approach (treating missing data as parameters in structure learning) is computationally infeasible. We will adopt a <strong>“Pragmatic Hybrid” (Scout &amp; Surveyor)</strong> approach:</p>
<ol style="list-style-type: decimal"><li>
<strong>Pre-Imputation (The Scout)</strong>:
<ul><li>Use fast tools (e.g., <code>Rphylopars</code>, <code>mice</code>) to generate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math> (e.g., 5) completed datasets <em>before</em> starting discovery.</li>
<li>This bypasses the missing-predictor limitation of fast engines like INLA.</li>
</ul></li>
<li>
<strong>Parallel Discovery</strong>:
<ul><li>Run <code>because_discover(backend="inla")</code> on each of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math> imputed datasets.</li>
<li>This exploits INLA’s speed (seconds vs hours) to search the massive graph space.</li>
</ul></li>
<li>
<strong>Consensus Pooling</strong>:
<ul><li>Identify edges that appear in the majority of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math> graphs (robustness check).</li>
<li>This yields the <strong>Candidate Graph</strong>.</li>
</ul></li>
<li>
<strong>Full Estimation (The Surveyor)</strong>:
<ul><li>Pass the Candidate Graph to <code>because(backend="jags")</code>.</li>
<li>JAGS treats the original missing data as parameters (discarding the pre-imputation) to properly estimate uncertainty and parameters in the final model.</li>
</ul></li>
</ol></div>
<div class="section level2">
<h2 id="b-the-inla-vs-jags-role">B. The INLA vs. JAGS Role<a class="anchor" aria-label="anchor" href="#b-the-inla-vs-jags-role"></a></h2>
<ul><li>
<strong>INLA (The Gaussian Machine)</strong>:
<ul><li>
<strong>Role</strong>: <em>Structure Learning, Spatial Mapping</em>.</li>
<li>
<strong>Constraint</strong>: Cannot handle non-linear logic (polynomials of latent vars) or complex missing data in predictors naturally.</li>
<li>
<strong>Advantage</strong>: Speed (1000x faster).</li>
</ul></li>
<li>
<strong>NIMBLE (The Custom Workshop)</strong>:
<ul><li>
<strong>Role</strong>: <em>ODEs, Complex Mechanistic Logic, Custom Samplers</em>.</li>
<li>
<strong>Advantage</strong>: Compiles to C++, allowing for differential equation solvers and arbitrary non-linear functions that are too slow or impossible in JAGS.</li>
<li>
<strong>Strategic Value</strong>: The bridge to full “Process-Based” modeling.</li>
</ul></li>
<li>
<strong>JAGS (The General Engine)</strong>:
<ul><li>
<strong>Role</strong>: <em>Final Estimation, <code>because_do</code> (Interventions), Complex Logic</em>.</li>
<li>
<strong>Advantage</strong>: Handles everything (interaction of latent vars, mechanism-based equations).</li>
<li>
<strong>Constraint</strong>: Slow.</li>
</ul></li>
</ul></div>
</div>


  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Achaz von Hardenberg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

