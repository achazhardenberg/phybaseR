<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extract d-separation statements from a structural equation model — because_dsep • because</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract d-separation statements from a structural equation model — because_dsep"><meta name="description" content="This function takes a set of structural equations defining a causal model
and returns the conditional independence statements (d-separation or m-separation tests)
implied by the model structure. If latent variables are specified, the function
uses the MAG (Mixed Acyclic Graph) approach by Shipley and Douma (2021)
to account for unmeasured latent variables."><meta property="og:description" content="This function takes a set of structural equations defining a causal model
and returns the conditional independence statements (d-separation or m-separation tests)
implied by the model structure. If latent variables are specified, the function
uses the MAG (Mixed Acyclic Graph) approach by Shipley and Douma (2021)
to account for unmeasured latent variables."><meta property="og:image" content="https://because-pkg.github.io/because/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">because</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/01_getting_started.html">Getting Started with because</a></li>
    <li><a class="dropdown-item" href="../articles/02_dseparation.html">Causal inference with d-separation</a></li>
    <li><a class="dropdown-item" href="../articles/03_phylogenetic_models.html">Phylogenetic Models</a></li>
    <li><a class="dropdown-item" href="../articles/04_missing_data.html">Missing Data Imputation in because</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/because-pkg/because/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extract d-separation statements from a structural equation model</h1>
      <small class="dont-index">Source: <a href="https://github.com/because-pkg/because/blob/master/R/because_dsep.R" class="external-link"><code>R/because_dsep.R</code></a></small>
      <div class="d-none name"><code>because_dsep.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes a set of structural equations defining a causal model
and returns the conditional independence statements (d-separation or m-separation tests)
implied by the model structure. If latent variables are specified, the function
uses the MAG (Mixed Acyclic Graph) approach by Shipley and Douma (2021)
to account for unmeasured latent variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">because_dsep</span><span class="op">(</span></span>
<span>  <span class="va">equations</span>,</span>
<span>  latent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  random_terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  hierarchical_info <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  poly_terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-equations">equations<a class="anchor" aria-label="anchor" href="#arg-equations"></a></dt>
<dd><p>A list of model formulas (one per structural equation),
e.g., <code>list(Y ~ X1 + X2, Z ~ Y)</code>.</p></dd>


<dt id="arg-latent">latent<a class="anchor" aria-label="anchor" href="#arg-latent"></a></dt>
<dd><p>Optional character vector of latent (unmeasured) variable names.
If provided, the function converts the DAG to a MAG and returns m-separation tests.</p></dd>


<dt id="arg-random-terms">random_terms<a class="anchor" aria-label="anchor" href="#arg-random-terms"></a></dt>
<dd><p>Optional list of random effects (group, type) parsed from equations.</p></dd>


<dt id="arg-hierarchical-info">hierarchical_info<a class="anchor" aria-label="anchor" href="#arg-hierarchical-info"></a></dt>
<dd><p>Internal argument used to pass data hierarchy information
(levels, grouping variables) for future implementation of multilevel d-separation
tests (following Shipley 2009). Currently unused by the d-separation logic.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Logical; if FALSE (default), print the basis set and MAG structure.
If TRUE, suppress informational output.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>latent</code> is NULL, returns a list of formulas representing
conditional independence tests. If <code>latent</code> is specified, returns a list with:</p><ul><li><p><code>tests</code>: List of m-separation test formulas</p></li>
<li><p><code>correlations</code>: List of variable pairs with induced correlations</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function implements the basis set approach to d-separation testing
(Shipley 2000, 2009, 2016). For standard DAGs without latent variables, it identifies
pairs of non-adjacent variables and creates conditional independence tests.</p>
<p>When latent variables are specified, the function uses the DAG-to-MAG conversion
(Shipley &amp; Douma 2021) to identify m-separation statements and induced correlations
among observed variables that arise from shared latent common causes.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Shipley, B. (2000). A new inferential test for path models based on
directed acyclic graphs. Structural Equation Modeling, 7(2), 206-218.</p>
<p>Shipley, B. (2009). Confirmatory path analysis in a generalized multilevel
context. Ecology, 90(2), 363-368.</p>
<p>Shipley, B. (2016). Cause and Correlation in Biology (2nd ed.).
Cambridge University Press.</p>
<p>Shipley, B., &amp; Douma, J. C. (2021). Testing Piecewise Structural Equations
Models in the Presence of Latent Variables and Including Correlated Errors.
Structural Equation Modeling: A Multidisciplinary Journal, 28(4), 582–589.
https://doi.org/10.1080/10705511.2020.1871355</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Standard DAG</span></span></span>
<span class="r-in"><span><span class="va">equations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">LS</span> <span class="op">~</span> <span class="va">BM</span>, <span class="va">NL</span> <span class="op">~</span> <span class="va">BM</span> <span class="op">+</span> <span class="va">RS</span>, <span class="va">DD</span> <span class="op">~</span> <span class="va">NL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ind_tests</span> <span class="op">&lt;-</span> <span class="fu">because_dsep</span><span class="op">(</span><span class="va">equations</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Basis Set for DAG: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(X,Y|Z) means X is d-separated from Y given the set Z in the DAG </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I( RS , BM |  ) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I( RS , DD | NL ) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I( RS , LS | BM ) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I( BM , DD | NL ) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I( NL , LS | RS, BM ) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I( DD , LS | NL, BM ) </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With latent variable</span></span></span>
<span class="r-in"><span><span class="va">equations_latent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">X</span> <span class="op">~</span> <span class="va">Quality</span>, <span class="va">Y</span> <span class="op">~</span> <span class="va">Quality</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">because_dsep</span><span class="op">(</span><span class="va">equations_latent</span>, latent <span class="op">=</span> <span class="st">"Quality"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Basis Set for MAG: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(X,Y|Z) means X is m-separated from Y given the set Z in the MAG </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No elements in the basis set </span>
<span class="r-in"><span><span class="co"># result$tests: m-separation tests</span></span></span>
<span class="r-in"><span><span class="co"># result$correlations: induced correlation between X and Y</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Achaz von Hardenberg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

