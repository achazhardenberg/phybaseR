<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Causal inference with d-separation • because</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Causal inference with d-separation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">because</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/01_getting_started.html">Getting Started with because</a></li>
    <li><a class="dropdown-item" href="../articles/02_dseparation.html">Causal inference with d-separation</a></li>
    <li><a class="dropdown-item" href="../articles/03_phylogenetic_models.html">Phylogenetic Models</a></li>
    <li><a class="dropdown-item" href="../articles/04_missing_data.html">Missing Data Imputation in because</a></li>
    <li><a class="dropdown-item" href="../articles/05_custom_priors.html">Custom Priors and Mechanistic Constraints</a></li>
    <li><a class="dropdown-item" href="../articles/06_mediation.html">Mediation Analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/because-pkg/because/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Causal inference with d-separation</h1>
                        <h4 data-toc-skip class="author">Achaz von
Hardenberg</h4>
            
            <h4 data-toc-skip class="date">2025-12-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/because-pkg/because/blob/master/vignettes/02_dseparation.Rmd" class="external-link"><code>vignettes/02_dseparation.Rmd</code></a></small>
      <div class="d-none name"><code>02_dseparation.Rmd</code></div>
    </div>

    
    
<p>d-separation (Shipley, 2000, 2003) is the foundation of causal
inference in <code>because</code>. It tests whether your hypothesized
causal model correctly represents the conditional independencies in your
data.</p>
<div class="section level3">
<h3 id="the-problem-with-correlations">The Problem with Correlations<a class="anchor" aria-label="anchor" href="#the-problem-with-correlations"></a>
</h3>
<p>In the simple linear regression presented as an example in the
previous vignette, we modeled the relationship between two variables, X
and Y. However, regression only tells us about correlations, not
causation. We can only say that X is related to Y or also that X
predicts Y, but we cannot say that X causes Y. There are indeed three
reasons why X and Y could correlate (if this was real data of course,
and not data we simulated with a predefined correlation!):</p>
<ol style="list-style-type: decimal">
<li>
<strong>X → Y</strong>: X causes Y</li>
<li>
<strong>Y → X</strong>: Y causes X</li>
<li>
<strong>X ← Z → Y</strong>: There is a common cause Z causing
both.</li>
</ol>
<p>The problem is that correlation alone cannot distinguish between
these three scenarios.</p>
<p>Let’s look at a classic example A correlative study trying to
establish if storks deliver babies (Matthews, 2000). we investigated
this example previously in Gonzalez-Voyer &amp; von Hardenberg (2014),
and the data and a tutorial analysing this example with traditional path
analysis is available as supplementary materials to that book chapter
and here: <a href="https://github.com/achazhardenberg/mpcm-OPM" class="external-link uri">https://github.com/achazhardenberg/mpcm-OPM</a>.</p>
<p>Let’s load the storks dataframe available in the package and take a
look at the relationship between the number of stork pairs and the
number of babies born in different European countries (in thousands per
year):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">storks</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">storks</span><span class="op">$</span><span class="va">Storks</span>, <span class="va">storks</span><span class="op">$</span><span class="va">Birth</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Number of Stork Pairs"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Number of Babies Born (thousands)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/storks_vs_babies.png" class="r-plt" alt="" width="100%"></p>
<p>We can see that there appears to be a positive correlation between
the number of stork pairs and the number of babies born and we can
confirm this with a simple linear regression:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_storks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Birth</span> <span class="op">~</span> <span class="va">Storks</span>, data <span class="op">=</span> <span class="va">storks</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_storks</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode txt"><code class="sourceCode default"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>Call:</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>lm(formula = Birth ~ Storks, data = storks)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>Residuals:</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>   Min     1Q Median     3Q    Max </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>-478.8 -166.3 -144.9   -2.0  631.1 </span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>Coefficients:</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>             Estimate Std. Error t value Pr(&gt;|t|)   </span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>(Intercept) 2.250e+02  9.356e+01   2.405   0.0295 * </span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>Storks      2.879e-02  9.402e-03   3.063   0.0079 **</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>---</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>Signif. codes:  </span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>Residual standard error: 332.2 on 15 degrees of freedom</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>Multiple R-squared:  0.3847,    Adjusted R-squared:  0.3437 </span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>F-statistic:  9.38 on 1 and 15 DF,  p-value: 0.007898</span></code></pre></div>
<p>The positive relationship between stork pairs and births is confirmed
(p = 0.008, as already reported by Matthews, 2000), but does this mean
that storks deliver babies? Or could it be that both are influenced by a
third variable, such as Country Area? Let’s check if Area correlates
with Births and Storks:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">birth_area.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Birth</span> <span class="op">~</span> <span class="va">Area</span>, data <span class="op">=</span> <span class="va">storks</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">birth_area.lm</span><span class="op">)</span></span>
<span><span class="co"># Coefficients:</span></span>
<span><span class="co">#              Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co"># (Intercept) -7.7754992 56.9376784  -0.137    0.893</span></span>
<span><span class="co"># Area         0.0017229  0.0001861   9.259 1.36e-07 ***</span></span>
<span></span>
<span><span class="va">storks_area.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Storks</span> <span class="op">~</span> <span class="va">Area</span>, data <span class="op">=</span> <span class="va">storks</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">storks_area.lm</span><span class="op">)</span></span>
<span><span class="co"># Coefficients:</span></span>
<span><span class="co">#              Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co"># (Intercept) -6.069e+01  2.591e+03  -0.023   0.9816</span></span>
<span><span class="co"># Area         2.331e-02  8.467e-03   2.753   0.0148 *</span></span></code></pre></div>
<p>Indeed, both Births and Storks correlate significantly with Area (p
&lt; 0.0001 and p = 0.015 respectively). Matthews (2000) argued that the
observed correlation between Storks and Births is actually due to the
confounding effect of Area: larger countries have more storks and more
births, leading to a spurious correlation between Storks and Births.
Indeed, when controlling statistically for Area in a multiple
regression, the effect of Storks on Births becomes non-significant:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_birth_storks_area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Birth</span> <span class="op">~</span> <span class="va">Storks</span> <span class="op">+</span> <span class="va">Area</span>,</span>
<span>  data <span class="op">=</span> <span class="va">storks</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_birth_storks_area</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Coefficients:</span></span>
<span><span class="co">#               Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co"># (Intercept) -7.4116870 56.7021798  -0.131    0.898</span></span>
<span><span class="co"># Storks       0.0059949  0.0056510   1.061    0.307</span></span>
<span><span class="co"># Area         0.0015832  0.0002273   6.964 6.62e-06 ***</span></span></code></pre></div>
<p>In a causal inference framework, we can represent these three
variables and their causal relationships using a Directed Acyclic Graph
(DAG):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://because-pkg.github.io/because/">because</a></span><span class="op">)</span></span>
<span><span class="va">dag_storks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">Storks</span> <span class="op">~</span> <span class="va">Area</span>,</span>
<span>  <span class="va">Birth</span> <span class="op">~</span> <span class="va">Area</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_dag.html">plot_dag</a></span><span class="op">(</span><span class="va">dag_storks</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/dag_storks.png" class="r-plt" alt="" width="100%"></p>
<p>Directed Acyclic Graphs (DAGs) explicitly state your causal
assumptions, and with the multiple regression above we have effectively
tested the conditional independence implied by this DAG: Storks
<em>||</em> Birth | {Area} (Storks and Births are independent
conditional on Area) which translates statistically in the d-separation
test we just performed by including Area as a covariate in the
regression of Births on Storks. Our causal model is therefore consistent
with the data. “Consistent” here means that the conditional
independencies implied by the DAG hold in the data, but it does not
prove that this causal model is actually correct. Other models may also
be consistent with the data and with only three variables it is
impossible to distinguish between different causal models. We direct the
reader to Gonzalez-Voyer &amp; von Hardenberg (2014) for a more detailed
discussion of this example and to Shipley (2000, 2003, 2016) for the
theoretical foundations of d-separation. In Gonzalez-Voyer &amp; von
Hardenberg (2014) we also explored the causal relationships of these
three variables with the fourth variable present in the dataset: Humans
(Human population size in millions) and we proposed the causal model
below which we tested using classic piecewise Path Analysis (follow the
<a href="https://github.com/achazhardenberg/mpcm-OPM" class="external-link">online
tutorial</a> if you want to replicate that analysis).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag_storks2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Storks</span> <span class="op">~</span> <span class="va">Area</span>,</span>
<span>                    <span class="va">Birth</span> <span class="op">~</span> <span class="va">Area</span>,</span>
<span>                    <span class="va">Humans</span> <span class="op">~</span> <span class="va">Birth</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_dag.html">plot_dag</a></span><span class="op">(</span><span class="va">dag_storks2</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/dag_storks2.png" class="r-plt" alt="" width="100%"></p>
<p>Let’s now see how to test this causal model with
<code>because</code>. First, we have to specify the structural equations
implied by this DAG:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">equations_storks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">Storks</span> <span class="op">~</span> <span class="va">Area</span>,</span>
<span>  <span class="va">Birth</span> <span class="op">~</span> <span class="va">Area</span>,</span>
<span>  <span class="va">Humans</span> <span class="op">~</span> <span class="va">Birth</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next, it is good practice to standardize all variables prior to
analysis, so that the path coefficients can be interpreted as
standardized effects (and it also helps with convergence of the mcmc
chains):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">storks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">storks</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Now we can fit the model with <code><a href="../reference/because.html">because()</a></code>, enabling
d-separation tests with the <code>dsep = TRUE</code> argument:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_storks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/because.html">because</a></span><span class="op">(</span></span>
<span>  equations <span class="op">=</span> <span class="va">equations_storks</span>,</span>
<span>  data <span class="op">=</span> <span class="va">storks</span>,</span>
<span>  dsep <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_storks</span><span class="op">)</span></span></code></pre></div>
<pre><code>d-separation Tests
==================

              Param Estimate LowerCI UpperCI Indep     P  Rhat n.eff 
              
Test: Area _||_ Humans | {Birth}
   beta_Area_Humans    0.107  -0.439   0.649   Yes 0.673 1.000  3650 
   
Test: Birth _||_ Storks | {Area}
  beta_Birth_Storks    0.129  -0.199   0.455   Yes 0.421 1.001  2826 
  
Test: Humans _||_ Storks | {Birth,Area}
 beta_Humans_Storks   -0.285  -0.691   0.141   Yes 0.169 1.002  2862 

Legend:
  Indep: 'Yes' = Conditionally Independent, 'No' = Dependent (based on 95% CI)
  P: Bayesian probability that the posterior distribution overlaps with zero</code></pre>
<p>We can see that all three d-separation tests pass, indicating that
the conditional independencies implied by our causal model hold in the
data. Therefore, our model is consistent with the data.</p>
</div>
<div class="section level2">
<h2 id="reading-the-d-separation-results">Reading the d-Separation results<a class="anchor" aria-label="anchor" href="#reading-the-d-separation-results"></a>
</h2>
<div class="section level3">
<h3 id="output-format">Output Format<a class="anchor" aria-label="anchor" href="#output-format"></a>
</h3>
<pre><code>             Param Estimate LowerCI UpperCI Indep     P  Rhat n.eff 
              
Test: Birth _||_ Storks | {Area}
  beta_Birth_Storks    0.129  -0.199   0.455   Yes 0.421 1.001  2826 </code></pre>
<p><strong>Test</strong>: The conditional independence being tested:
<code>Birth _||_ Storks | {Area}</code> which means “Storks is
independent of Birth given Area” - <code>_||_</code>: Independence
symbol - <code>| {}</code>: Conditioning set (what we are controlling
for)</p>
<p><strong>Param Estimate</strong>: the beta estimate of the variable
tested for conditional independence - For
<code>Birth _||_ Storks | {Area}</code>, it tests
<code>beta_Birth_Storks</code> in the model
<code>Birth ~ Storks + Area</code> - If independent, beta should be
~0</p>
<p><strong>LowerCI, UpperCI</strong>: Posterior mean and 95% credible
interval of the beta parameter tested - If independent, Credibility
intervals should include zero.</p>
<p><strong>Indep</strong>: Is independence supported? -
<code>Yes</code>: Conditional independence is supported -
<code>No</code>: Variables are not independent. <em>If any of the
conditional independence statements fail, it means that the proposed
model is not a plausible representation of the causal structure in the
data.</em></p>
<p><strong>P</strong>: The Bayesian probability that the posterior
distribution of the beta parameter overlaps with zero - High values
(e.g., &gt; 0.1) support independence - Low values (e.g., &lt; 0.05)
indicate dependence</p>
<p><strong>Rhat, n.eff</strong>: MCMC diagnostics for the beta parameter
tested - Rhat ~ 1 indicates convergence - n.eff: Effective sample
size</p>
<p>We can now fit the model without d-separation tests to obtain the
parameter estimates:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_storks_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/because.html">because</a></span><span class="op">(</span></span>
<span>  equations <span class="op">=</span> <span class="va">equations_storks</span>,</span>
<span>  data <span class="op">=</span> <span class="va">storks</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_storks_final</span><span class="op">)</span></span></code></pre></div>
<pre><code>                   Mean    SD Naive SE Time-series SE   2.5%
alphaBirth         0.003 0.133    0.002          0.002 -0.263
alphaHumans       -0.004 0.160    0.003          0.003 -0.321
alphaStorks       -0.001 0.222    0.004          0.004 -0.445
beta_Birth_Area    0.924 0.135    0.002          0.003  0.660
beta_Humans_Birth  0.848 0.164    0.003          0.003  0.516
beta_Storks_Area   0.582 0.228    0.004          0.004  0.138
sigmaBirth         0.534 0.099    0.002          0.002  0.382
sigmaHumans        0.642 0.116    0.002          0.002  0.460
sigmaStorks        0.902 0.162    0.003          0.003  0.654
                     50% 97.5%  Rhat n.eff
alphaBirth         0.005 0.265 1.000  3054
alphaHumans       -0.004 0.310 1.000  3000
alphaStorks       -0.002 0.440 1.000  3277
beta_Birth_Area    0.924 1.196 1.000  2799
beta_Humans_Birth  0.849 1.168 1.001  3000
beta_Storks_Area   0.582 1.050 1.000  3000
sigmaBirth         0.519 0.762 1.000  2720
sigmaHumans        0.624 0.916 1.000  3000
sigmaStorks        0.877 1.292 1.000  3000

DIC:
Mean deviance:  93.39 
penalty 9.835 
Penalized deviance: 103.2 </code></pre>
<p>All parameters have converged (Rhat ~ 1) and all the path
coefficients are positive, indicating that larger Area leads both to
more Storks and and more Births, and more Births lead to larger Human
populations, as expected. Note that as we standardized all variables
prior to analysis, the path coefficients can be interpreted as
standardized effects (ie their relative strength can be compared
directly).</p>
<p>We can now use the function <code>plot_dag</code> to plot the DAG of
the fitted model with the estimated path coefficients:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dag.html">plot_dag</a></span><span class="op">(</span><span class="va">fit_storks_final</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="a-note-on-the-notation-used-for-the-parameter-names-in-the-summary-output">A note on the notation used for the parameter names in the summary
output<a class="anchor" aria-label="anchor" href="#a-note-on-the-notation-used-for-the-parameter-names-in-the-summary-output"></a>
</h3>
<p>In the summary output above, the parameter names follow a specific
notation to indicate the relationships being modelled. For example,
<code>beta_Birth_Area</code> represents the path coefficient (beta) for
the effect of Area on Births. The format is
<code>beta_&lt;DependentVariable&gt;_&lt;IndependentVariable&gt;</code>.
This notation helps to quickly identify which variables are involved in
each path of the model. The alpha parameters represent the intercepts
for each equation, while the sigma parameters represent the residual
standard deviations for each dependent variable. So, for example, the
path going from Area to Births is represented by the linear
regression:</p>
<p>Birth ~ alphaBirth + beta_Birth_Area * Area + error, where error is
normally distributed with standard deviation = sigmaBirth.</p>
</div>
</div>
<div class="section level2">
<h2 id="next-phylogenetic-models">Next: Phylogenetic Models<a class="anchor" aria-label="anchor" href="#next-phylogenetic-models"></a>
</h2>
<p>Now that you understand d-separation and how to test causal models
with <code>because</code>, you can explore more complex models and
datasets. The next vignette will guide you through fitting Phylogenetic
Bayesian models, which account for shared evolutionary history among
species: <a href="03_phylogenetic_models.html"><strong>Phylogenetic
Models</strong></a></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Gonzalez-Voyer, A., &amp; von Hardenberg, A. (2014). <strong>An
introduction to phylogenetic path analysis.</strong> In Modern
phylogenetic comparative methods and their application in evolutionary
biology: Concepts and practice (pp. 201-229). Springer Berlin
Heidelberg.</p>
<p>Matthews, R. (2000). Storks deliver babies (p= 0.008).
<strong>Teaching Statistics</strong>, 22(2), 36-38.</p>
<p>Shipley, B. (2000). A New Inferential Test for Path Models Based on
Directed Acyclic Graphs. <strong>Structural Equation Modeling: A
Multidisciplinary Journal</strong>, 7(2), 206–218. <a href="https://doi.org/10.1207/S15328007SEM0702_4" class="external-link uri">https://doi.org/10.1207/S15328007SEM0702_4</a></p>
<p>Shipley, B. (2003). Testing recursive path models with correlated
errors using d-separation. <strong>Structural Equation
Modeling</strong>, 10(2), 214-221.</p>
<p>Shipley, B. (2016). Cause and Correlation in Biology: A User’s Guide
to Path Analysis, Structural Equations and Causal Inference with R (2nd
ed.). Cambridge University Press.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Achaz von Hardenberg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
