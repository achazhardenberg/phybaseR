---
title: "Getting Started with phybaseR"
author: "PhybaseR Team"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting Started with phybaseR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Welcome to phybaseR

**phybaseR** is an R package for phylogenetic Bayesian structural equation modeling (SEM). It combines the flexibility of path analysis with phylogenetic comparative methods and Bayesian inference.

## Quick Start

### Installation

```r
# Install from GitHub
devtools::install_github("your-repo/phybaseR")
library(phybaseR)
```

### Your First Model

Here's a simple example testing causal relationships between three variables:

```r
# Example data
data <- data.frame(
  species = paste0("sp_", 1:50),
  body_size = rnorm(50, 100, 20),
  range_size = rnorm(50, 500, 100),
  population = rnorm(50, 1000, 200)
)

# Hypothesized model:
# body_size â†’ range_size â†’ population
equations <- list(
  range_size ~ body_size,
  population ~ range_size + body_size
)

# Fit the model
fit <- phybase_run(
  equations = equations,
  data = data,
  dsep = TRUE,  # Test model fit with d-separation
  n.chains = 2,
  n.iter = 2000
)

# View results
summary(fit)
```

## Key Concepts

### Structural Equations

Define causal relationships using R's formula syntax:

```r
response ~ predictor1 + predictor2
```

### D-Separation Tests

phybaseR automatically tests your model's conditional independence assumptions:

- Tests whether implied independencies hold in the data
- Helps identify model misspecification
- Based on graphical separation in your causal DAG

### Phylogenetic Correlation

Include phylogenetic structure with a phylogeny:

```r
fit <- phybase_run(
  equations = equations,
  data = data,
  tree = my_phylo,  # ape phylo object
  dsep = TRUE
)
```

## What phybaseR Can Do

âœ… **Standard SEM** - Path analysis without phylogeny  
âœ… **Phylogenetic SEM** - Account for evolutionary relationships  
âœ… **Mixed Models** - Random effects for grouped data  
âœ… **Latent Variables** - Measurement error and unobserved constructs  
âœ… **Hierarchical Data** - Multi-level variables (e.g., site vs individual)  
âœ… **Polynomial Terms** - Non-linear relationships with `I(x^2)`  
âœ… **Model Comparison** - DIC, WAIC, d-separation tests  

## Learn More

### Topic Guides

For detailed information on specific features, see our topic vignettes:

- **[D-Separation and Causal Inference](dseparation.html)** - **Start here!** Core concept for testing causal models
- **[Phylogenetic Models](phylogenetic_models.html)** - Using tree structures and evolutionary correlation
- **[Alternative Covariance Structures](covariance_structures.html)** - Spatial, pedigree, social networks
- **[Non-Gaussian Distributions](distributions.html)** - Binomial, Poisson, multinomial, ordinal, gamma
- **[Advanced Model Specifications](advanced_models.html)** - Random effects, polynomials, interactions
- **[Hierarchical Data](hierarchical_data.html)** - Multi-level variables and proper sample sizes
- **[Latent Variables](latent_variables.html)** - Measurement models and MAG theory
- **[Model Diagnostics](model_diagnostics.html)** - Interpretation, comparison, convergence

### Example Workflow

```r
# 1. Specify your causal model
equations <- list(
  trait_b ~ trait_a,
  trait_c ~ trait_a + trait_b
)

# 2. Fit the model
fit <- phybase_run(
  equations = equations,
  data = my_data,
  tree = my_tree,
  dsep = TRUE,
  n.chains = 3,
  n.iter = 5000
)

# 3. Check convergence
summary(fit)  # Look at Rhat values (should be < 1.1)

# 4. Interpret d-separation tests
# High P(~0) values indicate independence (good!)
# Low values suggest missing paths

# 5. Extract coefficients
# Beta estimates show strength and direction of paths
```

## Getting Help

- **Issues**: Report bugs on GitHub
- **Questions**: Check vignettes or open a discussion
- **Examples**: See `examples/` directory

## Next Steps

1. Read the **[Advanced Model Specifications](advanced_models.html)** vignette to learn about random effects and polynomials
2. Explore **[Hierarchical Data](hierarchical_data.html)** if you have multi-level variables
3. Check **[Latent Variables](latent_variables.html)** for measurement models
4. See **[Model Diagnostics](model_diagnostics.html)** for interpretation guidance

Happy modeling! ðŸŽ‰
